/*!
 * jQuery JavaScript Library v1.7.1
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Mon Nov 21 21:11:03 2011 -0500
 */
function getResourceFetchXml(n,t){var i=['<condition attribute="statecode" operator="eq" value="0"/>',buildSiteConditions(n,t,"R")];return fetchXml=MCS.cvt_Common.CreateFetch("mcs_resource",["mcs_resourceid","mcs_name","createdon"],i,["mcs_name",!1])}function getResourceLayout(n){return'<grid name="resultset" object="'+n+'" jump="mcs_name" select="1" icon="0" preview="0"><row name="result" id="mcs_resourceid"><cell name="mcs_name" width="300" /><cell name="mcs_relatedsiteid" width="200" /><cell name="mcs_type" width="100" /><cell name="mcs_businessunitid" width="100" /><cell name="ownerid" width="150" /><cell name="modifiedon" width="125" /><cell name="createdon" width="125" /><\/row><\/grid>'}function getResourceGroupFetchXml(n,t,i){var r=[];return r=i?['<condition attribute="statecode" operator="eq" value="0"/>','<condition attribute="mcs_type" operator="eq" value="917290000"/>',buildSiteConditions(n,t,"RG")]:['<condition attribute="statecode" operator="eq" value="0"/>',buildSiteConditions(n,t,"RG")],fetchXml=MCS.cvt_Common.CreateFetch("mcs_resourcegroup",["mcs_name","mcs_type","mcs_relatedsiteid","modifiedon","createdon","mcs_resourcegroupid"],r,["mcs_name",!1])}function getResourceGroupLayout(n){return'<grid name="resultset" object="'+n+'" jump="mcs_name" select="1" icon="0" preview="0"><row name="result" id="mcs_resourcegroupid"><cell name="mcs_name" width="300" /><cell name="mcs_relatedsiteid" width="300" /><cell name="mcs_type" width="150" /><cell name="modifiedon" width="125" /><cell name="createdon" width="125" /><\/row><\/grid>'}function getUserFetchXml(n,t){return fetchXml='<fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false"><entity name="systemuser"><attribute name="fullname"/><attribute name="businessunitid"/><attribute name="cvt_type"/><attribute name="domainname"/><attribute name="jobtitle"/><attribute name="internalemailaddress"/><attribute name="modifiedon"/><attribute name="cvt_site"/><attribute name="cvt_facility"/><attribute name="systemuserid"/><order attribute="fullname" descending="false"/><filter type="and"><condition attribute="isdisabled" operator="eq" value="0"/><condition attribute="accessmode" operator="ne" value="3"/>',fetchXml+=buildSiteConditions(n,t,"U"),fetchXml+='<\/filter><link-entity name="team" from="teamid" to="cvt_primaryteam" visible="false" link-type="outer" alias="a_8f34fae9459de2118b0978e3b511a629"><attribute name="name"/><\/link-entity><\/entity><\/fetch>'}function getUserLayout(){return'<grid name="resultset" object="8" jump="fullname" select="1" icon="0" preview="0"><row name="result" id="systemuserid"><cell name="fullname" width="200" /><cell name="jobtitle" width="150" /><cell name="domainname" width="200" /><cell name="internalemailaddress" width="150" /><cell name="cvt_type" width="125" /><cell name="cvt_facility" width="150" /><cell name="cvt_site" width="200" /><cell name="a_8f34fae9459de2118b0978e3b511a629.name" width="150" disableSorting="1" /><cell name="businessunitid" width="150" /><cell name="modifiedon" width="100" /><\/row><\/grid>'}function buildSiteConditions(n,t,i){var r="",u,f;switch(i){case"U":r='<condition attribute="cvt_site" operator="in">';break;default:r='<condition attribute="mcs_relatedsiteid" operator="in">'}if(n)r+='<value uiname="'+MCS.cvt_Common.formatXML(n[0].mcs_name)+'" uitype="mcs_site">'+n[0].id+"<\/value>";else if(u=[],f="statuscode/Value eq 1 and mcs_FacilityId/Id eq (Guid'"+t+"')",calls=CrmRestKit.ByQuery("mcs_site",["mcs_name","mcs_siteId","mcs_FacilityId"],f,!1),calls.fail(function(){}),calls.done(function(n){n&&n.d.results&&n.d.results.length>0&&(u=n.d.results)}),u.length>0)for(record in u)r+='<value uiname="'+MCS.cvt_Common.formatXML(u[record].mcs_name)+'" uitype="mcs_site">'+u[record].mcs_siteId+"<\/value>";else r+='<value uiname="NoSites" uitype="mcs_site">'+MCS.cvt_Common.BlankGUID+"<\/value>";return r+"<\/condition>"}var CrmRestKit,XrmSvcToolkit,process,facilities,PatFacility,ProFacility;(function(n,t){function kr(n){var i=lt[n]={},t,r;for(n=n.split(/\s+/),t=0,r=n.length;t<r;t++)i[n[t]]=!0;return i}function yt(n,r,u){if(u===t&&n.nodeType===1){var f="data-"+r.replace(vt,"-$1").toLowerCase();if(u=n.getAttribute(f),typeof u=="string"){try{u=u==="true"?!0:u==="false"?!1:u==="null"?null:i.isNumeric(u)?parseFloat(u):at.test(u)?i.parseJSON(u):u}catch(e){}i.data(n,r,u)}else u=t}return u}function it(n){for(var t in n)if((t!=="data"||!i.isEmptyObject(n[t]))&&t!=="toJSON")return!1;return!0}function pt(n,t,r){var u=t+"defer",f=t+"queue",e=t+"mark",o=i._data(n,u);!o||r!=="queue"&&i._data(n,f)||r!=="mark"&&i._data(n,e)||setTimeout(function(){i._data(n,f)||i._data(n,e)||(i.removeData(n,u,!0),o.fire())},0)}function h(){return!1}function b(){return!0}function ui(n){return!n||!n.parentNode||n.parentNode.nodeType===11}function fi(n,t,r){if(t=t||0,i.isFunction(t))return i.grep(n,function(n,i){var u=!!t.call(n,i,n);return u===r});if(t.nodeType)return i.grep(n,function(n){return n===t===r});if(typeof t=="string"){var u=i.grep(n,function(n){return n.nodeType===1});if(lu.test(t))return i.filter(t,u,!r);t=i.filter(t,u)}return i.grep(n,function(n){return i.inArray(n,t)>=0===r})}function ei(n){var i=oi.split("|"),t=n.createDocumentFragment();if(t.createElement)while(i.length)t.createElement(i.pop());return t}function nf(n){return i.nodeName(n,"table")?n.getElementsByTagName("tbody")[0]||n.appendChild(n.ownerDocument.createElement("tbody")):n}function vi(n,t){if(t.nodeType===1&&i.hasData(n)){var r,u,o,s=i._data(n),e=i._data(t,s),f=s.events;if(f){delete e.handle;e.events={};for(r in f)for(u=0,o=f[r].length;u<o;u++)i.event.add(t,r+(f[r][u].namespace?".":"")+f[r][u].namespace,f[r][u],f[r][u].data)}e.data&&(e.data=i.extend({},e.data))}}function yi(n,t){var r;t.nodeType===1&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(n),r=t.nodeName.toLowerCase(),r==="object"?t.outerHTML=n.outerHTML:r==="input"&&(n.type==="checkbox"||n.type==="radio")?(n.checked&&(t.defaultChecked=t.checked=n.checked),t.value!==n.value&&(t.value=n.value)):r==="option"?t.selected=n.defaultSelected:(r==="input"||r==="textarea")&&(t.defaultValue=n.defaultValue),t.removeAttribute(i.expando))}function k(n){return typeof n.getElementsByTagName!="undefined"?n.getElementsByTagName("*"):typeof n.querySelectorAll!="undefined"?n.querySelectorAll("*"):[]}function pi(n){(n.type==="checkbox"||n.type==="radio")&&(n.defaultChecked=n.checked)}function wi(n){var t=(n.nodeName||"").toLowerCase();t==="input"?pi(n):t!=="script"&&typeof n.getElementsByTagName!="undefined"&&i.grep(n.getElementsByTagName("input"),pi)}function tf(n){var t=r.createElement("div");return ai.appendChild(t),t.innerHTML=n.outerHTML,t.firstChild}function rf(n,t){t.src?i.ajax({url:t.src,async:!1,dataType:"script"}):i.globalEval((t.text||t.textContent||t.innerHTML||"").replace(gu,"/*$0*/"));t.parentNode&&t.parentNode.removeChild(t)}function gi(n,t,r){var u=t==="width"?n.offsetWidth:n.offsetHeight,e=t==="width"?hf:cf,f=0,o=e.length;if(u>0){if(r!=="border")for(;f<o;f++)r||(u-=parseFloat(i.css(n,"padding"+e[f]))||0),r==="margin"?u+=parseFloat(i.css(n,r+e[f]))||0:u-=parseFloat(i.css(n,"border"+e[f]+"Width"))||0;return u+"px"}if(u=c(n,t,t),(u<0||u==null)&&(u=n.style[t]||0),u=parseFloat(u)||0,r)for(;f<o;f++)u+=parseFloat(i.css(n,"padding"+e[f]))||0,r!=="padding"&&(u+=parseFloat(i.css(n,"border"+e[f]+"Width"))||0),r==="margin"&&(u+=parseFloat(i.css(n,r+e[f]))||0);return u+"px"}function or(n){return function(t,r){if(typeof t!="string"&&(r=t,t="*"),i.isFunction(r))for(var o=t.toLowerCase().split(ir),f=0,h=o.length,u,s,e;f<h;f++)u=o[f],e=/^\+/.test(u),e&&(u=u.substr(1)||"*"),s=n[u]=n[u]||[],s[e?"unshift":"push"](r)}}function d(n,i,r,u,f,e){f=f||i.dataTypes[0];e=e||{};e[f]=!0;for(var s=n[f],h=0,l=s?s.length:0,c=n===et,o;h<l&&(c||!o);h++)o=s[h](i,r,u),typeof o=="string"&&(!c||e[o]?o=t:(i.dataTypes.unshift(o),o=d(n,i,r,u,o,e)));return!c&&o||e["*"]||(o=d(n,i,r,u,"*",e)),o}function sr(n,r){var u,f,e=i.ajaxSettings.flatOptions||{};for(u in r)r[u]!==t&&((e[u]?n:f||(f={}))[u]=r[u]);f&&i.extend(!0,n,f)}function ot(n,t,r,u){if(i.isArray(t))i.each(t,function(t,f){r||af.test(n)?u(n,f):ot(n+"["+(typeof f=="object"||i.isArray(f)?t:"")+"]",f,r,u)});else if(r||t==null||typeof t!="object")u(n,t);else for(var f in t)ot(n+"["+f+"]",t[f],r,u)}function ne(n,i,r){var s=n.contents,f=n.dataTypes,c=n.responseFields,o,u,e,h;for(u in c)u in r&&(i[c[u]]=r[u]);while(f[0]==="*")f.shift(),o===t&&(o=n.mimeType||i.getResponseHeader("content-type"));if(o)for(u in s)if(s[u]&&s[u].test(o)){f.unshift(u);break}if(f[0]in r)e=f[0];else{for(u in r){if(!f[0]||n.converters[u+" "+f[0]]){e=u;break}h||(h=u)}e=e||h}if(e)return e!==f[0]&&f.unshift(e),r[e]}function te(n,r){n.dataFilter&&(r=n.dataFilter(r,n.dataType));for(var v=n.dataTypes,s={},l,p=v.length,a,u=v[0],h,y,f,e,o,c=1;c<p;c++){if(c===1)for(l in n.converters)typeof l=="string"&&(s[l.toLowerCase()]=n.converters[l]);if(h=u,u=v[c],u==="*")u=h;else if(h!=="*"&&h!==u){if(y=h+" "+u,f=s[y]||s["* "+u],!f){o=t;for(e in s)if(a=e.split(" "),(a[0]===h||a[0]==="*")&&(o=s[a[1]+" "+u],o)){e=s[e];e===!0?f=o:o===!0&&(f=e);break}}f||o||i.error("No conversion from "+y.replace(" "," to "));f!==!0&&(r=f?f(r):o(e(r)))}}return r}function lr(){try{return new n.XMLHttpRequest}catch(t){}}function ie(){try{return new n.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function vr(){return setTimeout(fe,0),tt=i.now()}function fe(){tt=t}function v(n,t){var r={};return i.each(ar.concat.apply([],ar.slice(0,t)),function(){r[this]=n}),r}function yr(n){if(!st[n]){var e=r.body,t=i("<"+n+">").appendTo(e),u=t.css("display");t.remove();(u==="none"||u==="")&&(f||(f=r.createElement("iframe"),f.frameBorder=f.width=f.height=0),e.appendChild(f),a&&f.createElement||(a=(f.contentWindow||f.contentDocument).document,a.write((r.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),a.close()),t=a.createElement(n),a.body.appendChild(t),u=i.css(t,"display"),e.removeChild(f));st[n]=u}return st[n]}function ct(n){return i.isWindow(n)?n:n.nodeType===9?n.defaultView||n.parentWindow:!1}var r=n.document,wr=n.navigator,br=n.location,i=function(){function b(){if(!i.isReady){try{r.documentElement.doScroll("left")}catch(n){setTimeout(b,1);return}i.ready()}}var i=function(n,t){return new i.fn.init(n,t,c)},k=n.jQuery,d=n.$,c,g=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,l=/\S/,a=/^\s+/,v=/\s+$/,nt=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,tt=/^[\],:{}\s]*$/,it=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rt=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,ut=/(?:^|:|,)(?:\s*\[)+/g,ft=/(webkit)[ \/]([\w.]+)/,et=/(opera)(?:.*version)?[ \/]([\w.]+)/,ot=/(msie) ([\w.]+)/,st=/(mozilla)(?:.*? rv:([\w.]+))?/,ht=/-([a-z]|[0-9])/ig,ct=/^-ms-/,lt=function(n,t){return(t+"").toUpperCase()},at=wr.userAgent,e,o,u,vt=Object.prototype.toString,s=Object.prototype.hasOwnProperty,h=Array.prototype.push,f=Array.prototype.slice,y=String.prototype.trim,p=Array.prototype.indexOf,w={};return i.fn=i.prototype={constructor:i,init:function(n,u,f){var o,s,e,h;if(!n)return this;if(n.nodeType)return this.context=this[0]=n,this.length=1,this;if(n==="body"&&!u&&r.body)return this.context=r,this[0]=r.body,this.selector=n,this.length=1,this;if(typeof n=="string"){if(o=n.charAt(0)==="<"&&n.charAt(n.length-1)===">"&&n.length>=3?[null,n,null]:g.exec(n),o&&(o[1]||!u)){if(o[1])return u=u instanceof i?u[0]:u,h=u?u.ownerDocument||u:r,e=nt.exec(n),e?i.isPlainObject(u)?(n=[r.createElement(e[1])],i.fn.attr.call(n,u,!0)):n=[h.createElement(e[1])]:(e=i.buildFragment([o[1]],[h]),n=(e.cacheable?i.clone(e.fragment):e.fragment).childNodes),i.merge(this,n);if(s=r.getElementById(o[2]),s&&s.parentNode){if(s.id!==o[2])return f.find(n);this.length=1;this[0]=s}return this.context=r,this.selector=n,this}return!u||u.jquery?(u||f).find(n):this.constructor(u).find(n)}return i.isFunction(n)?f.ready(n):(n.selector!==t&&(this.selector=n.selector,this.context=n.context),i.makeArray(n,this))},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return f.call(this,0)},get:function(n){return n==null?this.toArray():n<0?this[this.length+n]:this[n]},pushStack:function(n,t,r){var u=this.constructor();return i.isArray(n)?h.apply(u,n):i.merge(u,n),u.prevObject=this,u.context=this.context,t==="find"?u.selector=this.selector+(this.selector?" ":"")+r:t&&(u.selector=this.selector+"."+t+"("+r+")"),u},each:function(n,t){return i.each(this,n,t)},ready:function(n){return i.bindReady(),o.add(n),this},eq:function(n){return n=+n,n===-1?this.slice(n):this.slice(n,n+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(f.apply(this,arguments),"slice",f.call(arguments).join(","))},map:function(n){return this.pushStack(i.map(this,function(t,i){return n.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},i.fn.init.prototype=i.fn,i.extend=i.fn.extend=function(){var o,e,u,r,s,h,n=arguments[0]||{},f=1,l=arguments.length,c=!1;for(typeof n=="boolean"&&(c=n,n=arguments[1]||{},f=2),typeof n=="object"||i.isFunction(n)||(n={}),l===f&&(n=this,--f);f<l;f++)if((o=arguments[f])!=null)for(e in o)(u=n[e],r=o[e],n!==r)&&(c&&r&&(i.isPlainObject(r)||(s=i.isArray(r)))?(s?(s=!1,h=u&&i.isArray(u)?u:[]):h=u&&i.isPlainObject(u)?u:{},n[e]=i.extend(c,h,r)):r!==t&&(n[e]=r));return n},i.extend({noConflict:function(t){return n.$===i&&(n.$=d),t&&n.jQuery===i&&(n.jQuery=k),i},isReady:!1,readyWait:1,holdReady:function(n){n?i.readyWait++:i.ready(!0)},ready:function(n){if(n===!0&&!--i.readyWait||n!==!0&&!i.isReady){if(!r.body)return setTimeout(i.ready,1);if(i.isReady=!0,n!==!0&&--i.readyWait>0)return;o.fireWith(r,[i]);i.fn.trigger&&i(r).trigger("ready").off("ready")}},bindReady:function(){if(!o){if(o=i.Callbacks("once memory"),r.readyState==="complete")return setTimeout(i.ready,1);if(r.addEventListener)r.addEventListener("DOMContentLoaded",u,!1),n.addEventListener("load",i.ready,!1);else if(r.attachEvent){r.attachEvent("onreadystatechange",u);n.attachEvent("onload",i.ready);var t=!1;try{t=n.frameElement==null}catch(f){}r.documentElement.doScroll&&t&&b()}}},isFunction:function(n){return i.type(n)==="function"},isArray:Array.isArray||function(n){return i.type(n)==="array"},isWindow:function(n){return n&&typeof n=="object"&&"setInterval"in n},isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)},type:function(n){return n==null?String(n):w[vt.call(n)]||"object"},isPlainObject:function(n){if(!n||i.type(n)!=="object"||n.nodeType||i.isWindow(n))return!1;try{if(n.constructor&&!s.call(n,"constructor")&&!s.call(n.constructor.prototype,"isPrototypeOf"))return!1}catch(u){return!1}for(var r in n);return r===t||s.call(n,r)},isEmptyObject:function(n){for(var t in n)return!1;return!0},error:function(n){throw new Error(n);},parseJSON:function(t){if(typeof t!="string"||!t)return null;if(t=i.trim(t),n.JSON&&n.JSON.parse)return n.JSON.parse(t);if(tt.test(t.replace(it,"@").replace(rt,"]").replace(ut,"")))return new Function("return "+t)();i.error("Invalid JSON: "+t)},parseXML:function(r){var u,f;try{n.DOMParser?(f=new DOMParser,u=f.parseFromString(r,"text/xml")):(u=new ActiveXObject("Microsoft.XMLDOM"),u.async="false",u.loadXML(r))}catch(e){u=t}return u&&u.documentElement&&!u.getElementsByTagName("parsererror").length||i.error("Invalid XML: "+r),u},noop:function(){},globalEval:function(t){t&&l.test(t)&&(n.execScript||function(t){n.eval.call(n,t)})(t)},camelCase:function(n){return n.replace(ct,"ms-").replace(ht,lt)},nodeName:function(n,t){return n.nodeName&&n.nodeName.toUpperCase()===t.toUpperCase()},each:function(n,r,u){var f,e=0,o=n.length,s=o===t||i.isFunction(n);if(u){if(s){for(f in n)if(r.apply(n[f],u)===!1)break}else for(;e<o;)if(r.apply(n[e++],u)===!1)break}else if(s){for(f in n)if(r.call(n[f],f,n[f])===!1)break}else for(;e<o;)if(r.call(n[e],e,n[e++])===!1)break;return n},trim:y?function(n){return n==null?"":y.call(n)}:function(n){return n==null?"":n.toString().replace(a,"").replace(v,"")},makeArray:function(n,t){var u=t||[],r;return n!=null&&(r=i.type(n),n.length==null||r==="string"||r==="function"||r==="regexp"||i.isWindow(n)?h.call(u,n):i.merge(u,n)),u},inArray:function(n,t,i){var r;if(t){if(p)return p.call(t,n,i);for(r=t.length,i=i?i<0?Math.max(0,r+i):i:0;i<r;i++)if(i in t&&t[i]===n)return i}return-1},merge:function(n,i){var u=n.length,r=0,f;if(typeof i.length=="number")for(f=i.length;r<f;r++)n[u++]=i[r];else while(i[r]!==t)n[u++]=i[r++];return n.length=u,n},grep:function(n,t,i){var u=[],f,r,e;for(i=!!i,r=0,e=n.length;r<e;r++)f=!!t(n[r],r),i!==f&&u.push(n[r]);return u},map:function(n,r,u){var f,h,e=[],s=0,o=n.length,c=n instanceof i||o!==t&&typeof o=="number"&&(o>0&&n[0]&&n[o-1]||o===0||i.isArray(n));if(c)for(;s<o;s++)f=r(n[s],s,u),f!=null&&(e[e.length]=f);else for(h in n)f=r(n[h],h,u),f!=null&&(e[e.length]=f);return e.concat.apply([],e)},guid:1,proxy:function(n,r){var e,o,u;return(typeof r=="string"&&(e=n[r],r=n,n=e),!i.isFunction(n))?t:(o=f.call(arguments,2),u=function(){return n.apply(r,o.concat(f.call(arguments)))},u.guid=n.guid=n.guid||u.guid||i.guid++,u)},access:function(n,r,u,f,e,o){var c=n.length,h,s;if(typeof r=="object"){for(h in r)i.access(n,h,r[h],f,e,u);return n}if(u!==t){for(f=!o&&f&&i.isFunction(u),s=0;s<c;s++)e(n[s],r,f?u.call(n[s],s,e(n[s],r)):u,o);return n}return c?e(n[0],r):t},now:function(){return(new Date).getTime()},uaMatch:function(n){n=n.toLowerCase();var t=ft.exec(n)||et.exec(n)||ot.exec(n)||n.indexOf("compatible")<0&&st.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}},sub:function(){function n(t,i){return new n.fn.init(t,i)}i.extend(!0,n,this);n.superclass=this;n.fn=n.prototype=this();n.fn.constructor=n;n.sub=this.sub;n.fn.init=function(r,u){return u&&u instanceof i&&!(u instanceof n)&&(u=n(u)),i.fn.init.call(this,r,u,t)};n.fn.init.prototype=n.fn;var t=n(r);return n},browser:{}}),i.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(n,t){w["[object "+t+"]"]=t.toLowerCase()}),e=i.uaMatch(at),e.browser&&(i.browser[e.browser]=!0,i.browser.version=e.version),i.browser.webkit&&(i.browser.safari=!0),l.test("Â ")&&(a=/^[\s\xA0]+/,v=/[\s\xA0]+$/),c=i(r),r.addEventListener?u=function(){r.removeEventListener("DOMContentLoaded",u,!1);i.ready()}:r.attachEvent&&(u=function(){r.readyState==="complete"&&(r.detachEvent("onreadystatechange",u),i.ready())}),i}(),lt={},p,at,vt,hr,y,g,cr,l,pr,ht;i.Callbacks=function(n){n=n?lt[n]||kr(n):{};var r=[],f=[],u,s,c,h,e,l=function(t){for(var u,e,f=0,s=t.length;f<s;f++)u=t[f],e=i.type(u),e==="array"?l(u):e==="function"&&(n.unique&&o.has(u)||r.push(u))},a=function(t,i){for(i=i||[],u=!n.memory||[t,i],s=!0,e=c||0,c=0,h=r.length;r&&e<h;e++)if(r[e].apply(t,i)===!1&&n.stopOnFalse){u=!0;break}s=!1;r&&(n.once?u===!0?o.disable():r=[]:f&&f.length&&(u=f.shift(),o.fireWith(u[0],u[1])))},o={add:function(){if(r){var n=r.length;l(arguments);s?h=r.length:u&&u!==!0&&(c=n,a(u[0],u[1]))}return this},remove:function(){var t;if(r)for(var u=arguments,i=0,f=u.length;i<f;i++)for(t=0;t<r.length;t++)if(u[i]===r[t]&&(s&&t<=h&&(h--,t<=e&&e--),r.splice(t--,1),n.unique))break;return this},has:function(n){if(r)for(var t=0,i=r.length;t<i;t++)if(n===r[t])return!0;return!1},empty:function(){return r=[],this},disable:function(){return r=f=u=t,this},disabled:function(){return!r},lock:function(){return f=t,u&&u!==!0||o.disable(),this},locked:function(){return!f},fireWith:function(t,i){return f&&(s?n.once||f.push([t,i]):n.once&&u||a(t,i)),this},fire:function(){return o.fireWith(this,arguments),this},fired:function(){return!!u}};return o};p=[].slice;i.extend({Deferred:function(n){var r=i.Callbacks("once memory"),u=i.Callbacks("once memory"),f=i.Callbacks("memory"),s="pending",h={resolve:r,reject:u,notify:f},e={done:r.add,fail:u.add,progress:f.add,state:function(){return s},isResolved:r.fired,isRejected:u.fired,then:function(n,i,r){return t.done(n).fail(i).progress(r),this},always:function(){return t.done.apply(t,arguments).fail.apply(t,arguments),this},pipe:function(n,r,u){return i.Deferred(function(f){i.each({done:[n,"resolve"],fail:[r,"reject"],progress:[u,"notify"]},function(n,r){var e=r[0],o=r[1],u;i.isFunction(e)?t[n](function(){u=e.apply(this,arguments);u&&i.isFunction(u.promise)?u.promise().then(f.resolve,f.reject,f.notify):f[o+"With"](this===t?f:this,[u])}):t[n](f[o])})}).promise()},promise:function(n){if(n==null)n=e;else for(var t in e)n[t]=e[t];return n}},t=e.promise({});for(var o in h)t[o]=h[o].fire,t[o+"With"]=h[o].fireWith;return t.done(function(){s="resolved"},u.disable,f.lock).fail(function(){s="rejected"},r.disable,f.lock),n&&n.call(t,t),t},when:function(n){function h(n){return function(i){r[n]=arguments.length>1?p.call(arguments,0):i;--e||t.resolveWith(t,r)}}function c(n){return function(i){o[n]=arguments.length>1?p.call(arguments,0):i;t.notifyWith(s,o)}}var r=p.call(arguments,0),u=0,f=r.length,o=new Array(f),e=f,l=f,t=f<=1&&n&&i.isFunction(n.promise)?n:i.Deferred(),s=t.promise();if(f>1){for(;u<f;u++)r[u]&&r[u].promise&&i.isFunction(r[u].promise)?r[u].promise().then(h(u),t.reject,c(u)):--e;e||t.resolveWith(t,r)}else t!==n&&t.resolveWith(t,f?[n]:[]);return s}});i.support=function(){var u,y,o,l,a,f,s,e,c,v,p,h,t=r.createElement("div"),w=r.documentElement;if(t.setAttribute("className","t"),t.innerHTML="   <link/><table><\/table><a href='/a' style='top:1px;float:left;opacity:.55;'>a<\/a><input type='checkbox'/>",y=t.getElementsByTagName("*"),o=t.getElementsByTagName("a")[0],!y||!y.length||!o)return{};l=r.createElement("select");a=l.appendChild(r.createElement("option"));f=t.getElementsByTagName("input")[0];u={leadingWhitespace:t.firstChild.nodeType===3,tbody:!t.getElementsByTagName("tbody").length,htmlSerialize:!!t.getElementsByTagName("link").length,style:/top/.test(o.getAttribute("style")),hrefNormalized:o.getAttribute("href")==="/a",opacity:/^0.55/.test(o.style.opacity),cssFloat:!!o.style.cssFloat,checkOn:f.value==="on",optSelected:a.selected,getSetAttribute:t.className!=="t",enctype:!!r.createElement("form").enctype,html5Clone:r.createElement("nav").cloneNode(!0).outerHTML!=="<:nav><\/:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0};f.checked=!0;u.noCloneChecked=f.cloneNode(!0).checked;l.disabled=!0;u.optDisabled=!a.disabled;try{delete t.test}catch(b){u.deleteExpando=!1}if(!t.addEventListener&&t.attachEvent&&t.fireEvent&&(t.attachEvent("onclick",function(){u.noCloneEvent=!1}),t.cloneNode(!0).fireEvent("onclick")),f=r.createElement("input"),f.value="t",f.setAttribute("type","radio"),u.radioValue=f.value==="t",f.setAttribute("checked","checked"),t.appendChild(f),e=r.createDocumentFragment(),e.appendChild(t.lastChild),u.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,u.appendChecked=f.checked,e.removeChild(f),e.appendChild(t),t.innerHTML="",n.getComputedStyle&&(s=r.createElement("div"),s.style.width="0",s.style.marginRight="0",t.style.width="2px",t.appendChild(s),u.reliableMarginRight=(parseInt((n.getComputedStyle(s,null)||{marginRight:0}).marginRight,10)||0)===0),t.attachEvent)for(p in{submit:1,change:1,focusin:1})v="on"+p,h=v in t,h||(t.setAttribute(v,"return;"),h=typeof t[v]=="function"),u[p+"Bubbles"]=h;return e.removeChild(t),e=l=a=s=t=f=null,i(function(){var f,e,n,p,o,l,a,v,y,w,s=r.getElementsByTagName("body")[0];s&&(l=1,a="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",v="visibility:hidden;border:0;",y="style='"+a+"border:5px solid #000;padding:0;'",w="<div "+y+"><div><\/div><\/div><table "+y+" cellpadding='0' cellspacing='0'><tr><td><\/td><\/tr><\/table>",f=r.createElement("div"),f.style.cssText=v+"width:0;height:0;position:static;top:0;margin-top:"+l+"px",s.insertBefore(f,s.firstChild),t=r.createElement("div"),f.appendChild(t),t.innerHTML="<table><tr><td style='padding:0;border:0;display:none'><\/td><td>t<\/td><\/tr><\/table>",c=t.getElementsByTagName("td"),h=c[0].offsetHeight===0,c[0].style.display="",c[1].style.display="none",u.reliableHiddenOffsets=h&&c[0].offsetHeight===0,t.innerHTML="",t.style.width=t.style.paddingLeft="1px",i.boxModel=u.boxModel=t.offsetWidth===2,typeof t.style.zoom!="undefined"&&(t.style.display="inline",t.style.zoom=1,u.inlineBlockNeedsLayout=t.offsetWidth===2,t.style.display="",t.innerHTML="<div style='width:4px;'><\/div>",u.shrinkWrapBlocks=t.offsetWidth!==2),t.style.cssText=a+v,t.innerHTML=w,e=t.firstChild,n=e.firstChild,p=e.nextSibling.firstChild.firstChild,o={doesNotAddBorder:n.offsetTop!==5,doesAddBorderForTableAndCells:p.offsetTop===5},n.style.position="fixed",n.style.top="20px",o.fixedPosition=n.offsetTop===20||n.offsetTop===15,n.style.position=n.style.top="",e.style.overflow="hidden",e.style.position="relative",o.subtractsBorderForOverflowNotVisible=n.offsetTop===-5,o.doesNotIncludeMarginInBodyOffset=s.offsetTop!==l,s.removeChild(f),t=f=null,i.extend(u,o))}),u}();at=/^(?:\{.*\}|\[.*\])$/;vt=/([A-Z])/g;i.extend({cache:{},uuid:0,expando:"jQuery"+(i.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(n){return n=n.nodeType?i.cache[n[i.expando]]:n[i.expando],!!n&&!it(n)},data:function(n,r,u,f){if(i.acceptData(n)){var a,o,h,c=i.expando,v=typeof r=="string",l=n.nodeType,s=l?i.cache:n,e=l?n[c]:n[c]&&c,y=r==="events";if(e&&s[e]&&(y||f||s[e].data)||!v||u!==t)return(e||(l?n[c]=e=++i.uuid:e=c),s[e]||(s[e]={},l||(s[e].toJSON=i.noop)),(typeof r=="object"||typeof r=="function")&&(f?s[e]=i.extend(s[e],r):s[e].data=i.extend(s[e].data,r)),a=o=s[e],f||(o.data||(o.data={}),o=o.data),u!==t&&(o[i.camelCase(r)]=u),y&&!o[r])?a.events:(v?(h=o[r],h==null&&(h=o[i.camelCase(r)])):h=o,h)}},removeData:function(n,t,r){if(i.acceptData(n)){var e,s,c,o=i.expando,h=n.nodeType,u=h?i.cache:n,f=h?n[o]:o;if(u[f]){if(t&&(e=r?u[f]:u[f].data,e)){for(i.isArray(t)||(t in e?t=[t]:(t=i.camelCase(t),t=t in e?[t]:t.split(" "))),s=0,c=t.length;s<c;s++)delete e[t[s]];if(!(r?it:i.isEmptyObject)(e))return}(r||(delete u[f].data,it(u[f])))&&(i.support.deleteExpando||!u.setInterval?delete u[f]:u[f]=null,h&&(i.support.deleteExpando?delete n[o]:n.removeAttribute?n.removeAttribute(o):n[o]=null))}}},_data:function(n,t,r){return i.data(n,t,r,!0)},acceptData:function(n){if(n.nodeName){var t=i.noData[n.nodeName.toLowerCase()];if(t)return!(t===!0||n.getAttribute("classid")!==t)}return!0}});i.fn.extend({data:function(n,r){var u,s,e,f=null,o,h;if(typeof n=="undefined"){if(this.length&&(f=i.data(this[0]),this[0].nodeType===1&&!i._data(this[0],"parsedAttrs"))){for(s=this[0].attributes,o=0,h=s.length;o<h;o++)e=s[o].name,e.indexOf("data-")===0&&(e=i.camelCase(e.substring(5)),yt(this[0],e,f[e]));i._data(this[0],"parsedAttrs",!0)}return f}return typeof n=="object"?this.each(function(){i.data(this,n)}):(u=n.split("."),u[1]=u[1]?"."+u[1]:"",r===t?(f=this.triggerHandler("getData"+u[1]+"!",[u[0]]),f===t&&this.length&&(f=i.data(this[0],n),f=yt(this[0],n,f)),f===t&&u[1]?this.data(u[0]):f):this.each(function(){var t=i(this),f=[u[0],r];t.triggerHandler("setData"+u[1]+"!",f);i.data(this,n,r);t.triggerHandler("changeData"+u[1]+"!",f)}))},removeData:function(n){return this.each(function(){i.removeData(this,n)})}});i.extend({_mark:function(n,t){n&&(t=(t||"fx")+"mark",i._data(n,t,(i._data(n,t)||0)+1))},_unmark:function(n,t,r){if(n!==!0&&(r=t,t=n,n=!1),t){r=r||"fx";var u=r+"mark",f=n?0:(i._data(t,u)||1)-1;f?i._data(t,u,f):(i.removeData(t,u,!0),pt(t,r,"mark"))}},queue:function(n,t,r){var u;if(n)return t=(t||"fx")+"queue",u=i._data(n,t),r&&(!u||i.isArray(r)?u=i._data(n,t,i.makeArray(r)):u.push(r)),u||[]},dequeue:function(n,t){t=t||"fx";var r=i.queue(n,t),u=r.shift(),f={};u==="inprogress"&&(u=r.shift());u&&(t==="fx"&&r.unshift("inprogress"),i._data(n,t+".run",f),u.call(n,function(){i.dequeue(n,t)},f));r.length||(i.removeData(n,t+"queue "+t+".run",!0),pt(n,t,"queue"))}});i.fn.extend({queue:function(n,r){return(typeof n!="string"&&(r=n,n="fx"),r===t)?i.queue(this[0],n):this.each(function(){var t=i.queue(this,n,r);n==="fx"&&t[0]!=="inprogress"&&i.dequeue(this,n)})},dequeue:function(n){return this.each(function(){i.dequeue(this,n)})},delay:function(n,t){return n=i.fx?i.fx.speeds[n]||n:n,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,n);i.stop=function(){clearTimeout(r)}})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,r){function c(){--o||e.resolveWith(u,[u])}typeof n!="string"&&(r=n,n=t);n=n||"fx";for(var e=i.Deferred(),u=this,f=u.length,o=1,s=n+"defer",l=n+"queue",a=n+"mark",h;f--;)(h=i.data(u[f],s,t,!0)||(i.data(u[f],l,t,!0)||i.data(u[f],a,t,!0))&&i.data(u[f],s,i.Callbacks("once memory"),!0))&&(o++,h.add(c));return c(),e.promise()}});var wt=/[\n\t\r]/g,w=/\s+/,dr=/\r/g,gr=/^(?:button|input)$/i,nu=/^(?:button|input|object|select|textarea)$/i,tu=/^a(?:rea)?$/i,bt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,kt=i.support.getSetAttribute,e,dt,gt;i.fn.extend({attr:function(n,t){return i.access(this,n,t,!0,i.attr)},removeAttr:function(n){return this.each(function(){i.removeAttr(this,n)})},prop:function(n,t){return i.access(this,n,t,!0,i.prop)},removeProp:function(n){return n=i.propFix[n]||n,this.each(function(){try{this[n]=t;delete this[n]}catch(i){}})},addClass:function(n){var r,f,o,t,e,u,s;if(i.isFunction(n))return this.each(function(t){i(this).addClass(n.call(this,t,this.className))});if(n&&typeof n=="string")for(r=n.split(w),f=0,o=this.length;f<o;f++)if(t=this[f],t.nodeType===1)if(t.className||r.length!==1){for(e=" "+t.className+" ",u=0,s=r.length;u<s;u++)~e.indexOf(" "+r[u]+" ")||(e+=r[u]+" ");t.className=i.trim(e)}else t.className=n;return this},removeClass:function(n){var o,u,s,r,f,e,h;if(i.isFunction(n))return this.each(function(t){i(this).removeClass(n.call(this,t,this.className))});if(n&&typeof n=="string"||n===t)for(o=(n||"").split(w),u=0,s=this.length;u<s;u++)if(r=this[u],r.nodeType===1&&r.className)if(n){for(f=(" "+r.className+" ").replace(wt," "),e=0,h=o.length;e<h;e++)f=f.replace(" "+o[e]+" "," ");r.className=i.trim(f)}else r.className="";return this},toggleClass:function(n,t){var r=typeof n,u=typeof t=="boolean";return i.isFunction(n)?this.each(function(r){i(this).toggleClass(n.call(this,r,this.className,t),t)}):this.each(function(){if(r==="string")for(var f,s=0,o=i(this),e=t,h=n.split(w);f=h[s++];)e=u?e:!o.hasClass(f),o[e?"addClass":"removeClass"](f);else(r==="undefined"||r==="boolean")&&(this.className&&i._data(this,"__className__",this.className),this.className=this.className||n===!1?"":i._data(this,"__className__")||"")})},hasClass:function(n){for(var i=" "+n+" ",t=0,r=this.length;t<r;t++)if(this[t].nodeType===1&&(" "+this[t].className+" ").replace(wt," ").indexOf(i)>-1)return!0;return!1},val:function(n){var r,u,e,f=this[0];return arguments.length?(e=i.isFunction(n),this.each(function(u){var o=i(this),f;this.nodeType===1&&(f=e?n.call(this,u,o.val()):n,f==null?f="":typeof f=="number"?f+="":i.isArray(f)&&(f=i.map(f,function(n){return n==null?"":n+""})),r=i.valHooks[this.nodeName.toLowerCase()]||i.valHooks[this.type],r&&"set"in r&&r.set(this,f,"value")!==t||(this.value=f))})):f?(r=i.valHooks[f.nodeName.toLowerCase()]||i.valHooks[f.type],r&&"get"in r&&(u=r.get(f,"value"))!==t)?u:(u=f.value,typeof u=="string"?u.replace(dr,""):u==null?"":u):void 0}});i.extend({valHooks:{option:{get:function(n){var t=n.attributes.value;return!t||t.specified?n.value:n.text}},select:{get:function(n){var o,r,h,t,u=n.selectedIndex,s=[],f=n.options,e=n.type==="select-one";if(u<0)return null;for(r=e?u:0,h=e?u+1:f.length;r<h;r++)if(t=f[r],t.selected&&(i.support.optDisabled?!t.disabled:t.getAttribute("disabled")===null)&&(!t.parentNode.disabled||!i.nodeName(t.parentNode,"optgroup"))){if(o=i(t).val(),e)return o;s.push(o)}return e&&!s.length&&f.length?i(f[u]).val():s},set:function(n,t){var r=i.makeArray(t);return i(n).find("option").each(function(){this.selected=i.inArray(i(this).val(),r)>=0}),r.length||(n.selectedIndex=-1),r}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(n,r,u,f){var o,s,h,c=n.nodeType;if(n&&c!==3&&c!==8&&c!==2){if(f&&r in i.attrFn)return i(n)[r](u);if(typeof n.getAttribute=="undefined")return i.prop(n,r,u);if(h=c!==1||!i.isXMLDoc(n),h&&(r=r.toLowerCase(),s=i.attrHooks[r]||(bt.test(r)?dt:e)),u!==t){if(u===null){i.removeAttr(n,r);return}return s&&"set"in s&&h&&(o=s.set(n,u,r))!==t?o:(n.setAttribute(r,""+u),u)}return s&&"get"in s&&h&&(o=s.get(n,r))!==null?o:(o=n.getAttribute(r),o===null?t:o)}},removeAttr:function(n,t){var u,f,r,o,e=0;if(t&&n.nodeType===1)for(f=t.toLowerCase().split(w),o=f.length;e<o;e++)r=f[e],r&&(u=i.propFix[r]||r,i.attr(n,r,""),n.removeAttribute(kt?r:u),bt.test(r)&&u in n&&(n[u]=!1))},attrHooks:{type:{set:function(n,t){if(gr.test(n.nodeName)&&n.parentNode)i.error("type property can't be changed");else if(!i.support.radioValue&&t==="radio"&&i.nodeName(n,"input")){var r=n.value;return n.setAttribute("type",t),r&&(n.value=r),t}}},value:{get:function(n,t){return e&&i.nodeName(n,"button")?e.get(n,t):t in n?n.value:null},set:function(n,t,r){if(e&&i.nodeName(n,"button"))return e.set(n,t,r);n.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(n,r,u){var e,f,s,o=n.nodeType;if(n&&o!==3&&o!==8&&o!==2)return s=o!==1||!i.isXMLDoc(n),s&&(r=i.propFix[r]||r,f=i.propHooks[r]),u!==t?f&&"set"in f&&(e=f.set(n,u,r))!==t?e:n[r]=u:f&&"get"in f&&(e=f.get(n,r))!==null?e:n[r]},propHooks:{tabIndex:{get:function(n){var i=n.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):nu.test(n.nodeName)||tu.test(n.nodeName)&&n.href?0:t}}}});i.attrHooks.tabindex=i.propHooks.tabIndex;dt={get:function(n,r){var u,f=i.prop(n,r);return f===!0||typeof f!="boolean"&&(u=n.getAttributeNode(r))&&u.nodeValue!==!1?r.toLowerCase():t},set:function(n,t,r){var u;return t===!1?i.removeAttr(n,r):(u=i.propFix[r]||r,u in n&&(n[u]=!0),n.setAttribute(r,r.toLowerCase())),r}};kt||(gt={name:!0,id:!0},e=i.valHooks.button={get:function(n,i){var r;return r=n.getAttributeNode(i),r&&(gt[i]?r.nodeValue!=="":r.specified)?r.nodeValue:t},set:function(n,t,i){var u=n.getAttributeNode(i);return u||(u=r.createAttribute(i),n.setAttributeNode(u)),u.nodeValue=t+""}},i.attrHooks.tabindex.set=e.set,i.each(["width","height"],function(n,t){i.attrHooks[t]=i.extend(i.attrHooks[t],{set:function(n,i){if(i==="")return n.setAttribute(t,"auto"),i}})}),i.attrHooks.contenteditable={get:e.get,set:function(n,t,i){t===""&&(t="false");e.set(n,t,i)}});i.support.hrefNormalized||i.each(["href","src","width","height"],function(n,r){i.attrHooks[r]=i.extend(i.attrHooks[r],{get:function(n){var i=n.getAttribute(r,2);return i===null?t:i}})});i.support.style||(i.attrHooks.style={get:function(n){return n.style.cssText.toLowerCase()||t},set:function(n,t){return n.style.cssText=""+t}});i.support.optSelected||(i.propHooks.selected=i.extend(i.propHooks.selected,{get:function(n){var t=n.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}));i.support.enctype||(i.propFix.enctype="encoding");i.support.checkOn||i.each(["radio","checkbox"],function(){i.valHooks[this]={get:function(n){return n.getAttribute("value")===null?"on":n.value}}});i.each(["radio","checkbox"],function(){i.valHooks[this]=i.extend(i.valHooks[this],{set:function(n,t){if(i.isArray(t))return n.checked=i.inArray(i(n).val(),t)>=0}})});var rt=/^(?:textarea|input|select)$/i,ni=/^([^\.]*)?(?:\.(.+))?$/,iu=/\bhover(\.\S+)?\b/,ru=/^key/,uu=/^(?:mouse|contextmenu)|click/,ti=/^(?:focusinfocus|focusoutblur)$/,fu=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,eu=function(n){var t=fu.exec(n);return t&&(t[1]=(t[1]||"").toLowerCase(),t[3]=t[3]&&new RegExp("(?:^|\\s)"+t[3]+"(?:\\s|$)")),t},ou=function(n,t){var i=n.attributes||{};return(!t[1]||n.nodeName.toLowerCase()===t[1])&&(!t[2]||(i.id||{}).value===t[2])&&(!t[3]||t[3].test((i["class"]||{}).value))},ii=function(n){return i.event.special.hover?n:n.replace(iu,"mouseenter$1 mouseleave$1")};i.event={add:function(n,r,u,f,e){var a,s,v,y,p,o,w,l,b,c,h;if(n.nodeType!==3&&n.nodeType!==8&&r&&u&&(a=i._data(n))){for(u.handler&&(b=u,u=b.handler),u.guid||(u.guid=i.guid++),v=a.events,v||(a.events=v={}),s=a.handle,s||(a.handle=s=function(n){return typeof i!="undefined"&&(!n||i.event.triggered!==n.type)?i.event.dispatch.apply(s.elem,arguments):t},s.elem=n),r=i.trim(ii(r)).split(" "),y=0;y<r.length;y++)p=ni.exec(r[y])||[],o=p[1],w=(p[2]||"").split(".").sort(),h=i.event.special[o]||{},o=(e?h.delegateType:h.bindType)||o,h=i.event.special[o]||{},l=i.extend({type:o,origType:p[1],data:f,handler:u,guid:u.guid,selector:e,quick:eu(e),namespace:w.join(".")},b),c=v[o],c||(c=v[o]=[],c.delegateCount=0,h.setup&&h.setup.call(n,f,w,s)!==!1||(n.addEventListener?n.addEventListener(o,s,!1):n.attachEvent&&n.attachEvent("on"+o,s))),h.add&&(h.add.call(n,l),l.handler.guid||(l.handler.guid=u.guid)),e?c.splice(c.delegateCount++,0,l):c.push(l),i.event.global[o]=!0;n=null}},global:{},remove:function(n,t,r,u,f){var y=i.hasData(n)&&i._data(n),l,p,e,b,h,k,a,v,c,w,o,s;if(y&&(v=y.events)){for(t=i.trim(ii(t||"")).split(" "),l=0;l<t.length;l++){if(p=ni.exec(t[l])||[],e=b=p[1],h=p[2],!e){for(e in v)i.event.remove(n,e+t[l],r,u,!0);continue}for(c=i.event.special[e]||{},e=(u?c.delegateType:c.bindType)||e,o=v[e]||[],k=o.length,h=h?new RegExp("(^|\\.)"+h.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,a=0;a<o.length;a++)s=o[a],(f||b===s.origType)&&(!r||r.guid===s.guid)&&(!h||h.test(s.namespace))&&(!u||u===s.selector||u==="**"&&s.selector)&&(o.splice(a--,1),s.selector&&o.delegateCount--,c.remove&&c.remove.call(n,s));o.length===0&&k!==o.length&&(c.teardown&&c.teardown.call(n,h)!==!1||i.removeEvent(n,e,y.handle),delete v[e])}i.isEmptyObject(v)&&(w=y.handle,w&&(w.elem=null),i.removeData(n,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(r,u,f,e){if(!f||f.nodeType!==3&&f.nodeType!==8){var o=r.type||r,p=[],w,k,c,s,h,a,l,v,y,b;if(!ti.test(o+i.event.triggered)&&(o.indexOf("!")>=0&&(o=o.slice(0,-1),k=!0),o.indexOf(".")>=0&&(p=o.split("."),o=p.shift(),p.sort()),f&&!i.event.customEvent[o]||i.event.global[o])){if(r=typeof r=="object"?r[i.expando]?r:new i.Event(o,r):new i.Event(o),r.type=o,r.isTrigger=!0,r.exclusive=k,r.namespace=p.join("."),r.namespace_re=r.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,a=o.indexOf(":")<0?"on"+o:"",!f){w=i.cache;for(c in w)w[c].events&&w[c].events[o]&&i.event.trigger(r,u,w[c].handle.elem,!0);return}if(r.result=t,r.target||(r.target=f),u=u!=null?i.makeArray(u):[],u.unshift(r),l=i.event.special[o]||{},!l.trigger||l.trigger.apply(f,u)!==!1){if(y=[[f,l.bindType||o]],!e&&!l.noBubble&&!i.isWindow(f)){for(b=l.delegateType||o,s=ti.test(b+o)?f:f.parentNode,h=null;s;s=s.parentNode)y.push([s,b]),h=s;h&&h===f.ownerDocument&&y.push([h.defaultView||h.parentWindow||n,b])}for(c=0;c<y.length&&!r.isPropagationStopped();c++)s=y[c][0],r.type=y[c][1],v=(i._data(s,"events")||{})[r.type]&&i._data(s,"handle"),v&&v.apply(s,u),v=a&&s[a],v&&i.acceptData(s)&&v.apply(s,u)===!1&&r.preventDefault();return r.type=o,e||r.isDefaultPrevented()||l._default&&l._default.apply(f.ownerDocument,u)!==!1||o==="click"&&i.nodeName(f,"a")||!i.acceptData(f)||a&&f[o]&&(o!=="focus"&&o!=="blur"||r.target.offsetWidth!==0)&&!i.isWindow(f)&&(h=f[a],h&&(f[a]=null),i.event.triggered=o,f[o](),i.event.triggered=t,h&&(f[a]=h)),r.result}}}},dispatch:function(r){r=i.event.fix(r||n.event);var h=(i._data(this,"events")||{})[r.type]||[],c=h.delegateCount,b=[].slice.call(arguments,0),k=!r.exclusive&&!r.namespace,l=[],f,a,e,v,y,p,o,w,u,s;if(b[0]=r,r.delegateTarget=this,c&&!r.target.disabled&&!(r.button&&r.type==="click"))for(v=i(this),v.context=this.ownerDocument||this,e=r.target;e!=this;e=e.parentNode||this){for(p={},w=[],v[0]=e,f=0;f<c;f++)u=h[f],s=u.selector,p[s]===t&&(p[s]=u.quick?ou(e,u.quick):v.is(s)),p[s]&&w.push(u);w.length&&l.push({elem:e,matches:w})}for(h.length>c&&l.push({elem:this,matches:h.slice(c)}),f=0;f<l.length&&!r.isPropagationStopped();f++)for(o=l[f],r.currentTarget=o.elem,a=0;a<o.matches.length&&!r.isImmediatePropagationStopped();a++)u=o.matches[a],(k||!r.namespace&&!u.namespace||r.namespace_re&&r.namespace_re.test(u.namespace))&&(r.data=u.data,r.handleObj=u,y=((i.event.special[u.origType]||{}).handle||u.handler).apply(o.elem,b),y!==t&&(r.result=y,y===!1&&(r.preventDefault(),r.stopPropagation())));return r.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(n,t){return n.which==null&&(n.which=t.charCode!=null?t.charCode:t.keyCode),n}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(n,i){var o,u,f,e=i.button,s=i.fromElement;return n.pageX==null&&i.clientX!=null&&(o=n.target.ownerDocument||r,u=o.documentElement,f=o.body,n.pageX=i.clientX+(u&&u.scrollLeft||f&&f.scrollLeft||0)-(u&&u.clientLeft||f&&f.clientLeft||0),n.pageY=i.clientY+(u&&u.scrollTop||f&&f.scrollTop||0)-(u&&u.clientTop||f&&f.clientTop||0)),!n.relatedTarget&&s&&(n.relatedTarget=s===n.target?i.toElement:s),n.which||e===t||(n.which=e&1?1:e&2?3:e&4?2:0),n}},fix:function(n){if(n[i.expando])return n;var e,o,u=n,f=i.event.fixHooks[n.type]||{},s=f.props?this.props.concat(f.props):this.props;for(n=i.Event(u),e=s.length;e;)o=s[--e],n[o]=u[o];return n.target||(n.target=u.srcElement||r),n.target.nodeType===3&&(n.target=n.target.parentNode),n.metaKey===t&&(n.metaKey=n.ctrlKey),f.filter?f.filter(n,u):n},special:{ready:{setup:i.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(n,t,r){i.isWindow(this)&&(this.onbeforeunload=r)},teardown:function(n,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(n,t,r,u){var f=i.extend(new i.Event,r,{type:n,isSimulated:!0,originalEvent:{}});u?i.event.trigger(f,null,t):i.event.dispatch.call(t,f);f.isDefaultPrevented()&&r.preventDefault()}};i.event.handle=i.event.dispatch;i.removeEvent=r.removeEventListener?function(n,t,i){n.removeEventListener&&n.removeEventListener(t,i,!1)}:function(n,t,i){n.detachEvent&&n.detachEvent("on"+t,i)};i.Event=function(n,t){if(!(this instanceof i.Event))return new i.Event(n,t);n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||n.returnValue===!1||n.getPreventDefault&&n.getPreventDefault()?b:h):this.type=n;t&&i.extend(this,t);this.timeStamp=n&&n.timeStamp||i.now();this[i.expando]=!0};i.Event.prototype={preventDefault:function(){this.isDefaultPrevented=b;var n=this.originalEvent;n&&(n.preventDefault?n.preventDefault():n.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=b;var n=this.originalEvent;n&&(n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=b;this.stopPropagation()},isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h};i.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(n,t){i.event.special[n]={delegateType:t,bindType:t,handle:function(n){var f=this,r=n.relatedTarget,u=n.handleObj,o=u.selector,e;return r&&(r===f||i.contains(f,r))||(n.type=u.origType,e=u.handler.apply(this,arguments),n.type=t),e}}});i.support.submitBubbles||(i.event.special.submit={setup:function(){if(i.nodeName(this,"form"))return!1;i.event.add(this,"click._submit keypress._submit",function(n){var u=n.target,r=i.nodeName(u,"input")||i.nodeName(u,"button")?u.form:t;r&&!r._submit_attached&&(i.event.add(r,"submit._submit",function(n){this.parentNode&&!n.isTrigger&&i.event.simulate("submit",this.parentNode,n,!0)}),r._submit_attached=!0)})},teardown:function(){if(i.nodeName(this,"form"))return!1;i.event.remove(this,"._submit")}});i.support.changeBubbles||(i.event.special.change={setup:function(){if(rt.test(this.nodeName))return(this.type==="checkbox"||this.type==="radio")&&(i.event.add(this,"propertychange._change",function(n){n.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),i.event.add(this,"click._change",function(n){this._just_changed&&!n.isTrigger&&(this._just_changed=!1,i.event.simulate("change",this,n,!0))})),!1;i.event.add(this,"beforeactivate._change",function(n){var t=n.target;rt.test(t.nodeName)&&!t._change_attached&&(i.event.add(t,"change._change",function(n){!this.parentNode||n.isSimulated||n.isTrigger||i.event.simulate("change",this.parentNode,n,!0)}),t._change_attached=!0)})},handle:function(n){var t=n.target;if(this!==t||n.isSimulated||n.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return n.handleObj.handler.apply(this,arguments)},teardown:function(){return i.event.remove(this,"._change"),rt.test(this.nodeName)}});i.support.focusinBubbles||i.each({focus:"focusin",blur:"focusout"},function(n,t){var u=0,f=function(n){i.event.simulate(t,n.target,i.event.fix(n),!0)};i.event.special[t]={setup:function(){u++==0&&r.addEventListener(n,f,!0)},teardown:function(){--u==0&&r.removeEventListener(n,f,!0)}}});i.fn.extend({on:function(n,r,u,f,e){var o,s;if(typeof n=="object"){typeof r!="string"&&(u=r,r=t);for(s in n)this.on(s,r,u,n[s],e);return this}if(u==null&&f==null?(f=r,u=r=t):f==null&&(typeof r=="string"?(f=u,u=t):(f=u,u=r,r=t)),f===!1)f=h;else if(!f)return this;return e===1&&(o=f,f=function(n){return i().off(n),o.apply(this,arguments)},f.guid=o.guid||(o.guid=i.guid++)),this.each(function(){i.event.add(this,n,f,u,r)})},one:function(n,t,i,r){return this.on.call(this,n,t,i,r,1)},off:function(n,r,u){var f,e;if(n&&n.preventDefault&&n.handleObj)return f=n.handleObj,i(n.delegateTarget).off(f.namespace?f.type+"."+f.namespace:f.type,f.selector,f.handler),this;if(typeof n=="object"){for(e in n)this.off(e,r,n[e]);return this}return(r===!1||typeof r=="function")&&(u=r,r=t),u===!1&&(u=h),this.each(function(){i.event.remove(this,n,u,r)})},bind:function(n,t,i){return this.on(n,null,t,i)},unbind:function(n,t){return this.off(n,null,t)},live:function(n,t,r){i(this.context).on(n,this.selector,t,r);return this},die:function(n,t){return i(this.context).off(n,this.selector||"**",t),this},delegate:function(n,t,i,r){return this.on(t,n,i,r)},undelegate:function(n,t,i){return arguments.length==1?this.off(n,"**"):this.off(t,n,i)},trigger:function(n,t){return this.each(function(){i.event.trigger(n,t,this)})},triggerHandler:function(n,t){if(this[0])return i.event.trigger(n,t,this[0],!0)},toggle:function(n){var t=arguments,u=n.guid||i.guid++,r=0,f=function(u){var f=(i._data(this,"lastToggle"+n.guid)||0)%r;return i._data(this,"lastToggle"+n.guid,f+1),u.preventDefault(),t[f].apply(this,arguments)||!1};for(f.guid=u;r<t.length;)t[r++].guid=u;return this.click(f)},hover:function(n,t){return this.mouseenter(n).mouseleave(t||n)}});i.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(n,t){i.fn[t]=function(n,i){return i==null&&(i=n,n=null),arguments.length>0?this.on(t,null,n,i):this.trigger(t)};i.attrFn&&(i.attrFn[t]=!0);ru.test(t)&&(i.event.fixHooks[t]=i.event.keyHooks);uu.test(t)&&(i.event.fixHooks[t]=i.event.mouseHooks)});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){function d(n,t,i,r,u,f){for(var o,h,s=0,c=r.length;s<c;s++)if(o=r[s],o){for(h=!1,o=o[n];o;){if(o[e]===i){h=r[o.sizset];break}if(o.nodeType!==1||f||(o[e]=i,o.sizset=s),o.nodeName.toLowerCase()===t){h=o;break}o=o[n]}r[s]=h}}function g(t,i,r,u,f,o){for(var s,c,h=0,l=u.length;h<l;h++)if(s=u[h],s){for(c=!1,s=s[t];s;){if(s[e]===r){c=u[s.sizset];break}if(s.nodeType===1)if(o||(s[e]=r,s.sizset=h),typeof i!="string"){if(s===i){c=!0;break}}else if(n.filter(i,[s]).length>0){c=s;break}s=s[t]}u[h]=c}}var v=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e="sizcache"+(Math.random()+"").replace(".",""),y=0,b=Object.prototype.toString,c=!1,k=!0,o=/\\/g,nt=/\r\n/g,l=/\W/,n,s,f,a,h,w;[0,0].sort(function(){return k=!1,0});n=function(t,i,e,o){var nt;if(e=e||[],i=i||r,nt=i,i.nodeType!==1&&i.nodeType!==9)return[];if(!t||typeof t!="string")return e;var y,a,h,g,l,p,k,c,it=!0,d=n.isXML(i),s=[],rt=t;do if(v.exec(""),y=v.exec(rt),y&&(rt=y[3],s.push(y[1]),y[2])){g=y[3];break}while(y);if(s.length>1&&tt.exec(t))if(s.length===2&&u.relative[s[0]])a=w(s[0]+s[1],i,o);else for(a=u.relative[s[0]]?[i]:n(s.shift(),i);s.length;)t=s.shift(),u.relative[t]&&(t+=s.shift()),a=w(t,a,o);else if(!o&&s.length>1&&i.nodeType===9&&!d&&u.match.ID.test(s[0])&&!u.match.ID.test(s[s.length-1])&&(l=n.find(s.shift(),i,d),i=l.expr?n.filter(l.expr,l.set)[0]:l.set[0]),i)for(l=o?{expr:s.pop(),set:f(o)}:n.find(s.pop(),s.length===1&&(s[0]==="~"||s[0]==="+")&&i.parentNode?i.parentNode:i,d),a=l.expr?n.filter(l.expr,l.set):l.set,s.length>0?h=f(a):it=!1;s.length;)p=s.pop(),k=p,u.relative[p]?k=s.pop():p="",k==null&&(k=i),u.relative[p](h,k,d);else h=s=[];if(h||(h=a),h||n.error(p||t),b.call(h)==="[object Array]")if(it)if(i&&i.nodeType===1)for(c=0;h[c]!=null;c++)h[c]&&(h[c]===!0||h[c].nodeType===1&&n.contains(i,h[c]))&&e.push(a[c]);else for(c=0;h[c]!=null;c++)h[c]&&h[c].nodeType===1&&e.push(a[c]);else e.push.apply(e,h);else f(h,e);return g&&(n(g,nt,e,o),n.uniqueSort(e)),e};n.uniqueSort=function(n){if(a&&(c=k,n.sort(a),c))for(var t=1;t<n.length;t++)n[t]===n[t-1]&&n.splice(t--,1);return n};n.matches=function(t,i){return n(t,null,null,i)};n.matchesSelector=function(t,i){return n(i,null,null,[t]).length>0};n.find=function(n,t,i){var f,e,c,r,s,h;if(!n)return[];for(e=0,c=u.order.length;e<c;e++)if(s=u.order[e],(r=u.leftMatch[s].exec(n))&&(h=r[1],r.splice(1,1),h.substr(h.length-1)!=="\\"&&(r[1]=(r[1]||"").replace(o,""),f=u.find[s](r,t,i),f!=null))){n=n.replace(u.match[s],"");break}return f||(f=typeof t.getElementsByTagName!="undefined"?t.getElementsByTagName("*"):[]),{set:f,expr:n}};n.filter=function(i,r,f,e){for(var o,h,c,l,y,b,p,a,w,k=i,v=[],s=r,d=r&&r[0]&&n.isXML(r[0]);i&&r.length;){for(c in u.filter)if((o=u.leftMatch[c].exec(i))!=null&&o[2]){if(b=u.filter[c],p=o[1],h=!1,o.splice(1,1),p.substr(p.length-1)==="\\")continue;if(s===v&&(v=[]),u.preFilter[c])if(o=u.preFilter[c](o,s,f,v,e,d),o){if(o===!0)continue}else h=l=!0;if(o)for(a=0;(y=s[a])!=null;a++)y&&(l=b(y,o,a,s),w=e^l,f&&l!=null?w?h=!0:s[a]=!1:w&&(v.push(y),h=!0));if(l!==t){if(f||(s=v),i=i.replace(u.match[c],""),!h)return[];break}}if(i===k)if(h==null)n.error(i);else break;k=i}return s};n.error=function(n){throw new Error("Syntax error, unrecognized expression: "+n);};var p=n.getText=function(n){var i,r,t=n.nodeType,u="";if(t){if(t===1||t===9){if(typeof n.textContent=="string")return n.textContent;if(typeof n.innerText=="string")return n.innerText.replace(nt,"");for(n=n.firstChild;n;n=n.nextSibling)u+=p(n)}else if(t===3||t===4)return n.nodeValue}else for(i=0;r=n[i];i++)r.nodeType!==8&&(u+=p(r));return u},u=n.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(n){return n.getAttribute("href")},type:function(n){return n.getAttribute("type")}},relative:{"+":function(t,i){var f=typeof i=="string",e=f&&!l.test(i),o=f&&!e,u,s,r;for(e&&(i=i.toLowerCase()),u=0,s=t.length;u<s;u++)if(r=t[u]){while((r=r.previousSibling)&&r.nodeType!==1);t[u]=o||r&&r.nodeName.toLowerCase()===i?r||!1:r===i}o&&n.filter(i,t,!0)},">":function(t,i){var u,f=typeof i=="string",r=0,o=t.length,e;if(f&&!l.test(i))for(i=i.toLowerCase();r<o;r++)u=t[r],u&&(e=u.parentNode,t[r]=e.nodeName.toLowerCase()===i?e:!1);else{for(;r<o;r++)u=t[r],u&&(t[r]=f?u.parentNode:u.parentNode===i);f&&n.filter(i,t,!0)}},"":function(n,t,i){var r,f=y++,u=g;typeof t!="string"||l.test(t)||(t=t.toLowerCase(),r=t,u=d);u("parentNode",t,f,n,r,i)},"~":function(n,t,i){var r,f=y++,u=g;typeof t!="string"||l.test(t)||(t=t.toLowerCase(),r=t,u=d);u("previousSibling",t,f,n,r,i)}},find:{ID:function(n,t,i){if(typeof t.getElementById!="undefined"&&!i){var r=t.getElementById(n[1]);return r&&r.parentNode?[r]:[]}},NAME:function(n,t){var r,u,i,f;if(typeof t.getElementsByName!="undefined"){for(r=[],u=t.getElementsByName(n[1]),i=0,f=u.length;i<f;i++)u[i].getAttribute("name")===n[1]&&r.push(u[i]);return r.length===0?null:r}},TAG:function(n,t){if(typeof t.getElementsByTagName!="undefined")return t.getElementsByTagName(n[1])}},preFilter:{CLASS:function(n,t,i,r,u,f){if(n=" "+n[1].replace(o,"")+" ",f)return n;for(var s=0,e;(e=t[s])!=null;s++)e&&(u^(e.className&&(" "+e.className+" ").replace(/[\t\n\r]/g," ").indexOf(n)>=0)?i||r.push(e):i&&(t[s]=!1));return!1},ID:function(n){return n[1].replace(o,"")},TAG:function(n){return n[1].replace(o,"").toLowerCase()},CHILD:function(t){if(t[1]==="nth"){t[2]||n.error(t[0]);t[2]=t[2].replace(/^\+|\s*/g,"");var i=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(t[2]==="even"&&"2n"||t[2]==="odd"&&"2n+1"||!/\D/.test(t[2])&&"0n+"+t[2]||t[2]);t[2]=i[1]+(i[2]||1)-0;t[3]=i[3]-0}else t[2]&&n.error(t[0]);return t[0]=y++,t},ATTR:function(n,t,i,r,f,e){var s=n[1]=n[1].replace(o,"");return!e&&u.attrMap[s]&&(n[1]=u.attrMap[s]),n[4]=(n[4]||n[5]||"").replace(o,""),n[2]==="~="&&(n[4]=" "+n[4]+" "),n},PSEUDO:function(t,i,r,f,e){if(t[1]==="not")if((v.exec(t[3])||"").length>1||/^\w/.test(t[3]))t[3]=n(t[3],null,null,i);else{var o=n.filter(t[3],i,r,!0^e);return r||f.push.apply(f,o),!1}else if(u.match.POS.test(t[0])||u.match.CHILD.test(t[0]))return!0;return t},POS:function(n){return n.unshift(!0),n}},filters:{enabled:function(n){return n.disabled===!1&&n.type!=="hidden"},disabled:function(n){return n.disabled===!0},checked:function(n){return n.checked===!0},selected:function(n){return n.parentNode&&n.parentNode.selectedIndex,n.selected===!0},parent:function(n){return!!n.firstChild},empty:function(n){return!n.firstChild},has:function(t,i,r){return!!n(r[3],t).length},header:function(n){return/h\d/i.test(n.nodeName)},text:function(n){var t=n.getAttribute("type"),i=n.type;return n.nodeName.toLowerCase()==="input"&&"text"===i&&(t===i||t===null)},radio:function(n){return n.nodeName.toLowerCase()==="input"&&"radio"===n.type},checkbox:function(n){return n.nodeName.toLowerCase()==="input"&&"checkbox"===n.type},file:function(n){return n.nodeName.toLowerCase()==="input"&&"file"===n.type},password:function(n){return n.nodeName.toLowerCase()==="input"&&"password"===n.type},submit:function(n){var t=n.nodeName.toLowerCase();return(t==="input"||t==="button")&&"submit"===n.type},image:function(n){return n.nodeName.toLowerCase()==="input"&&"image"===n.type},reset:function(n){var t=n.nodeName.toLowerCase();return(t==="input"||t==="button")&&"reset"===n.type},button:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&"button"===n.type||t==="button"},input:function(n){return/input|select|textarea|button/i.test(n.nodeName)},focus:function(n){return n===n.ownerDocument.activeElement}},setFilters:{first:function(n,t){return t===0},last:function(n,t,i,r){return t===r.length-1},even:function(n,t){return t%2==0},odd:function(n,t){return t%2==1},lt:function(n,t,i){return t<i[3]-0},gt:function(n,t,i){return t>i[3]-0},nth:function(n,t,i){return i[3]-0===t},eq:function(n,t,i){return i[3]-0===t}},filter:{PSEUDO:function(t,i,r,f){var e=i[1],h=u.filters[e],s,o,c;if(h)return h(t,r,i,f);if(e==="contains")return(t.textContent||t.innerText||p([t])||"").indexOf(i[3])>=0;if(e==="not"){for(s=i[3],o=0,c=s.length;o<c;o++)if(s[o]===t)return!1;return!0}n.error(e)},CHILD:function(n,t){var r,o,s,u,h,f,c=t[1],i=n;switch(c){case"only":case"first":while(i=i.previousSibling)if(i.nodeType===1)return!1;if(c==="first")return!0;i=n;case"last":while(i=i.nextSibling)if(i.nodeType===1)return!1;return!0;case"nth":if(r=t[2],o=t[3],r===1&&o===0)return!0;if(s=t[0],u=n.parentNode,u&&(u[e]!==s||!n.nodeIndex)){for(h=0,i=u.firstChild;i;i=i.nextSibling)i.nodeType===1&&(i.nodeIndex=++h);u[e]=s}return f=n.nodeIndex-o,r===0?f===0:f%r==0&&f/r>=0}},ID:function(n,t){return n.nodeType===1&&n.getAttribute("id")===t},TAG:function(n,t){return t==="*"&&n.nodeType===1||!!n.nodeName&&n.nodeName.toLowerCase()===t},CLASS:function(n,t){return(" "+(n.className||n.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(t,i){var o=i[1],s=n.attr?n.attr(t,o):u.attrHandle[o]?u.attrHandle[o](t):t[o]!=null?t[o]:t.getAttribute(o),f=s+"",e=i[2],r=i[4];return s==null?e==="!=":!e&&n.attr?s!=null:e==="="?f===r:e==="*="?f.indexOf(r)>=0:e==="~="?(" "+f+" ").indexOf(r)>=0:r?e==="!="?f!==r:e==="^="?f.indexOf(r)===0:e==="$="?f.substr(f.length-r.length)===r:e==="|="?f===r||f.substr(0,r.length+1)===r+"-":!1:f&&s!==!1},POS:function(n,t,i,r){var e=t[2],f=u.setFilters[e];if(f)return f(n,i,t,r)}}},tt=u.match.POS,it=function(n,t){return"\\"+(+t+1)};for(s in u.match)u.match[s]=new RegExp(u.match[s].source+/(?![^\[]*\])(?![^\(]*\))/.source),u.leftMatch[s]=new RegExp(/(^(?:.|\r|\n)*?)/.source+u.match[s].source.replace(/\\(\d+)/g,it));f=function(n,t){return(n=Array.prototype.slice.call(n,0),t)?(t.push.apply(t,n),t):n};try{Array.prototype.slice.call(r.documentElement.childNodes,0)[0].nodeType}catch(rt){f=function(n,t){var i=0,r=t||[],u;if(b.call(n)==="[object Array]")Array.prototype.push.apply(r,n);else if(typeof n.length=="number")for(u=n.length;i<u;i++)r.push(n[i]);else for(;n[i];i++)r.push(n[i]);return r}}r.documentElement.compareDocumentPosition?a=function(n,t){return n===t?(c=!0,0):!n.compareDocumentPosition||!t.compareDocumentPosition?n.compareDocumentPosition?-1:1:n.compareDocumentPosition(t)&4?-1:1}:(a=function(n,t){var i;if(n===t)return c=!0,0;if(n.sourceIndex&&t.sourceIndex)return n.sourceIndex-t.sourceIndex;var e,l,u=[],f=[],o=n.parentNode,s=t.parentNode,r=o;if(o===s)return h(n,t);if(o){if(!s)return 1}else return-1;while(r)u.unshift(r),r=r.parentNode;for(r=s;r;)f.unshift(r),r=r.parentNode;for(e=u.length,l=f.length,i=0;i<e&&i<l;i++)if(u[i]!==f[i])return h(u[i],f[i]);return i===e?h(n,f[i],-1):h(u[i],t,1)},h=function(n,t,i){if(n===t)return i;for(var r=n.nextSibling;r;){if(r===t)return-1;r=r.nextSibling}return 1}),function(){var n=r.createElement("div"),f="script"+(new Date).getTime(),i=r.documentElement;n.innerHTML="<a name='"+f+"'/>";i.insertBefore(n,i.firstChild);r.getElementById(f)&&(u.find.ID=function(n,i,r){if(typeof i.getElementById!="undefined"&&!r){var u=i.getElementById(n[1]);return u?u.id===n[1]||typeof u.getAttributeNode!="undefined"&&u.getAttributeNode("id").nodeValue===n[1]?[u]:t:[]}},u.filter.ID=function(n,t){var i=typeof n.getAttributeNode!="undefined"&&n.getAttributeNode("id");return n.nodeType===1&&i&&i.nodeValue===t});i.removeChild(n);i=n=null}(),function(){var n=r.createElement("div");n.appendChild(r.createComment(""));n.getElementsByTagName("*").length>0&&(u.find.TAG=function(n,t){var i=t.getElementsByTagName(n[1]),u,r;if(n[1]==="*"){for(u=[],r=0;i[r];r++)i[r].nodeType===1&&u.push(i[r]);i=u}return i});n.innerHTML="<a href='#'><\/a>";n.firstChild&&typeof n.firstChild.getAttribute!="undefined"&&n.firstChild.getAttribute("href")!=="#"&&(u.attrHandle.href=function(n){return n.getAttribute("href",2)});n=null}();r.querySelectorAll&&function(){var i=n,t=r.createElement("div"),o="__sizzle__",e;if(t.innerHTML="<p class='TEST'><\/p>",!t.querySelectorAll||t.querySelectorAll(".TEST").length!==0){n=function(t,e,s,h){var c,l;if(e=e||r,!h&&!n.isXML(e)){if(c=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t),c&&(e.nodeType===1||e.nodeType===9)){if(c[1])return f(e.getElementsByTagName(t),s);if(c[2]&&u.find.CLASS&&e.getElementsByClassName)return f(e.getElementsByClassName(c[2]),s)}if(e.nodeType===9){if(t==="body"&&e.body)return f([e.body],s);if(c&&c[3])if(l=e.getElementById(c[3]),l&&l.parentNode){if(l.id===c[3])return f([l],s)}else return f([],s);try{return f(e.querySelectorAll(t),s)}catch(b){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var w=e,v=e.getAttribute("id"),a=v||o,y=e.parentNode,p=/^\s*[+~]/.test(t);v?a=a.replace(/'/g,"\\$&"):e.setAttribute("id",a);p&&y&&(e=e.parentNode);try{if(!p||y)return f(e.querySelectorAll("[id='"+a+"'] "+t),s)}catch(k){}finally{v||w.removeAttribute("id")}}}return i(t,e,s,h)};for(e in i)n[e]=i[e];t=null}}(),function(){var t=r.documentElement,i=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector,e,f;if(i){e=!i.call(r.createElement("div"),"div");f=!1;try{i.call(r.documentElement,"[test!='']:sizzle")}catch(o){f=!0}n.matchesSelector=function(t,r){if(r=r.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!n.isXML(t))try{if(f||!u.match.PSEUDO.test(r)&&!/!=/.test(r)){var o=i.call(t,r);if(o||!e||t.document&&t.document.nodeType!==11)return o}}catch(s){}return n(r,null,null,[t]).length>0}}}(),function(){var n=r.createElement("div");(n.innerHTML="<div class='test e'><\/div><div class='test'><\/div>",n.getElementsByClassName&&n.getElementsByClassName("e").length!==0)&&(n.lastChild.className="e",n.getElementsByClassName("e").length!==1)&&(u.order.splice(1,0,"CLASS"),u.find.CLASS=function(n,t,i){if(typeof t.getElementsByClassName!="undefined"&&!i)return t.getElementsByClassName(n[1])},n=null)}();n.contains=r.documentElement.contains?function(n,t){return n!==t&&(n.contains?n.contains(t):!0)}:r.documentElement.compareDocumentPosition?function(n,t){return!!(n.compareDocumentPosition(t)&16)}:function(){return!1};n.isXML=function(n){var t=(n?n.ownerDocument||n:0).documentElement;return t?t.nodeName!=="HTML":!1};w=function(t,i,r){for(var e,o=[],s="",h=i.nodeType?[i]:i,f,c;e=u.match.PSEUDO.exec(t);)s+=e[0],t=t.replace(u.match.PSEUDO,"");for(t=u.relative[t]?t+"*":t,f=0,c=h.length;f<c;f++)n(t,h[f],o,r);return n.filter(s,o)};n.attr=i.attr;n.selectors.attrMap={};i.find=n;i.expr=n.selectors;i.expr[":"]=i.expr.filters;i.unique=n.uniqueSort;i.text=n.getText;i.isXMLDoc=n.isXML;i.contains=n.contains})();var su=/Until$/,hu=/^(?:parents|prevUntil|prevAll)/,cu=/,/,lu=/^.[^:#\[\.,]*$/,au=Array.prototype.slice,ri=i.expr.match.POS,vu={children:!0,contents:!0,next:!0,prev:!0};i.fn.extend({find:function(n){var s=this,t,f,r,o,u,e;if(typeof n!="string")return i(n).filter(function(){for(t=0,f=s.length;t<f;t++)if(i.contains(s[t],this))return!0});for(r=this.pushStack("","find",n),t=0,f=this.length;t<f;t++)if(o=r.length,i.find(n,this[t],r),t>0)for(u=o;u<r.length;u++)for(e=0;e<o;e++)if(r[e]===r[u]){r.splice(u--,1);break}return r},has:function(n){var t=i(n);return this.filter(function(){for(var n=0,r=t.length;n<r;n++)if(i.contains(this,t[n]))return!0})},not:function(n){return this.pushStack(fi(this,n,!1),"not",n)},filter:function(n){return this.pushStack(fi(this,n,!0),"filter",n)},is:function(n){return!!n&&(typeof n=="string"?ri.test(n)?i(n,this.context).index(this[0])>=0:i.filter(n,this).length>0:this.filter(n).length>0)},closest:function(n,t){var f=[],u,s,r=this[0],e,o;if(i.isArray(n)){for(e=1;r&&r.ownerDocument&&r!==t;){for(u=0;u<n.length;u++)i(r).is(n[u])&&f.push({selector:n[u],elem:r,level:e});r=r.parentNode;e++}return f}for(o=ri.test(n)||typeof n!="string"?i(n,t||this.context):0,u=0,s=this.length;u<s;u++)for(r=this[u];r;)if(o?o.index(r)>-1:i.find.matchesSelector(r,n)){f.push(r);break}else if(r=r.parentNode,!r||!r.ownerDocument||r===t||r.nodeType===11)break;return f=f.length>1?i.unique(f):f,this.pushStack(f,"closest",n)},index:function(n){return n?typeof n=="string"?i.inArray(this[0],i(n)):i.inArray(n.jquery?n[0]:n,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(n,t){var u=typeof n=="string"?i(n,t):i.makeArray(n&&n.nodeType?[n]:n),r=i.merge(this.get(),u);return this.pushStack(ui(u[0])||ui(r[0])?r:i.unique(r))},andSelf:function(){return this.add(this.prevObject)}});i.each({parent:function(n){var t=n.parentNode;return t&&t.nodeType!==11?t:null},parents:function(n){return i.dir(n,"parentNode")},parentsUntil:function(n,t,r){return i.dir(n,"parentNode",r)},next:function(n){return i.nth(n,2,"nextSibling")},prev:function(n){return i.nth(n,2,"previousSibling")},nextAll:function(n){return i.dir(n,"nextSibling")},prevAll:function(n){return i.dir(n,"previousSibling")},nextUntil:function(n,t,r){return i.dir(n,"nextSibling",r)},prevUntil:function(n,t,r){return i.dir(n,"previousSibling",r)},siblings:function(n){return i.sibling(n.parentNode.firstChild,n)},children:function(n){return i.sibling(n.firstChild)},contents:function(n){return i.nodeName(n,"iframe")?n.contentDocument||n.contentWindow.document:i.makeArray(n.childNodes)}},function(n,t){i.fn[n]=function(r,u){var f=i.map(this,t,r);return su.test(n)||(u=r),u&&typeof u=="string"&&(f=i.filter(u,f)),f=this.length>1&&!vu[n]?i.unique(f):f,(this.length>1||cu.test(u))&&hu.test(n)&&(f=f.reverse()),this.pushStack(f,n,au.call(arguments).join(","))}});i.extend({filter:function(n,t,r){return r&&(n=":not("+n+")"),t.length===1?i.find.matchesSelector(t[0],n)?[t[0]]:[]:i.find.matches(n,t)},dir:function(n,r,u){for(var e=[],f=n[r];f&&f.nodeType!==9&&(u===t||f.nodeType!==1||!i(f).is(u));)f.nodeType===1&&e.push(f),f=f[r];return e},nth:function(n,t,i){t=t||1;for(var r=0;n;n=n[i])if(n.nodeType===1&&++r===t)break;return n},sibling:function(n,t){for(var i=[];n;n=n.nextSibling)n.nodeType===1&&n!==t&&i.push(n);return i}});var oi="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",yu=/ jQuery\d+="(?:\d+|null)"/g,ut=/^\s+/,si=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,hi=/<([\w:]+)/,pu=/<tbody/i,wu=/<|&#?\w+;/,bu=/<(?:script|style)/i,ku=/<(?:script|object|embed|option|style)/i,ci=new RegExp("<(?:"+oi+")","i"),li=/checked\s*(?:[^=]|=\s*.checked.)/i,du=/\/(java|ecma)script/i,gu=/^\s*<!(?:\[CDATA\[|\-\-)/,u={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],area:[1,"<map>","<\/map>"],_default:[0,"",""]},ai=ei(r);u.optgroup=u.option;u.tbody=u.tfoot=u.colgroup=u.caption=u.thead;u.th=u.td;i.support.htmlSerialize||(u._default=[1,"div<div>","<\/div>"]);i.fn.extend({text:function(n){return i.isFunction(n)?this.each(function(t){var r=i(this);r.text(n.call(this,t,r.text()))}):typeof n!="object"&&n!==t?this.empty().append((this[0]&&this[0].ownerDocument||r).createTextNode(n)):i.text(this)},wrapAll:function(n){if(i.isFunction(n))return this.each(function(t){i(this).wrapAll(n.call(this,t))});if(this[0]){var t=i(n,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]);t.map(function(){for(var n=this;n.firstChild&&n.firstChild.nodeType===1;)n=n.firstChild;return n}).append(this)}return this},wrapInner:function(n){return i.isFunction(n)?this.each(function(t){i(this).wrapInner(n.call(this,t))}):this.each(function(){var t=i(this),r=t.contents();r.length?r.wrapAll(n):t.append(n)})},wrap:function(n){var t=i.isFunction(n);return this.each(function(r){i(this).wrapAll(t?n.call(this,r):n)})},unwrap:function(){return this.parent().each(function(){i.nodeName(this,"body")||i(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(n){this.nodeType===1&&this.appendChild(n)})},prepend:function(){return this.domManip(arguments,!0,function(n){this.nodeType===1&&this.insertBefore(n,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(n){this.parentNode.insertBefore(n,this)});if(arguments.length){var n=i.clean(arguments);return n.push.apply(n,this.toArray()),this.pushStack(n,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(n){this.parentNode.insertBefore(n,this.nextSibling)});if(arguments.length){var n=this.pushStack(this,"after",arguments);return n.push.apply(n,i.clean(arguments)),n}},remove:function(n,t){for(var u=0,r;(r=this[u])!=null;u++)(!n||i.filter(n,[r]).length)&&(t||r.nodeType!==1||(i.cleanData(r.getElementsByTagName("*")),i.cleanData([r])),r.parentNode&&r.parentNode.removeChild(r));return this},empty:function(){for(var t=0,n;(n=this[t])!=null;t++)for(n.nodeType===1&&i.cleanData(n.getElementsByTagName("*"));n.firstChild;)n.removeChild(n.firstChild);return this},clone:function(n,t){return n=n==null?!1:n,t=t==null?n:t,this.map(function(){return i.clone(this,n,t)})},html:function(n){if(n===t)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(yu,""):null;if(typeof n!="string"||bu.test(n)||!i.support.leadingWhitespace&&ut.test(n)||u[(hi.exec(n)||["",""])[1].toLowerCase()])i.isFunction(n)?this.each(function(t){var r=i(this);r.html(n.call(this,t,r.html()))}):this.empty().append(n);else{n=n.replace(si,"<$1><\/$2>");try{for(var r=0,f=this.length;r<f;r++)this[r].nodeType===1&&(i.cleanData(this[r].getElementsByTagName("*")),this[r].innerHTML=n)}catch(e){this.empty().append(n)}}return this},replaceWith:function(n){return this[0]&&this[0].parentNode?i.isFunction(n)?this.each(function(t){var r=i(this),u=r.html();r.replaceWith(n.call(this,t,u))}):(typeof n!="string"&&(n=i(n).detach()),this.each(function(){var t=this.nextSibling,r=this.parentNode;i(this).remove();t?i(t).before(n):i(r).append(n)})):this.length?this.pushStack(i(i.isFunction(n)?n():n),"replaceWith",n):this},detach:function(n){return this.remove(n,!0)},domManip:function(n,r,u){var c,h,f,o,e=n[0],l=[];if(!i.support.checkClone&&arguments.length===3&&typeof e=="string"&&li.test(e))return this.each(function(){i(this).domManip(n,r,u,!0)});if(i.isFunction(e))return this.each(function(f){var o=i(this);n[0]=e.call(this,f,r?o.html():t);o.domManip(n,r,u)});if(this[0]){if(o=e&&e.parentNode,c=i.support.parentNode&&o&&o.nodeType===11&&o.childNodes.length===this.length?{fragment:o}:i.buildFragment(n,this,l),f=c.fragment,h=f.childNodes.length===1?f=f.firstChild:f.firstChild,h){r=r&&i.nodeName(h,"tr");for(var s=0,a=this.length,v=a-1;s<a;s++)u.call(r?nf(this[s],h):this[s],c.cacheable||a>1&&s<v?i.clone(f,!0,!0):f)}l.length&&i.each(l,rf)}return this}});i.buildFragment=function(n,t,u){var e,h,s,o,f=n[0];return t&&t[0]&&(o=t[0].ownerDocument||t[0]),o.createDocumentFragment||(o=r),n.length===1&&typeof f=="string"&&f.length<512&&o===r&&f.charAt(0)==="<"&&!ku.test(f)&&(i.support.checkClone||!li.test(f))&&(i.support.html5Clone||!ci.test(f))&&(h=!0,s=i.fragments[f],s&&s!==1&&(e=s)),e||(e=o.createDocumentFragment(),i.clean(n,o,e,u)),h&&(i.fragments[f]=s?e:1),{fragment:e,cacheable:h}};i.fragments={};i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,t){i.fn[n]=function(r){var e=[],u=i(r),o=this.length===1&&this[0].parentNode,f,h,s;if(o&&o.nodeType===11&&o.childNodes.length===1&&u.length===1)return u[t](this[0]),this;for(f=0,h=u.length;f<h;f++)s=(f>0?this.clone(!0):this).get(),i(u[f])[t](s),e=e.concat(s);return this.pushStack(e,n,u.selector)}});i.extend({clone:function(n,t,r){var f,e,u,o=i.support.html5Clone||!ci.test("<"+n.nodeName)?n.cloneNode(!0):tf(n);if((!i.support.noCloneEvent||!i.support.noCloneChecked)&&(n.nodeType===1||n.nodeType===11)&&!i.isXMLDoc(n))for(yi(n,o),f=k(n),e=k(o),u=0;f[u];++u)e[u]&&yi(f[u],e[u]);if(t&&(vi(n,o),r))for(f=k(n),e=k(o),u=0;f[u];++u)vi(f[u],e[u]);return f=e=null,o},clean:function(n,t,f,e){var p,s,c,h,o,y,a,b,k;for(t=t||r,typeof t.createElement=="undefined"&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||r),s=[],h=0;(o=n[h])!=null;h++)if(typeof o=="number"&&(o+=""),o){if(typeof o=="string")if(wu.test(o)){o=o.replace(si,"<$1><\/$2>");var w=(hi.exec(o)||["",""])[1].toLowerCase(),v=u[w]||u._default,d=v[0],l=t.createElement("div");for(t===r?ai.appendChild(l):ei(t).appendChild(l),l.innerHTML=v[1]+o+v[2];d--;)l=l.lastChild;if(!i.support.tbody)for(y=pu.test(o),a=w==="table"&&!y?l.firstChild&&l.firstChild.childNodes:v[1]==="<table>"&&!y?l.childNodes:[],c=a.length-1;c>=0;--c)i.nodeName(a[c],"tbody")&&!a[c].childNodes.length&&a[c].parentNode.removeChild(a[c]);!i.support.leadingWhitespace&&ut.test(o)&&l.insertBefore(t.createTextNode(ut.exec(o)[0]),l.firstChild);o=l.childNodes}else o=t.createTextNode(o);if(!i.support.appendChecked)if(o[0]&&typeof(b=o.length)=="number")for(c=0;c<b;c++)wi(o[c]);else wi(o);o.nodeType?s.push(o):s=i.merge(s,o)}if(f)for(p=function(n){return!n.type||du.test(n.type)},h=0;s[h];h++)e&&i.nodeName(s[h],"script")&&(!s[h].type||s[h].type.toLowerCase()==="text/javascript")?e.push(s[h].parentNode?s[h].parentNode.removeChild(s[h]):s[h]):(s[h].nodeType===1&&(k=i.grep(s[h].getElementsByTagName("script"),p),s.splice.apply(s,[h+1,0].concat(k))),f.appendChild(s[h]));return s},cleanData:function(n){for(var f,r,u,e=i.cache,s=i.event.special,h=i.support.deleteExpando,o=0,t;(t=n[o])!=null;o++)if((!t.nodeName||!i.noData[t.nodeName.toLowerCase()])&&(u=t[i.expando],u)){if(r=e[u],r&&r.events){for(f in r.events)s[f]?i.event.remove(t,f):i.removeEvent(t,f,r.handle);r.handle&&(r.handle.elem=null)}h?delete t[i.expando]:t.removeAttribute&&t.removeAttribute(i.expando);delete e[u]}}});var ft=/alpha\([^)]*\)/i,uf=/opacity=([^)]*)/,ff=/([A-Z]|^ms)/g,bi=/^-?\d+(?:px)?$/i,ef=/^-?\d/,of=/^([\-+])=([\-+.\de]+)/,sf={position:"absolute",visibility:"hidden",display:"block"},hf=["Left","Right"],cf=["Top","Bottom"],c,ki,di;i.fn.css=function(n,r){return arguments.length===2&&r===t?this:i.access(this,n,r,!0,function(n,r,u){return u!==t?i.style(n,r,u):i.css(n,r)})};i.extend({cssHooks:{opacity:{get:function(n,t){if(t){var i=c(n,"opacity","opacity");return i===""?"1":i}return n.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:i.support.cssFloat?"cssFloat":"styleFloat"},style:function(n,r,u,f){if(n&&n.nodeType!==3&&n.nodeType!==8&&n.style){var o,s,h=i.camelCase(r),c=n.style,e=i.cssHooks[h];if(r=i.cssProps[h]||h,u!==t){if(s=typeof u,s==="string"&&(o=of.exec(u))&&(u=+(o[1]+1)*+o[2]+parseFloat(i.css(n,r)),s="number"),u==null||s==="number"&&isNaN(u))return;if(s!=="number"||i.cssNumber[h]||(u+="px"),!e||!("set"in e)||(u=e.set(n,u))!==t)try{c[r]=u}catch(l){}}else return e&&"get"in e&&(o=e.get(n,!1,f))!==t?o:c[r]}},css:function(n,r,u){var e,f;return(r=i.camelCase(r),f=i.cssHooks[r],r=i.cssProps[r]||r,r==="cssFloat"&&(r="float"),f&&"get"in f&&(e=f.get(n,!0,u))!==t)?e:c?c(n,r):void 0},swap:function(n,t,i){var u={};for(var r in t)u[r]=n.style[r],n.style[r]=t[r];i.call(n);for(r in t)n.style[r]=u[r]}});i.curCSS=i.css;i.each(["height","width"],function(n,t){i.cssHooks[t]={get:function(n,r,u){var f;if(r)return n.offsetWidth!==0?gi(n,t,u):(i.swap(n,sf,function(){f=gi(n,t,u)}),f)},set:function(n,t){if(bi.test(t)){if(t=parseFloat(t),t>=0)return t+"px"}else return t}}});i.support.opacity||(i.cssHooks.opacity={get:function(n,t){return uf.test((t&&n.currentStyle?n.currentStyle.filter:n.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(n,t){var r=n.style,u=n.currentStyle,e=i.isNumeric(t)?"alpha(opacity="+t*100+")":"",f=u&&u.filter||r.filter||"";(r.zoom=1,t>=1&&i.trim(f.replace(ft,""))===""&&(r.removeAttribute("filter"),u&&!u.filter))||(r.filter=ft.test(f)?f.replace(ft,e):f+" "+e)}});i(function(){i.support.reliableMarginRight||(i.cssHooks.marginRight={get:function(n,t){var r;return i.swap(n,{display:"inline-block"},function(){r=t?c(n,"margin-right","marginRight"):n.style.marginRight}),r}})});r.defaultView&&r.defaultView.getComputedStyle&&(ki=function(n,t){var r,u,f;return t=t.replace(ff,"-$1").toLowerCase(),(u=n.ownerDocument.defaultView)&&(f=u.getComputedStyle(n,null))&&(r=f.getPropertyValue(t),r!==""||i.contains(n.ownerDocument.documentElement,n)||(r=i.style(n,t))),r});r.documentElement.currentStyle&&(di=function(n,t){var f,u,e,i=n.currentStyle&&n.currentStyle[t],r=n.style;return i===null&&r&&(e=r[t])&&(i=e),!bi.test(i)&&ef.test(i)&&(f=r.left,u=n.runtimeStyle&&n.runtimeStyle.left,u&&(n.runtimeStyle.left=n.currentStyle.left),r.left=t==="fontSize"?"1em":i||0,i=r.pixelLeft+"px",r.left=f,u&&(n.runtimeStyle.left=u)),i===""?"auto":i});c=ki||di;i.expr&&i.expr.filters&&(i.expr.filters.hidden=function(n){var t=n.offsetWidth,r=n.offsetHeight;return t===0&&r===0||!i.support.reliableHiddenOffsets&&(n.style&&n.style.display||i.css(n,"display"))==="none"},i.expr.filters.visible=function(n){return!i.expr.filters.hidden(n)});var lf=/%20/g,af=/\[\]$/,nr=/\r?\n/g,vf=/#.*$/,yf=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,pf=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,wf=/^(?:GET|HEAD)$/,bf=/^\/\//,tr=/\?/,kf=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,df=/^(?:select|textarea)/i,ir=/\s+/,gf=/([?&])_=[^&]*/,rr=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,ur=i.fn.load,et={},fr={},o,s,er=["*/"]+["*"];try{o=br.href}catch(ee){o=r.createElement("a");o.href="";o=o.href}s=rr.exec(o.toLowerCase())||[];i.fn.extend({load:function(n,r,u){var f,e,o,s;return typeof n!="string"&&ur?ur.apply(this,arguments):this.length?(f=n.indexOf(" "),f>=0&&(e=n.slice(f,n.length),n=n.slice(0,f)),o="GET",r&&(i.isFunction(r)?(u=r,r=t):typeof r=="object"&&(r=i.param(r,i.ajaxSettings.traditional),o="POST")),s=this,i.ajax({url:n,type:o,dataType:"html",data:r,complete:function(n,t,r){r=n.responseText;n.isResolved()&&(n.done(function(n){r=n}),s.html(e?i("<div>").append(r.replace(kf,"")).find(e):r));u&&s.each(u,[r,t,n])}}),this):this},serialize:function(){return i.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?i.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||df.test(this.nodeName)||pf.test(this.type))}).map(function(n,t){var r=i(this).val();return r==null?null:i.isArray(r)?i.map(r,function(n){return{name:t.name,value:n.replace(nr,"\r\n")}}):{name:t.name,value:r.replace(nr,"\r\n")}}).get()}});i.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(n,t){i.fn[t]=function(n){return this.on(t,n)}});i.each(["get","post"],function(n,r){i[r]=function(n,u,f,e){return i.isFunction(u)&&(e=e||f,f=u,u=t),i.ajax({type:r,url:n,data:u,success:f,dataType:e})}});i.extend({getScript:function(n,r){return i.get(n,t,r,"script")},getJSON:function(n,t,r){return i.get(n,t,r,"json")},ajaxSetup:function(n,t){return t?sr(n,i.ajaxSettings):(t=n,n=i.ajaxSettings),sr(n,t),n},ajaxSettings:{url:o,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(s[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":er},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":n.String,"text html":!0,"text json":i.parseJSON,"text xml":i.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:or(et),ajaxTransport:or(fr),ajax:function(n,r){function w(n,r,s,l){if(e!==2){e=2;nt&&clearTimeout(nt);c=t;g=l||"";f.readyState=n>0?4:0;var p,d,w,a=r,ut=s?ne(u,f,s):t,tt,it;if(n>=200&&n<300||n===304)if(u.ifModified&&((tt=f.getResponseHeader("Last-Modified"))&&(i.lastModified[o]=tt),(it=f.getResponseHeader("Etag"))&&(i.etag[o]=it)),n===304)a="notmodified",p=!0;else try{d=te(u,ut);a="success";p=!0}catch(ft){a="parsererror";w=ft}else w=a,(!a||n)&&(a="error",n<0&&(n=0));f.status=n;f.statusText=""+(r||a);p?k.resolveWith(h,[d,a,f]):k.rejectWith(h,[f,a,w]);f.statusCode(y);y=t;v&&b.trigger("ajax"+(p?"Success":"Error"),[f,u,p?d:w]);rt.fireWith(h,[f,a]);v&&(b.trigger("ajaxComplete",[f,u]),--i.active||i.event.trigger("ajaxStop"))}}var tt,it;typeof n=="object"&&(r=n,n=t);r=r||{};var u=i.ajaxSetup({},r),h=u.context||u,b=h!==u&&(h.nodeType||h instanceof i)?i(h):i.event,k=i.Deferred(),rt=i.Callbacks("once memory"),y=u.statusCode||{},o,ut={},ft={},g,p,c,nt,l,e=0,v,a,f={readyState:0,setRequestHeader:function(n,t){if(!e){var i=n.toLowerCase();n=ft[i]=ft[i]||n;ut[n]=t}return this},getAllResponseHeaders:function(){return e===2?g:null},getResponseHeader:function(n){var i;if(e===2){if(!p)for(p={};i=yf.exec(g);)p[i[1].toLowerCase()]=i[2];i=p[n.toLowerCase()]}return i===t?null:i},overrideMimeType:function(n){return e||(u.mimeType=n),this},abort:function(n){return n=n||"abort",c&&c.abort(n),w(0,n),this}};if(k.promise(f),f.success=f.done,f.error=f.fail,f.complete=rt.add,f.statusCode=function(n){if(n){var t;if(e<2)for(t in n)y[t]=[y[t],n[t]];else t=n[f.status],f.then(t,t)}return this},u.url=((n||u.url)+"").replace(vf,"").replace(bf,s[1]+"//"),u.dataTypes=i.trim(u.dataType||"*").toLowerCase().split(ir),u.crossDomain==null&&(l=rr.exec(u.url.toLowerCase()),u.crossDomain=!!(l&&(l[1]!=s[1]||l[2]!=s[2]||(l[3]||(l[1]==="http:"?80:443))!=(s[3]||(s[1]==="http:"?80:443))))),u.data&&u.processData&&typeof u.data!="string"&&(u.data=i.param(u.data,u.traditional)),d(et,u,r,f),e===2)return!1;v=u.global;u.type=u.type.toUpperCase();u.hasContent=!wf.test(u.type);v&&i.active++==0&&i.event.trigger("ajaxStart");u.hasContent||(u.data&&(u.url+=(tr.test(u.url)?"&":"?")+u.data,delete u.data),o=u.url,u.cache===!1&&(tt=i.now(),it=u.url.replace(gf,"$1_="+tt),u.url=it+(it===u.url?(tr.test(u.url)?"&":"?")+"_="+tt:"")));(u.data&&u.hasContent&&u.contentType!==!1||r.contentType)&&f.setRequestHeader("Content-Type",u.contentType);u.ifModified&&(o=o||u.url,i.lastModified[o]&&f.setRequestHeader("If-Modified-Since",i.lastModified[o]),i.etag[o]&&f.setRequestHeader("If-None-Match",i.etag[o]));f.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+(u.dataTypes[0]!=="*"?", "+er+"; q=0.01":""):u.accepts["*"]);for(a in u.headers)f.setRequestHeader(a,u.headers[a]);if(u.beforeSend&&(u.beforeSend.call(h,f,u)===!1||e===2))return f.abort(),!1;for(a in{success:1,error:1,complete:1})f[a](u[a]);if(c=d(fr,u,r,f),c){f.readyState=1;v&&b.trigger("ajaxSend",[f,u]);u.async&&u.timeout>0&&(nt=setTimeout(function(){f.abort("timeout")},u.timeout));try{e=1;c.send(ut,w)}catch(ot){if(e<2)w(-1,ot);else throw ot;}}else w(-1,"No Transport");return f},param:function(n,r){var u=[],e=function(n,t){t=i.isFunction(t)?t():t;u[u.length]=encodeURIComponent(n)+"="+encodeURIComponent(t)},f;if(r===t&&(r=i.ajaxSettings.traditional),i.isArray(n)||n.jquery&&!i.isPlainObject(n))i.each(n,function(){e(this.name,this.value)});else for(f in n)ot(f,n[f],r,e);return u.join("&").replace(lf,"+")}});i.extend({active:0,lastModified:{},etag:{}});hr=i.now();y=/(\=)\?(&|$)|\?\?/i;i.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return i.expando+"_"+hr++}});i.ajaxPrefilter("json jsonp",function(t,r,u){var h=t.contentType==="application/x-www-form-urlencoded"&&typeof t.data=="string";if(t.dataTypes[0]==="jsonp"||t.jsonp!==!1&&(y.test(t.url)||h&&y.test(t.data))){var o,f=t.jsonpCallback=i.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,c=n[f],e=t.url,s=t.data,l="$1"+f+"$2";return t.jsonp!==!1&&(e=e.replace(y,l),t.url===e&&(h&&(s=s.replace(y,l)),t.data===s&&(e+=(/\?/.test(e)?"&":"?")+t.jsonp+"="+f))),t.url=e,t.data=s,n[f]=function(n){o=[n]},u.always(function(){n[f]=c;o&&i.isFunction(c)&&n[f](o[0])}),t.converters["script json"]=function(){return o||i.error(f+" was not called"),o[0]},t.dataTypes[0]="json","script"}});i.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(n){return i.globalEval(n),n}}});i.ajaxPrefilter("script",function(n){n.cache===t&&(n.cache=!1);n.crossDomain&&(n.type="GET",n.global=!1)});i.ajaxTransport("script",function(n){if(n.crossDomain){var i,u=r.head||r.getElementsByTagName("head")[0]||r.documentElement;return{send:function(f,e){i=r.createElement("script");i.async="async";n.scriptCharset&&(i.charset=n.scriptCharset);i.src=n.url;i.onload=i.onreadystatechange=function(n,r){(r||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,u&&i.parentNode&&u.removeChild(i),i=t,r||e(200,"success"))};u.insertBefore(i,u.firstChild)},abort:function(){if(i)i.onload(0,1)}}}});g=n.ActiveXObject?function(){for(var n in l)l[n](0,1)}:!1;cr=0;i.ajaxSettings.xhr=n.ActiveXObject?function(){return!this.isLocal&&lr()||ie()}:lr,function(n){i.extend(i.support,{ajax:!!n,cors:!!n&&"withCredentials"in n})}(i.ajaxSettings.xhr());i.support.ajax&&i.ajaxTransport(function(r){if(!r.crossDomain||i.support.cors){var u;return{send:function(f,e){var o=r.xhr(),h,s;if(r.username?o.open(r.type,r.url,r.async,r.username,r.password):o.open(r.type,r.url,r.async),r.xhrFields)for(s in r.xhrFields)o[s]=r.xhrFields[s];r.mimeType&&o.overrideMimeType&&o.overrideMimeType(r.mimeType);r.crossDomain||f["X-Requested-With"]||(f["X-Requested-With"]="XMLHttpRequest");try{for(s in f)o.setRequestHeader(s,f[s])}catch(c){}o.send(r.hasContent&&r.data||null);u=function(n,f){var s,v,y,c,a;try{if(u&&(f||o.readyState===4))if(u=t,h&&(o.onreadystatechange=i.noop,g&&delete l[h]),f)o.readyState!==4&&o.abort();else{s=o.status;y=o.getAllResponseHeaders();c={};a=o.responseXML;a&&a.documentElement&&(c.xml=a);c.text=o.responseText;try{v=o.statusText}catch(w){v=""}s||!r.isLocal||r.crossDomain?s===1223&&(s=204):s=c.text?200:404}}catch(p){f||e(-1,p)}c&&e(s,v,c,y)};r.async&&o.readyState!==4?(h=++cr,g&&(l||(l={},i(n).unload(g)),l[h]=u),o.onreadystatechange=u):u()},abort:function(){u&&u(0,1)}}}});var st={},f,a,re=/^(?:toggle|show|hide)$/,ue=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,nt,ar=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],tt;i.fn.extend({show:function(n,t,r){var u,e,f,o;if(n||n===0)return this.animate(v("show",3),n,t,r);for(f=0,o=this.length;f<o;f++)u=this[f],u.style&&(e=u.style.display,i._data(u,"olddisplay")||e!=="none"||(e=u.style.display=""),e===""&&i.css(u,"display")==="none"&&i._data(u,"olddisplay",yr(u.nodeName)));for(f=0;f<o;f++)u=this[f],u.style&&(e=u.style.display,(e===""||e==="none")&&(u.style.display=i._data(u,"olddisplay")||""));return this},hide:function(n,t,r){if(n||n===0)return this.animate(v("hide",3),n,t,r);for(var f,e,u=0,o=this.length;u<o;u++)f=this[u],f.style&&(e=i.css(f,"display"),e==="none"||i._data(f,"olddisplay")||i._data(f,"olddisplay",e));for(u=0;u<o;u++)this[u].style&&(this[u].style.display="none");return this},_toggle:i.fn.toggle,toggle:function(n,t,r){var u=typeof n=="boolean";return i.isFunction(n)&&i.isFunction(t)?this._toggle.apply(this,arguments):n==null||u?this.each(function(){var t=u?n:i(this).is(":hidden");i(this)[t?"show":"hide"]()}):this.animate(v("toggle",3),n,t,r),this},fadeTo:function(n,t,i,r){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:t},n,i,r)},animate:function(n,t,r,u){function e(){f.queue===!1&&i._mark(this);var u=i.extend({},f),y=this.nodeType===1,v=y&&i(this).is(":hidden"),e,t,r,o,h,s,c,l,a;u.animatedProperties={};for(r in n){if(e=i.camelCase(r),r!==e&&(n[e]=n[r],delete n[r]),t=n[e],i.isArray(t)?(u.animatedProperties[e]=t[1],t=n[e]=t[0]):u.animatedProperties[e]=u.specialEasing&&u.specialEasing[e]||u.easing||"swing",t==="hide"&&v||t==="show"&&!v)return u.complete.call(this);y&&(e==="height"||e==="width")&&(u.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],i.css(this,"display")==="inline"&&i.css(this,"float")==="none"&&(i.support.inlineBlockNeedsLayout&&yr(this.nodeName)!=="inline"?this.style.zoom=1:this.style.display="inline-block"))}u.overflow!=null&&(this.style.overflow="hidden");for(r in n)o=new i.fx(this,u,r),t=n[r],re.test(t)?(a=i._data(this,"toggle"+r)||(t==="toggle"?v?"show":"hide":0),a?(i._data(this,"toggle"+r,a==="show"?"hide":"show"),o[a]()):o[t]()):(h=ue.exec(t),s=o.cur(),h?(c=parseFloat(h[2]),l=h[3]||(i.cssNumber[r]?"":"px"),l!=="px"&&(i.style(this,r,(c||1)+l),s=(c||1)/o.cur()*s,i.style(this,r,s+l)),h[1]&&(c=(h[1]==="-="?-1:1)*c+s),o.custom(s,c,l)):o.custom(s,t,""));return!0}var f=i.speed(t,r,u);return i.isEmptyObject(n)?this.each(f.complete,[!1]):(n=i.extend({},n),f.queue===!1?this.each(e):this.queue(f.queue,e))},stop:function(n,r,u){return typeof n!="string"&&(u=r,r=n,n=t),r&&n!==!1&&this.queue(n||"fx",[]),this.each(function(){function o(n,t,r){var f=t[r];i.removeData(n,r,!0);f.stop(u)}var t,e=!1,f=i.timers,r=i._data(this);if(u||i._unmark(!0,this),n==null)for(t in r)r[t]&&r[t].stop&&t.indexOf(".run")===t.length-4&&o(this,r,t);else r[t=n+".run"]&&r[t].stop&&o(this,r,t);for(t=f.length;t--;)f[t].elem===this&&(n==null||f[t].queue===n)&&(u?f[t](!0):f[t].saveState(),e=!0,f.splice(t,1));u&&e||i.dequeue(this,n)})}});i.each({slideDown:v("show",1),slideUp:v("hide",1),slideToggle:v("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,t){i.fn[n]=function(n,i,r){return this.animate(t,n,i,r)}});i.extend({speed:function(n,t,r){var u=n&&typeof n=="object"?i.extend({},n):{complete:r||!r&&t||i.isFunction(n)&&n,duration:n,easing:r&&t||t&&!i.isFunction(t)&&t};return u.duration=i.fx.off?0:typeof u.duration=="number"?u.duration:u.duration in i.fx.speeds?i.fx.speeds[u.duration]:i.fx.speeds._default,(u.queue==null||u.queue===!0)&&(u.queue="fx"),u.old=u.complete,u.complete=function(n){i.isFunction(u.old)&&u.old.call(this);u.queue?i.dequeue(this,u.queue):n!==!1&&i._unmark(this)},u},easing:{linear:function(n,t,i,r){return i+r*n},swing:function(n,t,i,r){return(-Math.cos(n*Math.PI)/2+.5)*r+i}},timers:[],fx:function(n,t,i){this.options=t;this.elem=n;this.prop=i;t.orig=t.orig||{}}});i.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(i.fx.step[this.prop]||i.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var t,n=i.css(this.elem,this.prop);return isNaN(t=parseFloat(n))?!n||n==="auto"?0:n:t},custom:function(n,r,u){function e(n){return f.step(n)}var f=this,o=i.fx;this.startTime=tt||vr();this.end=r;this.now=this.start=n;this.pos=this.state=0;this.unit=u||this.unit||(i.cssNumber[this.prop]?"":"px");e.queue=this.options.queue;e.elem=this.elem;e.saveState=function(){f.options.hide&&i._data(f.elem,"fxshow"+f.prop)===t&&i._data(f.elem,"fxshow"+f.prop,f.start)};e()&&i.timers.push(e)&&!nt&&(nt=setInterval(o.tick,o.interval))},show:function(){var n=i._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=n||i.style(this.elem,this.prop);this.options.show=!0;n!==t?this.custom(this.cur(),n):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());i(this.elem).show()},hide:function(){this.options.orig[this.prop]=i._data(this.elem,"fxshow"+this.prop)||i.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(n){var r,f,e,o=tt||vr(),s=!0,u=this.elem,t=this.options;if(n||o>=t.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();t.animatedProperties[this.prop]=!0;for(r in t.animatedProperties)t.animatedProperties[r]!==!0&&(s=!1);if(s){if(t.overflow==null||i.support.shrinkWrapBlocks||i.each(["","X","Y"],function(n,i){u.style["overflow"+i]=t.overflow[n]}),t.hide&&i(u).hide(),t.hide||t.show)for(r in t.animatedProperties)i.style(u,r,t.orig[r]),i.removeData(u,"fxshow"+r,!0),i.removeData(u,"toggle"+r,!0);e=t.complete;e&&(t.complete=!1,e.call(u))}return!1}return t.duration==Infinity?this.now=o:(f=o-this.startTime,this.state=f/t.duration,this.pos=i.easing[t.animatedProperties[this.prop]](this.state,f,0,1,t.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}};i.extend(i.fx,{tick:function(){for(var r,n=i.timers,t=0;t<n.length;t++)r=n[t],r()||n[t]!==r||n.splice(t--,1);n.length||i.fx.stop()},interval:13,stop:function(){clearInterval(nt);nt=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(n){i.style(n.elem,"opacity",n.now)},_default:function(n){n.elem.style&&n.elem.style[n.prop]!=null?n.elem.style[n.prop]=n.now+n.unit:n.elem[n.prop]=n.now}}});i.each(["width","height"],function(n,t){i.fx.step[t]=function(n){i.style(n.elem,t,Math.max(0,n.now)+n.unit)}});i.expr&&i.expr.filters&&(i.expr.filters.animated=function(n){return i.grep(i.timers,function(t){return n===t.elem}).length});pr=/^t(?:able|d|h)$/i;ht=/^(?:body|html)$/i;i.fn.offset="getBoundingClientRect"in r.documentElement?function(n){var t=this[0],r,f,u;if(n)return this.each(function(t){i.offset.setOffset(this,n,t)});if(!t||!t.ownerDocument)return null;if(t===t.ownerDocument.body)return i.offset.bodyOffset(t);try{r=t.getBoundingClientRect()}catch(y){}if(f=t.ownerDocument,u=f.documentElement,!r||!i.contains(u,t))return r?{top:r.top,left:r.left}:{top:0,left:0};var e=f.body,o=ct(f),s=u.clientTop||e.clientTop||0,h=u.clientLeft||e.clientLeft||0,c=o.pageYOffset||i.support.boxModel&&u.scrollTop||e.scrollTop,l=o.pageXOffset||i.support.boxModel&&u.scrollLeft||e.scrollLeft,a=r.top+c-s,v=r.left+l-h;return{top:a,left:v}}:function(n){var t=this[0];if(n)return this.each(function(t){i.offset.setOffset(this,n,t)});if(!t||!t.ownerDocument)return null;if(t===t.ownerDocument.body)return i.offset.bodyOffset(t);for(var r,h=t.offsetParent,a=t,c=t.ownerDocument,l=c.documentElement,e=c.body,s=c.defaultView,o=s?s.getComputedStyle(t,null):t.currentStyle,u=t.offsetTop,f=t.offsetLeft;(t=t.parentNode)&&t!==e&&t!==l;){if(i.support.fixedPosition&&o.position==="fixed")break;r=s?s.getComputedStyle(t,null):t.currentStyle;u-=t.scrollTop;f-=t.scrollLeft;t===h&&(u+=t.offsetTop,f+=t.offsetLeft,!i.support.doesNotAddBorder||i.support.doesAddBorderForTableAndCells&&pr.test(t.nodeName)||(u+=parseFloat(r.borderTopWidth)||0,f+=parseFloat(r.borderLeftWidth)||0),a=h,h=t.offsetParent);i.support.subtractsBorderForOverflowNotVisible&&r.overflow!=="visible"&&(u+=parseFloat(r.borderTopWidth)||0,f+=parseFloat(r.borderLeftWidth)||0);o=r}return(o.position==="relative"||o.position==="static")&&(u+=e.offsetTop,f+=e.offsetLeft),i.support.fixedPosition&&o.position==="fixed"&&(u+=Math.max(l.scrollTop,e.scrollTop),f+=Math.max(l.scrollLeft,e.scrollLeft)),{top:u,left:f}};i.offset={bodyOffset:function(n){var t=n.offsetTop,r=n.offsetLeft;return i.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(i.css(n,"marginTop"))||0,r+=parseFloat(i.css(n,"marginLeft"))||0),{top:t,left:r}},setOffset:function(n,t,r){var f=i.css(n,"position");f==="static"&&(n.style.position="relative");var e=i(n),o=e.offset(),l=i.css(n,"top"),a=i.css(n,"left"),v=(f==="absolute"||f==="fixed")&&i.inArray("auto",[l,a])>-1,u={},s={},h,c;v?(s=e.position(),h=s.top,c=s.left):(h=parseFloat(l)||0,c=parseFloat(a)||0);i.isFunction(t)&&(t=t.call(n,r,o));t.top!=null&&(u.top=t.top-o.top+h);t.left!=null&&(u.left=t.left-o.left+c);"using"in t?t.using.call(n,u):e.css(u)}};i.fn.extend({position:function(){if(!this[0])return null;var u=this[0],n=this.offsetParent(),t=this.offset(),r=ht.test(n[0].nodeName)?{top:0,left:0}:n.offset();return t.top-=parseFloat(i.css(u,"marginTop"))||0,t.left-=parseFloat(i.css(u,"marginLeft"))||0,r.top+=parseFloat(i.css(n[0],"borderTopWidth"))||0,r.left+=parseFloat(i.css(n[0],"borderLeftWidth"))||0,{top:t.top-r.top,left:t.left-r.left}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent||r.body;n&&!ht.test(n.nodeName)&&i.css(n,"position")==="static";)n=n.offsetParent;return n})}});i.each(["Left","Top"],function(n,r){var u="scroll"+r;i.fn[u]=function(r){var e,f;return r===t?(e=this[0],!e)?null:(f=ct(e),f?"pageXOffset"in f?f[n?"pageYOffset":"pageXOffset"]:i.support.boxModel&&f.document.documentElement[u]||f.document.body[u]:e[u]):this.each(function(){f=ct(this);f?f.scrollTo(n?i(f).scrollLeft():r,n?r:i(f).scrollTop()):this[u]=r})}});i.each(["Height","Width"],function(n,r){var u=r.toLowerCase();i.fn["inner"+r]=function(){var n=this[0];return n?n.style?parseFloat(i.css(n,u,"padding")):this[u]():null};i.fn["outer"+r]=function(n){var t=this[0];return t?t.style?parseFloat(i.css(t,u,n?"margin":"border")):this[u]():null};i.fn[u]=function(n){var f=this[0],e,o,s,h;return f?i.isFunction(n)?this.each(function(t){var r=i(this);r[u](n.call(this,t,r[u]()))}):i.isWindow(f)?(e=f.document.documentElement["client"+r],o=f.document.body,f.document.compatMode==="CSS1Compat"&&e||o&&o["client"+r]||e):f.nodeType===9?Math.max(f.documentElement["client"+r],f.body["scroll"+r],f.documentElement["scroll"+r],f.body["offset"+r],f.documentElement["offset"+r]):n===t?(s=i.css(f,u),h=parseFloat(s),i.isNumeric(h)?h:s):this.css(u,typeof n=="string"?n:n+"px"):n==null?null:this}});n.jQuery=n.$=i;typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return i})})(window);this.JSON||(this.JSON={}),function(){function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var c,l,s,a,v=n,h,e=f[i];e&&typeof e=="object"&&typeof e.toJSON=="function"&&(e=e.toJSON(i));typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,h=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,c=0;c<a;c+=1)h[c]=u(c,e)||"null";return s=h.length===0?"[]":n?"[\n"+n+h.join(",\n"+n)+"\n"+v+"]":"["+h.join(",")+"]",n=v,s}if(t&&typeof t=="object")for(a=t.length,c=0;c<a;c+=1)l=t[c],typeof l=="string"&&(s=u(l,e),s&&h.push(o(l)+(n?": ":":")+s));else for(l in e)Object.hasOwnProperty.call(e,l)&&(s=u(l,e),s&&h.push(o(l)+(n?": ":":")+s));return s=h.length===0?"{}":n?"{\n"+n+h.join(",\n"+n)+"\n"+v+"}":"{"+h.join(",")+"}",n=v,s}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return u("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),f.lastIndex=0,f.test(n)&&(n=n.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}();CrmRestKit=function(n,t,i){"use strict";function s(){if(typeof GetGlobalContext!="undefined")return GetGlobalContext();if(typeof Xrm!="undefined")return Xrm.Page.context;throw new Error("Context is not available.");}function h(){var t=null,u=n.location.protocol+"//"+n.location.host,r=s();return Xrm.Page.context.getClientUrl!==i?t=Xrm.Page.context.getClientUrl():r.isOutlookClient()&&!r.isOutlookOnline()?t=u:(t=r.getClientUrl(),t=t.replace(/^(http|https):\/\/([_a-zA-Z0-9\-\.]+)(:([0-9]{1,5}))?/,u),t=t.replace(/\/$/,"")),t}function u(){return h()+o}function c(n,t){var r=null;return n!==i&&n!==null&&(r={__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:n},t!==i&&t!==null&&(r.LogicalName=t)),r}function l(n){return{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:n}}function a(n){return{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.Money"},Value:n}}function v(n){return new Date(parseInt(n.replace("/Date(","").replace(")/",""),10))}function r(n,t){var r={type:"GET",async:!0,contentType:"application/json; charset=utf-8",datatype:"json",beforeSend:function(n){n.setRequestHeader("Accept","application/json")}};return n=$.extend(r,n),n.async=t===i?!0:t,$.ajax(n)}function y(t,f,e,o,s,h){var l=h===i?!0:h,c=u(),a={url:c+"/"+f+"Set(guid'"+t+"')/$links/"+s,type:"POST",data:n.JSON.stringify({uri:c+"/"+o+"Set(guid'"+e+"')"})};return r(a,l)}function p(n,t,f,e,o){var s=o===i?!0:o,h=u(),c={url:h+"/"+t+"Set(guid'"+n+"')/$links/"+e+"(guid'"+f+"')",type:"POST",beforeSend:function(n){n.setRequestHeader("Accept","application/json");n.setRequestHeader("X-HTTP-Method","DELETE")}};return r(c,s)}function w(n,t,f,e){var o=e===i?!0:e,s=n+"Set",h=u()+"/"+s+"(guid'"+t+"')?$select="+f.join(",");return r({url:h},o)}function f(n,t){return r({url:n},t)}function b(n,t,f,e,o){var c=o===i?!0:o,s,h;return e=e?"&$filter="+encodeURIComponent(e):"",s=n+"Set",h=u()+"/"+s+"?$select="+t.join(",")+"&$expand="+f+e,r({url:h},c)}function e(n,t,f,e){var h=e===i?!0:e,o,s;return f=f?"&$filter="+encodeURIComponent(f):"",o=n+"Set",s=u()+"/"+o+"?$select="+t.join(",")+f,r({url:s},h)}function k(n,t,i,r){var u=new $.Deferred,o=[];return e(n,t,i,r).then(function s(n){o=o.concat(n.d.results);n.d.__next?(f(n.d.__next,r).then(s,u.reject),u.notify(n)):u.resolve(o)},u.reject),u.promise()}function d(t,f,e){var o=e===i?!0:e,s=t+"Set",h=n.JSON.stringify(f),c=u()+"/"+s;return r({type:"POST",url:c,data:h},o)}function g(t,f,e,o){var s=o===i?!0:o,h=t+"Set",c=n.JSON.stringify(e),l=u()+"/"+h+"(guid'"+f+"')",a={type:"POST",url:l,data:c,beforeSend:function(n){n.setRequestHeader("Accept","application/json");n.setRequestHeader("X-HTTP-Method","MERGE")}};return r(a,s)}function nt(n,t,f){var e=f===i?!0:f,o=n+"Set",s=u()+"/"+o+"(guid'"+t+"')",h={type:"POST",url:s,beforeSend:function(n){n.setRequestHeader("Accept","application/json");n.setRequestHeader("X-HTTP-Method","DELETE")}};return r(h,e)}var o="/XRMServices/2011/OrganizationData.svc";return{Version:"2.6.0",Retrieve:w,ByQuery:e,ByQueryUrl:f,ByExpandQuery:b,ByQueryAll:k,Create:d,Update:g,Delete:nt,Associate:y,Disassociate:p,EntityReferenceFactory:c,OptionSetValueFactory:l,MoneyValueFactory:a,ParseODataDate:v}}(window,document);typeof MCS=="undefined"&&(MCS={});MCS.cvt_Common={};MCS.cvt_Common.FORM_TYPE_CREATE=1;MCS.cvt_Common.FORM_TYPE_UPDATE=2;MCS.cvt_Common.FORM_TYPE_READ_ONLY=3;MCS.cvt_Common.FORM_TYPE_DISABLED=4;MCS.cvt_Common.FORM_TYPE_QUICKCREATE=5;MCS.cvt_Common.FORM_TYPE_BULKEDIT=6;MCS.cvt_Common.BlankGUID="00000000-0000-0000-0000-000000000000";MCS.cvt_Common.AppointmentOccursInPast=function(){var n,t,i;return Xrm.Page.ui.getFormType()==MCS.cvt_Common.FORM_TYPE_CREATE?!1:(n=Xrm.Page.getAttribute("scheduledstart"),n==null)?!1:(t=n.getValue(),t==null)?!1:(i=new Date,i>t?!0:!1)};MCS.cvt_Common.BuildRelationshipServerUrl=function(){var n=Xrm.Page.context.getClientUrl();return n.match(/\/$/)&&(n=n.substring(0,n.length-1)),n};MCS.cvt_Common.checkNull=function(n){var t=Xrm.Page.getAttribute(n);return t!=null?t.getValue():null};MCS.cvt_Common.closeWindow=function(n){var t,i;n!=null&&alert(n);t=Xrm.Page.data.entity.attributes.get();for(i in t)t[i].setSubmitMode("never");Xrm.Page.ui.close()};MCS.cvt_Common.collapseTab=function(n,t){var u=Xrm.Page.getControl(t),f=u.getAttribute(),i=f.getValue(),r=Xrm.Page.ui.tabs.get(n);i!=""&&i!=null?r.setDisplayState("expanded"):r.setDisplayState("collapsed")};MCS.cvt_Common.compareGUIDS=function(n,t){var i,r;return n==null&&t==null?!0:n==null||t==null?!1:(i=n.replace(/\W/g,""),i=i.toString().toUpperCase(),r=t.replace(/\W/g,""),r=r.toString().toUpperCase(),i==r?!0:!1)};MCS.cvt_Common.CreateFetch=function(n,t,i,r){var e="",f="",o="",u;if(t!=null&&t.length>0)for(column in t)e+='<attribute name="'+t[column]+'" />';if(i!=null&&i.length>0){f="<filter type='and'>";for(condition in i)f+=i[condition]}return r!=null&&r.length==2&&(o='<order attribute="'+r[0]+'" descending="'+r[1]+'" />'),u="<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='true' aggregate='false'>",u+="<entity name='"+n+"'>",u+=e,u+=o,u+=f,u+="<\/filter>",u+="<\/entity>",u+"<\/fetch>"};MCS.cvt_Common.DateTime=function(n,t,i){var r=Xrm.Page.getAttribute(n);r.getValue()==null&&r.setValue(new Date);r.setValue(r.getValue().setHours(t,i,0))};MCS.cvt_Common.EnableDependentLookup=function(n,t){var i=Xrm.Page.getAttribute(n),r=i!=null?i.getValue():null,u=r!=null?r[0].name:null;u!=null?(Xrm.Page.getControl(t).setVisible(!0),Xrm.Page.getControl(t).setFocus()):(Xrm.Page.getControl(t).setVisible(!1),Xrm.Page.getAttribute(t).setValue(null))};MCS.cvt_Common.EnableOtherDetails=function(n,t,i){var u=Xrm.Page.ui.controls.get(t),r=Xrm.Page.getAttribute(t),f=Xrm.Page.getAttribute(n).getValue();f!=null&&f.toString()==i?(u.setDisabled(!1),u.setVisible(!0),r.setRequiredLevel("required"),r.setSubmitMode("dirty")):(r.getValue()!=""&&(r.setValue(""),r.setSubmitMode("always")),u.setDisabled(!0),u.setVisible(!1),r.setRequiredLevel("none"))};MCS.cvt_Common.formatXML=function(n){if(n)return n.replace(/&/g,"&amp;")};MCS.cvt_Common.getObjectTypeCode=function(n){var i=new parent.RemoteCommand("LookupService","RetrieveTypeCode"),t;return i.SetParameter("entityName",n),t=i.Execute(),t.Success&&typeof t.ReturnValue=="number"?t.ReturnValue:null};MCS.cvt_Common.MVIConfig=function(){var t="",n=!1,i;return calls=CrmRestKit.ByQuery("mcs_setting",["cvt_UseMVI","cvt_MVIRoles"],"mcs_name eq 'Active Settings'",!1),calls.fail(function(){return n}).done(function(i){i&&i.d&&i.d.results!=null&&i.d.results.length!=0&&(n=i.d.results[0].cvt_UseMVI!=null?i.d.results[0].cvt_UseMVI:!1,t=i.d.results[0].cvt_MVIRoles)}),i=MCS.cvt_Common.userHasRoleInList(t),n&&i};MCS.cvt_Common.Notifications=function(n,t,i){var r=Sys.Application.findComponent("crmNotifications");switch(n){case"Add":r&&t&&i&&r.AddNotification("noteId1",t,"namespace",i);break;case"Hide":r.SetVisible(!1)}};MCS.cvt_Common.openDialogOnCurrentRecord=function(n){return EntityName=Xrm.Page.data.entity.getEntityName(),objectId=Xrm.Page.data.entity.getId(),MCS.cvt_Common.openDialogProcess(n,EntityName,objectId)};MCS.cvt_Common.openDialogProcess=function(n,t,i){(t==null||t=="")&&(t=Xrm.Page.data.entity.getEntityName());(i==null||i=="")&&(i=Xrm.Page.data.entity.getId());var f=Xrm.Page.context.getClientUrl()+"/cs/dialog/rundialog.aspx?DialogId="+n+"&EntityName="+t+"&ObjectId="+i,r=400,u=400,e=(screen.width-r)/2,o=(screen.height-u)/2;return window.open(f,"","location=0,menubar=1,resizable=1,width="+r+",height="+u+",top="+o+",left="+e+"")};MCS.cvt_Common.RestError=function(n){return JSON.parse(n.responseText).error.message.value};MCS.cvt_Common.SetFacilityFromSite=function(n,t){var r=Xrm.Page.getAttribute(n),i=Xrm.Page.getAttribute(t),e=i.getValue()!=null?i.getValue()[0].id:null,u=r.getValue()!=null?r.getValue()[0].id:null,f;u!=null?(f=CrmRestKit.Retrieve("mcs_site",u,["mcs_FacilityId"],!1),f.fail(function(){}).done(function(n){if(n&&n.d&&n.d.mcs_FacilityId){var t=[];t[0]={};t[0].id="{"+n.d.mcs_FacilityId.Id+"}";t[0].name=n.d.mcs_FacilityId.Name;t[0].entityType="mcs_facility";i.setValue(t)}})):i.setValue(null);MCS.cvt_Common.compareGUIDS(e,i.getValue()!=null?i.getValue()[0].id:null)!=!0&&i.setSubmitMode("always")};MCS.cvt_Common.TrimBookendBrackets=function(n){return n!=null&&n.length>0?n.charAt(0)=="{"?n.slice(1,n.length-1):n:""};MCS.cvt_Common.userHasRoleInList=function(n){for(var r=Xrm.Page.context.getUserRoles(),t=!1,i=0;i<r.length;i++){if(t)return!0;CrmRestKit.Retrieve("Role",r[i],["Name"],!1).fail(function(){return}).done(function(i){if(i!=null&&i.d!=null){var r=i.d.Name.trim().toLowerCase();if(n.toLowerCase().indexOf(r)!=-1){t=!0;return}}})}return t};typeof MCS=="undefined"&&(MCS={__namespace:!0});MCS.GlobalFunctions={GetRequestObject:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(n){return null}},GuidsAreEqual:function(n,t){return n==null||t==null?!1:n.replace(/[{}]/g,"").toLowerCase()==t.replace(/[{}]/g,"").toLowerCase()},getODataUTCDateFilter:function(n){var f,u=(n.getUTCMonth()+1).toString(),e,r,i,t;return f=u.length==1?"0"+u:u,r=n.getUTCDate().toString(),e=r.length==1?"0"+r:r,i="datetime'",i+=n.getUTCFullYear()+"-",i+=f+"-",i+=e,i+="T",t=n.getUTCHours(),t.toString().length==1&&(t="0"+t),i+=t+":",t=n.getUTCMinutes(),t.toString().length==1&&(t="0"+t),i+=t+":",t=n.getUTCSeconds(),t.toString().length==1&&(t="0"+t),i+(t+"'")},getAuthenticationHeader:function(){var n=Xrm.Page.context.getAuthenticationHeader()},_getClientUrl:function(n){var i="/xrmservices/2011/organization.svc/web",t,r;if(n=="ODATA"&&(i="/xrmservices/2011/organizationdata.svc"),t="",typeof GetGlobalContext=="function")r=GetGlobalContext(),t=r.getClientUrl();else if(typeof Xrm.Page.context=="object")t=Xrm.Page.context.getClientUrl();else throw new Error("Unable to access the server URL");return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t+i},runWorkflow:function(n,t,i){var r='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',u;r+='<request i:type="b:ExecuteWorkflowRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">';r+='<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';r+="<a:KeyValuePairOfstringanyType>";r+="<c:key>EntityId<\/c:key>";r+='<c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+n+"<\/c:value>";r+="<\/a:KeyValuePairOfstringanyType>";r+="<a:KeyValuePairOfstringanyType>";r+="<c:key>WorkflowId<\/c:key>";r+='<c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+t+"<\/c:value>";r+="<\/a:KeyValuePairOfstringanyType>";r+="<\/a:Parameters>";r+='<a:RequestId i:nil="true" />';r+="<a:RequestName>ExecuteWorkflow<\/a:RequestName>";r+="<\/request>";r+="<\/Execute>";r=this._getSOAPWrapper(r);u=new XMLHttpRequest;u.open("POST",this._getClientUrl("SOAP"),!0);u.setRequestHeader("Accept","application/xml, text/xml, */*");u.setRequestHeader("Content-Type","text/xml; charset=utf-8");u.setRequestHeader("SOAPAction",this._Action.RunWorkflow);u.onreadystatechange=function(){i(u)};u.send(r)},runWorkflowResponse:function(){return new MCS.GlobalFunctions._response(200,function(){return"OK"})},createSOAPRequest:function(n,t,i){var r='<Create xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">',u;r+='<entity xmlns:b="http://schemas.microsoft.com/xrm/2011/Contracts"';r+=' xmlns:i="http://www.w3.org/2001/XMLSchema-instance">';r+=this._getAttributeWrapper(t);r+='<b:EntityState i:nil="true"/>';r+='<b:FormattedValues xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>';r+="<b:Id>00000000-0000-0000-0000-000000000000<\/b:Id>";r+="<b:LogicalName>"+n+"<\/b:LogicalName>";r+='<b:RelatedEntities xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>';r+="<\/entity>";r+="<\/Create>";r=this._getSOAPWrapper(r);u=new XMLHttpRequest;u.open("POST",this._getClientUrl("SOAP"),!0);u.setRequestHeader("Accept","application/xml, text/xml, */*");u.setRequestHeader("Content-Type","text/xml; charset=utf-8");u.setRequestHeader("SOAPAction",this._Action.Create);u.onreadystatechange=function(){i.parseResponse(u)};u.send(r)},createResponse:function(){return new MCS.GlobalFunctions._response(200,function(n){return n.selectSingleNode("//CreateResult").text})},retrieveRequest:function(n,t,i,r){var f='<Retrieve xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">',u;f+="<entityName>"+n+"<\/entityName>";f+="<id>"+t+"<\/id>";f+=MCS.GlobalFunctions._getColumnSet(i);f+="<\/Retrieve>";f=this._getSOAPWrapper(f);u=new XMLHttpRequest;u.open("POST",this._getClientUrl("SOAP")+"/web",!0);u.setRequestHeader("Accept","application/xml, text/xml, */*");u.setRequestHeader("Content-Type","text/xml; charset=utf-8");u.setRequestHeader("SOAPAction",this._Action.Retrieve);u.onreadystatechange=function(){r._parseResponse(u)};u.send(f)},retrieveResponse:function(){return new MCS.GlobalFunctions._response(200,function(n){for(var i,r=n.selectNodes("//a:KeyValuePairOfstringanyType"),f={},t=0;t<r.length;t++){var e=r[t].selectSingleNode("b:key").text,o=r[t].selectSingleNode("b:value").attributes.getNamedItem("i:type").text,u=r[t].selectSingleNode("b:value");switch(o){case"c:guid":case"c:string":f[e]=u.text;break;case"a:EntityReference":i={};i.Id=u.selectSingleNode("a:Id").text;i.LogicalName=u.selectSingleNode("a:LogicalName").text;i.Name=u.selectSingleNode("a:Name").text;f[e]=i;break;default:throw new Error("Parsing "+o+" attributes not Implemented.");}}return f})},updateRequest:function(){},updateResponse:function(){},deleteRequest:function(){},deleteResponse:function(){},_getSOAPWrapper:function(n){var t='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body>';return t+=n,t+"<\/s:Body><\/s:Envelope>"},_getAttributeWrapper:function(n){for(var i,r='<b:Attributes xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',t=0;t<n.length;t++){i="<b:KeyValuePairOfstringanyType>"+("<c:key>"+n[t].name+"<\/c:key>");switch(n[t].type){case"string":i+='<c:value i:type="d:'+n[t].type+'" ';i+=' xmlns:d="http://www.w3.org/2001/XMLSchema">'+n[t].value+"<\/c:value>";break;case"EntityReference":i+='<c:value i:type="b:EntityReference">';i+="<b:Id>"+n[t].value.Id+"<\/b:Id>";i+="<b:LogicalName>"+n[t].value.LogicalName+"<\/b:LogicalName>";i+=n[t].value.Name==null?'<b:Name i:nil="true"/>':"<b:Name>"+n[t].value.Name+"<\/b:Name>";i+="<\/c:value>"}i+="<\/b:KeyValuePairOfstringanyType>";r+=i}return r+"<\/b:Attributes>"},columnSet:function(n){var t,i,u,r;if(n==null)return{allColumns:!1,columns:[]};t="The columns parameter must be a comma separated list of strings or an array of strings.";i=[];switch(typeof n){case"string":i=n.split(",");break;case"object":if(n instanceof Array){for(u=!0,r=0;r<n.length;r++)if(typeof n[r]!="string"){u=!1;break}if(u)i=n;else throw new Error(t);}else throw new Error(t);break;default:throw new Error(t);}return{allColumns:!1,columns:i}},_getColumnSet:function(n){var t='<columnSet xmlns:b="http://schemas.microsoft.com/xrm/2011/Contracts"',i;if(t+=' xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',n.allColumns==!0)t+="<b:AllColumns>true<\/b:AllColumns>";else{for(t+="<b:AllColumns>false<\/b:AllColumns>",t+='<b:Columns xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/Arrays">',i=0;i<n.columns.length;i++)t+="<c:string>"+n.columns[i]+"<\/c:string>";t+="<\/b:Columns>"}return t+"<\/columnSet>"},_Action:{Execute:"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute",Create:"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Create",Retrieve:"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Retrieve",Update:"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Update",Delete:"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Delete",RunWorkflow:"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute"},_getError:function(n){var e="Unknown Error (Unable to parse the fault)",u,t,i,r,f;if(typeof n=="object")try{for(u=n.firstChild.firstChild,t=0;t<u.childNodes.length;t++)if(i=u.childNodes[t],"s:Fault"==i.nodeName){for(r=0;r<i.childNodes.length;r++)if(f=i.childNodes[r],"faultstring"==f.nodeName){e=f.text;break}break}}catch(o){}return new Error(e)},_response:function(n,t){return{_state:"sent",_data:null,_error:null,_parseData:t,onComplete:null,_parseResponse:function(i){i.readyState==4&&(this._state="recieved",i.status==n?(this._data=t(i.responseXML),this._state="complete",this.onComplete!=null&&this.onComplete()):(this._state="error",this._error=new MCS.GlobalFunctions._getError(i.responseXML),this.onComplete!=null&&this.onComplete()))},getError:function(){if(this._error!=null)return this._error;throw new Error("No error exists.");},getState:function(){return this._state},getData:function(){if(this._state=="complete")return this._data;throw new Error("Data is not ready yet.");}}},createRestRecord:function(n,t,i){var u=window.JSON.stringify(n),r=new XMLHttpRequest;r.open("POST",this._getClientUrl("ODATA")+"/"+i,!0);r.setRequestHeader("Accept","application/json");r.setRequestHeader("Content-Type","application/json; charset=utf-8");r.onreadystatechange=function(){MCS.GlobalFunctions.createRestReqCallBack(this,t)};r.send(u)},createRestReqCallBack:function(n,t){if(n.readyState==4)if(n.status==201){var i=JSON.parse(n.responseText).d;t(i)}else MCS.GlobalFunctions.errorHandler(n)},RetrieveRecords:function(n,t){var i=new XMLHttpRequest;i.open("GET",this._getClientUrl("ODATA")+n,!0);i.setRequestHeader("Accept","application/json");i.setRequestHeader("Content-Type","application/json; charset=utf-8");i.onreadystatechange=function(){MCS.GlobalFunctions.RetrieveRecordsCallBack(this,t)};i.send()},dateReviver:function(n,t){var i;return typeof t=="string"&&(i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t),i)?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6])):t},RetrieveRecordsCallBack:function(n,t){var i,r;n.readyState==4&&(n.status==200?(i=JSON.parse(n.responseText,MCS.GlobalFunctions.dateReviver).d,t(i.results),null!=i.__next&&(r=i.__next.replace(MCS.GlobalFunctions.GetODataPath(),""),MCS.GlobalFunctions.RetrieveRecords(r,t))):MCS.GlobalFunctions.errorHandler(n))},errorHandler:function(n){n?n.status!=null?XMLHttpRequest.statusText!=null?alert("Error : "+n.status+": "+n.statusText+": "+JSON.parse(n.responseText).error.message.value):alert(XMLHttpRequest):alert(XMLHttpRequest):alert("Unknown error occurred")},__namespace:!0};XrmSvcToolkit=function(n,t){
/**
    * XrmSvcToolkit v0.2, a small JavaScript library that helps access 
    * Microsoft Dynamics CRM 2011 web service interfaces (SOAP and REST)
    *
    * @copyright    Copyright (c) 2011 - 2013, KingswaySoft (http://www.kingswaysoft.com)
    * @license      Microsoft Public License (Ms-PL)
    * @developer    Daniel Cai (http://danielcai.blogspot.com)
    * @contributors George Doubinski, Mitch Milam, Carsten Groth
    *
    * THIS SOFTWARE IS PROVIDED BY KingswaySoft ''AS IS'' AND ANY
    * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
    * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
    * DISCLAIMED. IN NO EVENT SHALL KingswaySoft BE LIABLE FOR ANY
    * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
    * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
    * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    *
    */
var o="/XRMServices/2011/OrganizationData.svc",tt="/XRMServices/2011/Organization.svc/web",c=Object.prototype.toString,i=function(n){return c.call(n)==="[object Function]"},it=function(n){return!isNaN(parseInt(n))},l=function(n){return c.call(n)==="[object String]"},rt=function(n){return c.call(n)==="[object Array]"},r=function(n){return!l(n)||n.length===0?!1:/[^\s]+/.test(n)},v=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\.?(\d*)?(Z|[+-]\d{2}?(:\d{2})?)?$/,y=/^\/Date\(([-+]?\d+)\)\/$/,h=function(){if(i(n.GetGlobalContext))return GetGlobalContext();if(Xrm!=t)return Xrm.Page.context;throw new Error("CRM context is not available.");}(),e=function(){var r,i;return h.getClientUrl!==t?h.getClientUrl():(r=n.location.protocol+"//"+n.location.host,h.isOutlookClient()&&!h.isOutlookOnline())?r:(i=h.getClientUrl(),i=i.replace(/^(http|https):\/\/([_a-zA-Z0-9\-\.]+)(:([0-9]{1,5}))?/,r),i=i.replace(/\/$/,""),i)}(),ut=function(n){var t;try{t=JSON.parse(n.responseText).error.message.value}catch(i){t=n.responseText}return t=t.length>0?"Error: "+n.status+": "+n.statusText+": "+t:"Error: "+n.status+": "+n.statusText,new Error(t)},ft=function(n){var t=n.responseText.length>0?"Error: "+n.status+": "+n.statusText+": "+n.responseText:"Error: "+n.status+": "+n.statusText;return new Error(t)},et=function(n,t){if(typeof t=="string"&&t.match(y)){var i=t.replace(y,"$1");return new Date(parseInt(i,10))}return t},ot=function(n){var t,i,r;if(n==null)return null;if(n=="")return"";for(i="",r=0;r<n.length;r++)t=n.charCodeAt(r),i=t>96&&t<123||t>64&&t<91||t>47&&t<58||t==32||t==44||t==46||t==45||t==95?i+String.fromCharCode(t):i+"&#"+t+";";return i},st=function(n){if(n==null||!n.match(v))return null;var t=v.exec(n);return new Date(Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10)-(t[8]==""||t[8]=="Z"?0:parseInt(t[8])),parseInt(t[5],10),parseInt(t[6],10)))},p=function(n,t){for(var r,i=0;i<n.attributes.length;i++)if(r=n.attributes[i],r.name==t)return r.value},u=function(n){return n.text!==t?n.text:n.textContent},w=function(n,t){switch(n){case"c:string":case"c:guid":return u(t);case"c:boolean":return u(t)==="true";case"c:int":return parseInt(u(t));case"c:decimal":case"c:double":return parseFloat(u(t));case"c:dateTime":return st(u(t));case"a:OptionSetValue":return t=f(t,"a:Value"),{Value:parseInt(u(t))};case"a:Money":return t=f(t,"a:Value"),{Value:u(t)};case"a:EntityReference":return ht(t);case"a:EntityCollection":return k(t);case"a:AliasedValue":return t=f(t,"a:Value"),n=p(t,"i:type"),w(n,t);default:throw new Error('Unhandled field type: "'+n+'", please report the problem to the developer. ');}},b=function(n,i){if(rt(n)&&n.length>0)return n.join(",");if(l(n))return n;if(i!=t)throw new Error(i+" parameter must be either a delimited string or an array. ");else return""},k=function(n){for(var t,h,i,r,l,e,a,v,y,b,k,o,s=0;s<n.childNodes.length;s++){t=n.childNodes[s];switch(t.nodeName){case"a:EntityName":v=u(t);break;case"a:MoreRecords":y=u(t)==="true";break;case"a:PagingCookie":b=u(t);break;case"a:TotalRecordCount":k=parseInt(u(t));break;case"a:Entities":o=t}}for(h={entityName:v,moreRecords:y,pagingCookie:b,totalRecordCount:k,entities:[]},i=0;i<o.childNodes.length;i++){var c={formattedValues:[]},d=o.childNodes[i],g=f(d,"a:Attributes");for(r=0;r<g.childNodes.length;r++){var nt=g.childNodes[r],it=u(f(nt,"b:key")),tt=f(nt,"b:value"),rt=p(tt,"i:type");c[it]=w(rt,tt)}for(l=f(d,"a:FormattedValues"),e=0;e<l.childNodes.length;e++)a=l.childNodes[e],c.formattedValues[u(f(a,"b:key"))]=u(f(a,"b:value"));h.entities.push(c)}return h},ht=function(n){for(var t,r,f,e,i=0;i<n.childNodes.length;i++){t=n.childNodes[i];switch(t.nodeName){case"a:Id":r=u(t);break;case"a:LogicalName":f=u(t);break;case"a:Name":e=u(t)}}return{Id:r,LogicalName:f,Name:e}},f=function(n,t){for(var r,i=0;i<n.childNodes.length;i++)if(r=n.childNodes[i],r.nodeName==t)return r},ct=function(n){try{var t=n.firstChild.firstChild,i=f(t,"s:Fault"),r=f(i,"faultstring");return new Error(u(r))}catch(e){return new Error("An error occurred when parsing the error returned from CRM server: "+e.message)}},d=function(n,t,i){try{var r=n.firstChild.firstChild.firstChild.firstChild}catch(u){i(u);return}return t(r)},lt=function(n){var t=f(n,"a:Results"),i=f(t.firstChild,"b:value");return k(i)},g=function(n,t,i){if(n.status>=200&&n.status<300||n.status===304||n.status===1223){try{var r=!n.responseText?null:JSON.parse(n.responseText,et).d}catch(u){i(u);return}return t(r)}i(ut(n))},s=function(n,t,i){var r=new XMLHttpRequest,u;if(r.open(n.type,n.url,n.async),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Content-Type","application/json; charset=utf-8"),!n.method||r.setRequestHeader("X-HTTP-Method",n.method),u=!1,n.async)r.onreadystatechange=function(){r.readyState==4&&g(r,t,i)},n.data?r.send(n.data):r.send();else try{return n.data?r.send(n.data):r.send(),g(r,t,i)}catch(f){i(f)}},a=function(n,t,i,r){var u=new XMLHttpRequest,f,s,o;if(u.open("POST",e+tt,t),u.setRequestHeader("Accept","application/xml, text/xml, */*"),u.setRequestHeader("Content-Type","text/xml; charset=utf-8"),u.setRequestHeader("SOAPAction","http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute"),f=['<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body>',n,"<\/s:Body><\/s:Envelope>"].join(""),t)u.onreadystatechange=function(){u.readyState==4&&(u.status==200?d(u.responseXML,i,r):r(ft(u)))},u.send(f);else{try{if(u.send(f),u.status==200)return d(u.responseXML,i,r);o=ct(u.responseXML);r(o);return}catch(h){r(h);return}i(s)}},at=function(n){if(!r(n.executeXml))throw new Error("executeXml parameter was not provided. ");var t=!!n.async;return a(n.executeXml,t,function(r){return i(n.successCallback)&&n.successCallback(r),t?void 0:r},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})},vt=function(n){if(!r(n.id))throw new Error("id parameter was not provided. ");if(!r(n.entityName))throw new Error("entityName parameter was not provided. ");if(!it(n.stateCode))throw new Error("stateCode parameter must be an integer. ");n.statusCode==null&&(n.statusCode=-1);var u=['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">','<request i:type="b:SetStateRequest"',' xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" ',' xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" ',' xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic" ',' xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<c:key>EntityMoniker<\/c:key>",'<c:value i:type="a:EntityReference">',"<a:Id>",n.id,"<\/a:Id>","<a:LogicalName>",n.entityName,"<\/a:LogicalName>",'<a:Name i:nil="true" />',"<\/c:value>","<\/a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>State<\/c:key>",'<c:value i:type="a:OptionSetValue">',"<a:Value>",n.stateCode,"<\/a:Value>","<\/c:value>","<\/a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status<\/c:key>",'<c:value i:type="a:OptionSetValue">',"<a:Value>",n.statusCode,"<\/a:Value>","<\/c:value>","<\/a:KeyValuePairOfstringanyType>","<\/a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>SetState<\/a:RequestName>","<\/request>","<\/Execute>"].join(""),t=!!n.async;return a(u,t,function(r){return i(n.successCallback)&&n.successCallback(r),t?void 0:r},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})},yt=function(n){if(!r(n.fetchXml))throw new Error("fetchXml parameter was not provided. ");var u=['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">','<request i:type="a:RetrieveMultipleRequest"',' xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" ',' xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>Query<\/c:key>",'<c:value i:type="a:FetchExpression">',"<a:Query>",ot(n.fetchXml),"<\/a:Query>","<\/c:value>","<\/a:KeyValuePairOfstringanyType>","<\/a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>RetrieveMultiple<\/a:RequestName>","<\/request>","<\/Execute>"].join(""),t=!!n.async;return a(u,t,function(r){var u=lt(r);return i(n.successCallback)&&n.successCallback(u),t?void 0:u},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})},pt=function(n){var h;if(!r(n.entityName))throw new Error("entityName parameter was not provided. ");if(!r(n.id))throw new Error("id parameter was not provided. ");var f=n.select==null?"":b(n.select,"select"),u=n.expand==null?"":b(n.expand,"expand"),t="";return(f.length>0||u.length>0)&&(t="?",f.length>0&&(t+="$select="+f,u.length>0&&(t+="&")),u.length>0&&(t+="$expand="+u)),h={url:e+o+"/"+n.entityName+"Set(guid'"+n.id+"')"+t,type:"GET",async:!!n.async},s(h,function(t){return i(n.successCallback)&&n.successCallback(t),n.async?void 0:t},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})},nt=function(n){var t,u;if(!r(n.entityName))throw new Error("entityName parameter was not provided. ");if(t="",n.odataQuery!=null){if(!l(n.odataQuery))throw new Error("odataQuery parameter must be a string. ");t=n.odataQuery.charAt(0)!="?"?"?"+n.odataQuery:n.odataQuery}return u={url:e+o+"/"+n.entityName+"Set"+t,type:"GET",async:!!n.async},s(u,function(t){if(i(n.successCallback)&&n.successCallback(t.results),!n.async)return t.results;t.__next!=null?(n.odataQuery=t.__next.substring((e+o+"/"+n.entityName+"Set").length),nt(n)):i(n.completionCallback)&&n.completionCallback()},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})},wt=function(u){if(!r(u.entityName))throw new Error("entityName parameter was not provided. ");if(u.entity===null||u.entity===t)throw new Error("entity parameter was not provided. ");var f={url:e+o+"/"+u.entityName+"Set",type:"POST",data:n.JSON.stringify(u.entity),async:!!u.async};return s(f,function(n){return i(u.successCallback)&&u.successCallback(n),u.async?void 0:n},function(n){if(i(u.errorCallback))u.errorCallback(n);else throw n;})},bt=function(u){if(!r(u.entityName))throw new Error("entityName parameter was not provided. ");if(!r(u.id))throw new Error("id parameter was not provided. ");if(u.entity===null||u.entity===t)throw new Error("entity parameter was not provided. ");var f={url:e+o+"/"+u.entityName+"Set(guid'"+u.id+"')",type:"POST",method:"MERGE",data:n.JSON.stringify(u.entity),async:!!u.async};return s(f,function(n){return i(u.successCallback)&&u.successCallback(n),u.async?void 0:n},function(n){if(i(u.errorCallback))u.errorCallback(n);else throw n;})},kt=function(n){if(!r(n.entityName))throw new Error("entityName parameter was not provided. ");if(!r(n.id))throw new Error("id parameter was not provided. ");var t={url:e+o+"/"+n.entityName+"Set(guid'"+n.id+"')",type:"POST",method:"DELETE",async:!!n.async};return s(t,function(t){return i(n.successCallback)&&n.successCallback(t),n.async?void 0:t},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})},dt=function(t){if(!r(t.entity1Id))throw new Error("entity1Id parameter was not provided. ");if(!r(t.entity1Name))throw new Error("entity1Name parameter was not provided. ");if(!r(t.entity2Id))throw new Error("entity2Id parameter was not provided. ");if(!r(t.entity2Name))throw new Error("entity2Name parameter was not provided. ");if(!r(t.relationshipName))throw new Error("relationshipName parameter was not provided. ");var u={uri:e+o+"/"+t.entity2Name+"Set(guid'"+t.entity2Id+"')"},f={url:e+o+"/"+t.entity1Name+"Set(guid'"+t.entity1Id+"')/$links/"+t.relationshipName,type:"POST",data:n.JSON.stringify(u),async:!!t.async};return s(f,function(n){return i(t.successCallback)&&t.successCallback(n),t.async?void 0:n},function(n){if(i(t.errorCallback))t.errorCallback(n);else throw n;})},gt=function(n){if(!r(n.entity1Id))throw new Error("entity1Id parameter was not provided. ");if(!r(n.entity1Name))throw new Error("entity1Name parameter was not provided. ");if(!r(n.entity2Id))throw new Error("entity2Id parameter was not provided. ");if(!r(n.relationshipName))throw new Error("relationshipName parameter was not provided. ");var t={url:e+o+"/"+n.entity1Name+"Set(guid'"+n.entity1Id+"')/$links/"+n.relationshipName+"(guid'"+n.entity2Id+"')",type:"POST",method:"DELETE",async:!!n.async};return s(t,function(t){return i(n.successCallback)&&n.successCallback(t),n.async?void 0:t},function(t){if(i(n.errorCallback))n.errorCallback(t);else throw t;})};return{context:h,serverUrl:e,retrieve:pt,retrieveMultiple:nt,createRecord:wt,updateRecord:bt,deleteRecord:kt,associate:dt,disassociate:gt,setState:vt,execute:at,fetch:yt}}(window);typeof MCS=="undefined"&&(MCS={});MCS.mcs_TSA_OnLoad={};MCS.mcs_TSA_OnLoad.FormType;MCS.mcs_TSA_OnLoad.EntityName;MCS.mcs_TSA_OnLoad.GroupAppt;MCS.mcs_TSA_OnLoad.Type;MCS.mcs_TSA_OnLoad.EntityId;MCS.mcs_TSA_OnLoad.TSAName;MCS.mcs_TSA_OnLoad.MTSAName;MCS.mcs_TSA_OnLoad.relatedProviderSiteId;MCS.mcs_TSA_OnLoad.relatedProviderSiteName;MCS.mcs_TSA_OnLoad.relatedPatientSiteId;MCS.mcs_TSA_OnLoad.relatedPatientSiteName;MCS.mcs_TSA_OnLoad.relatedPatientFacilityId;MCS.mcs_TSA_OnLoad.relatedPatientFacilityName;MCS.mcs_TSA_OnLoad.ProvResourcesCreated=new Boolean;MCS.SiteEmergencyPhone;MCS.SiteMainPhone;MCS.TCTPhone="";MCS.SiteLocal911Phone;MCS.mcs_TSA_OnLoad.Capacity;MCS.mcs_TSA_OnLoad.InitalStatus;MCS.mcs_TSA_OnLoad.OnLoad=function(){(MCS.mcs_TSA_OnLoad.CheckForMTSA(),Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()!=null)&&(MCS.mcs_TSA_OnLoad.FormType=Xrm.Page.ui.getFormType(),MCS.mcs_TSA_OnLoad.EntityName=Xrm.Page.data.entity.getEntityName(),MCS.mcs_TSA_OnLoad.GroupAppt=Xrm.Page.getAttribute("cvt_groupappointment")!=null?Xrm.Page.getAttribute("cvt_groupappointment").getValue():!1,MCS.mcs_TSA_OnLoad.Type=Xrm.Page.getAttribute("cvt_type")!=null?Xrm.Page.getAttribute("cvt_type").getValue():!1,MCS.mcs_TSA_OnLoad.EntityId=Xrm.Page.data.entity.getId(),MCS.mcs_TSA_OnLoad.FormType==MCS.cvt_Common.FORM_TYPE_CREATE&&MCS.cvt_Common.DateTime("cvt_beginngtime",8,00),MCS.cvt_Common.EnableDependentLookup("cvt_servicetype","cvt_servicesubtype"),Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()!=null&&Xrm.Page.getControl("cvt_relatedmasterid").setDisabled(!0),Xrm.Page.getAttribute("cvt_providerlocationtype").getValue()!=null?Xrm.Page.getControl("cvt_providerlocationtype").setDisabled(!0):Xrm.Page.getControl("cvt_providerlocationtype").setDisabled(!1),Xrm.Page.getControl("mcs_name").setFocus(),Xrm.Page.getAttribute("cvt_relatedpatientsiteid").setSubmitMode("always"))};MCS.mcs_TSA_OnLoad.BulkEdit=function(){if(MCS.mcs_TSA_OnLoad.FormType!=6){Xrm.Page.ui.tabs.get("tab_Pat").sections.get("tab_Pat_section_Bulk").setVisible(!1);Xrm.Page.ui.tabs.get("tab_Name").setVisible(!0);Xrm.Page.ui.tabs.get("tab_Info").sections.get("tab_Info_section_General").setVisible(!0);Xrm.Page.ui.tabs.get("tab_Info").sections.get("tab_Info_section_General2").setVisible(!0);Xrm.Page.ui.tabs.get("tab_Prov").sections.get("tab_provresources").setVisible(!0);Xrm.Page.ui.tabs.get("tab_Pat").sections.get("tab_patientresources").setVisible(!0);Xrm.Page.ui.tabs.get("tab_Pat").sections.get("tab_Info_section_Emergency").setVisible(!0);Xrm.Page.getControl("IFRAME_EmergencyContactViewer").setVisible(!0);Xrm.Page.ui.tabs.get("tab_Admin").setVisible(!0);MCS.mcs_TSA_OnLoad.SOS();calls=CrmRestKit.ByQuery("mcs_setting",["cvt_telehealthoperationsmanual"],"mcs_name eq 'Active Settings'",!1);calls.fail(function(){}).done(function(n){if(n&&n.d&&n.d.results!=null&&n.d.results.length!=0){var t=n.d.results[0].cvt_telehealthoperationsmanual!=null?n.d.results[0].cvt_telehealthoperationsmanual:null;t!=null&&Xrm.Page.getAttribute("cvt_telehealthoperationsmanual").setValue(t)}})}};MCS.mcs_TSA_OnLoad.GetAttributes=function(){var t,r,u,n,i;MCS.mcs_TSA_OnLoad.TSAName=Xrm.Page.getAttribute("mcs_name").getValue();t=Xrm.Page.getAttribute("cvt_relatedprovidersiteid");r=Xrm.Page.getAttribute("cvt_relatedpatientsiteid");switch(MCS.mcs_TSA_OnLoad.GroupAppt){case!1:r.getValue()!=null&&(u=r.getValue(),MCS.mcs_TSA_OnLoad.relatedPatientSiteId=u[0].id,MCS.mcs_TSA_OnLoad.relatedPatientSiteName=u[0].name);t.getValue()!=null&&(n=t.getValue(),MCS.mcs_TSA_OnLoad.relatedProviderSiteId=n[0].id,MCS.mcs_TSA_OnLoad.relatedProviderSiteName=n[0].name);break;case!0:t.getValue()!=null&&(n=t.getValue(),MCS.mcs_TSA_OnLoad.relatedProviderSiteId=n[0].id,MCS.mcs_TSA_OnLoad.relatedProviderSiteName=n[0].name);i=Xrm.Page.getAttribute("cvt_patientfacility");i.getValue()!=null&&(MCS.mcs_TSA_OnLoad.relatedPatientFacilityId=i.getValue()[0].id,MCS.mcs_TSA_OnLoad.relatedPatientFacilityName=i.getValue()[0].name)}};MCS.mcs_TSA_OnLoad.LoadProvResources=function(){var n;if(Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()!=null&&(n=Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()[0].id,n!=null&&MCS.mcs_TSA_OnLoad.FormType==1&&MCS.mcs_TSA_OnLoad.ProvResourcesCreated==!1)){var t=["<condition attribute='cvt_relatedmastertsaid' operator='eq' uitype='cvt_mastertsa' value='"+n+"' />","<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>"],i=MCS.cvt_Common.CreateFetch("cvt_providerresourcegroup",["cvt_providerresourcegroupid","cvt_tsaresourcetype"],t,null);XrmSvcToolkit.fetch({fetchXml:i,async:!0,successCallback:function(t){var r,u,f,i;if(countValue=t.entities.length,countValue>0)for(r=0;r<countValue;r++)u=t.entities[r].cvt_providerresourcegroupid,f=t.entities[r].cvt_tsaresourcetype.Value,f==1&&(CrmRestKit.Retrieve("cvt_providerresourcegroup",u,["cvt_name","cvt_TSAResourceType","cvt_Type","cvt_RelatedResourceId","cvt_relatedsiteid"],!1).fail(function(){alert("Retrieve Failed")}).done(function(n){Name=n.d.cvt_name;Type=n.d.cvt_Type.Value;TSAType=n.d.cvt_TSAResourceType.Value;RelatedSite=n.d.cvt_relatedsiteid;Resource=n.d.cvt_RelatedResourceId}),i={cvt_name:Name,cvt_TSAResourceType:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:TSAType},cvt_Type:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:Type},cvt_RelatedResourceId:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:Resource.Id,LogicalName:Resource.LogicalName},cvt_relatedsiteid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:RelatedSite.Id,LogicalName:RelatedSite.LogicalName},cvt_mtsaguid:n},CrmRestKit.Create("cvt_providerresourcegroup",i,!0).fail(function(){alert("Create failed")}).done()),f==0&&(CrmRestKit.Retrieve("cvt_providerresourcegroup",u,["cvt_name","cvt_TSAResourceType","cvt_Type","cvt_RelatedResourceGroupid","cvt_relatedsiteid"],!1).fail(function(){alert("Retrieve Failed")}).done(function(n){Name=n.d.cvt_name;Type=n.d.cvt_Type.Value;TSAType=n.d.cvt_TSAResourceType.Value;RelatedSite=n.d.cvt_relatedsiteid;ResourceGroup=n.d.cvt_RelatedResourceGroupid}),i={cvt_name:Name,cvt_TSAResourceType:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:TSAType},cvt_Type:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:Type},cvt_RelatedResourceGroupid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:ResourceGroup.Id,LogicalName:ResourceGroup.LogicalName},cvt_relatedsiteid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:RelatedSite.Id,LogicalName:RelatedSite.LogicalName},cvt_mtsaguid:n},CrmRestKit.Create("cvt_providerresourcegroup",i,!0).fail(function(){alert("Create failed")}).done()),f==2&&(CrmRestKit.Retrieve("cvt_providerresourcegroup",u,["cvt_name","cvt_TSAResourceType","cvt_RelatedUserId","cvt_relatedsiteid"],!1).fail(function(){alert("Retrieve Failed")}).done(function(n){Name=n.d.cvt_name;TSAType=n.d.cvt_TSAResourceType.Value;RelatedSite=n.d.cvt_relatedsiteid;User=n.d.cvt_RelatedUserId}),i={cvt_name:Name,cvt_TSAResourceType:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:TSAType},cvt_RelatedUserId:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:User.Id,LogicalName:User.LogicalName},cvt_relatedsiteid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:RelatedSite.Id,LogicalName:RelatedSite.LogicalName},cvt_mtsaguid:n},CrmRestKit.Create("cvt_providerresourcegroup",i,!0).fail(function(){alert("Create failed")}).done())},errorCallback:function(n){throw n;}})}};MCS.mcs_TSA_OnLoad.AssignProvResources=function(){var n,t,i;if(Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()!=null&&(n=Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()[0].id,n!=null&&MCS.mcs_TSA_OnLoad.FormType==2)){typeof MCS.mcs_TSA_OnLoad!="undefined"?(t=MCS.mcs_TSA_OnLoad.EntityId,i=MCS.mcs_TSA_OnLoad.EntityName):(t=window.parent.MCS.mcs_TSA_OnLoad.EntityId,i=window.parent.MCS.mcs_TSA_OnLoad.EntityName);var r=["<condition attribute='cvt_mtsaguid' value='"+n+"' operator='eq'/>","<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>"],u=MCS.cvt_Common.CreateFetch("cvt_providerresourcegroup",["cvt_providerresourcegroupid","cvt_tsaresourcetype"],r,null);XrmSvcToolkit.fetch({fetchXml:u,async:!1,successCallback:function(n){var r,u,f;if(countValue=n.entities.length,countValue>0)for(r=0;r<countValue;r++)u=n.entities[r].cvt_providerresourcegroupid,f={cvt_RelatedTSAid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:t,LogicalName:i},cvt_mtsaguid:""},CrmRestKit.Update("cvt_providerresourcegroup",u,f,!1).fail(function(){alert("Update Failed")}).done(function(){})},errorCallback:function(n){throw n;}})}};MCS.mcs_TSA_OnLoad.RefreshGridAgain=function(){var t,n;if(Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()!=null&&(t=Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()[0].id,t!=null&&MCS.mcs_TSA_OnLoad.FormType==2)){if(n=document.getElementById("provgroups"),n==null){setTimeout(function(){MCS.mcs_TSA_OnLoad.RefreshGridAgain()},500);return}setTimeout(function(){n.control.Refresh!=undefined?n.control.Refresh():n.control.refresh()},3e3);setTimeout(function(){n.control.Refresh!=undefined?n.control.Refresh():n.control.refresh()},3e3);setTimeout(function(){n.control.Refresh!=undefined?n.control.Refresh():n.control.refresh()},3e3);setTimeout(function(){n.control.Refresh!=undefined?n.control.Refresh():n.control.refresh()},3e3)}};MCS.mcs_TSA_OnLoad.showEmergencyContactViewer=function(){var n,t,i;if(Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()!=null){if(MCS.mcs_TSA_OnLoad.FormType==MCS.cvt_Common.FORM_TYPE_CREATE||MCS.mcs_TSA_OnLoad.GroupAppt==!0||MCS.mcs_TSA_OnLoad.Type==!0){Xrm.Page.getControl("IFRAME_EmergencyContactViewer").setVisible(!1);return}if(Xrm.Page.getAttribute("cvt_relatedpatientsiteid").getValue()==null){alert("Please select a Patient Site.");Xrm.Page.getControl("IFRAME_EmergencyContactViewer").setVisible(!1);return}n=Xrm.Page.getAttribute("cvt_relatedpatientsiteid").getValue()[0];CrmRestKit.Retrieve("mcs_site",n.id,["cvt_Local911","cvt_UrgentEmergencyPhone","cvt_phone"],!1).fail(function(){}).done(function(n){var t=n.d,i=Xrm.Page.getAttribute("cvt_patientsitetctteam")!=null?Xrm.Page.getAttribute("cvt_patientsitetctteam").getValue():null,r;MCS.SiteLocal911Phone=t.cvt_Local911;MCS.SiteEmergencyPhone=t.cvt_UrgentEmergencyPhone;MCS.SiteMainPhone=t.cvt_phone;i!=null?(r="TeamId eq (Guid'"+i[0].id+"')",calls=CrmRestKit.ByQuery("TeamMembership",["TeamId","SystemUserId"],r,!1),calls.fail(function(){alert("team member retrieve failed")}).done(function(n){var r,t,u,i;if(n&&n.d&&n.d.results!=null&&n.d.results.length!=0)for(r=n.d.results,t=0;t<r.length;t++)u="",i="",CrmRestKit.Retrieve("SystemUser",r[t].SystemUserId,["FirstName","LastName","cvt_officephone","MobilePhone","SystemUserId"],!1).fail(function(){alert("user retrieve failed")}).done(function(n){var r=n.d.cvt_officephone,t=n.d.MobilePhone;u=n.d.FirstName+" "+n.d.LastName;i=t==null?r:t}),i!=null&&(MCS.TCTPhone!=""&&(MCS.TCTPhone+="; "),MCS.TCTPhone+=u+": "+i)})):MCS.TCTPhone="No TCT Team Members"});t=MCS.cvt_Common.BuildRelationshipServerUrl()+"/WebResources/cvt_EmergencyContactViewer.html";i=Xrm.Page.ui.controls.get("IFRAME_EmergencyContactViewer");i.setSrc(t)}};MCS.mcs_TSA_OnLoad.CheckForMTSA=function(){Xrm.Page.ui.getFormType()==MCS.cvt_Common.FORM_TYPE_CREATE&&Xrm.Page.getAttribute("cvt_relatedmasterid").getValue()==null&&MCS.cvt_Common.closeWindow("A TSA must be created from a MTSA.\n\nPlease close this TSA form and start from a MTSA.")};MCS.mcs_TSA_OnLoad.SOS=function(){Xrm.Page.getAttribute("cvt_servicetype").getValue()!=null&&CrmRestKit.Retrieve("mcs_servicetype",Xrm.Page.getAttribute("cvt_servicetype").getValue()[0].id,["cvt_specialtyoperationssupplement"],!1).fail(function(){}).done(function(n){var t=n.d.cvt_specialtyoperationssupplement;t&&(Xrm.Page.getControl("cvt_specialtyoperationssupplement").setVisible(!0),Xrm.Page.getAttribute("cvt_specialtyoperationssupplement").setValue(t))})};typeof MCS=="undefined"&&(MCS={});MCS.mcs_TSA_OnChange={};MCS.mcs_TSA_OnChange.ProductionLock=function(){var t=Xrm.Page.getAttribute("statuscode").getValue(),f=t==25192e4?!0:!1,n=t!=1&&t!=917290007?!0:!1,e=Xrm.Page.getAttribute("cvt_groupappointment")!=null?Xrm.Page.getAttribute("cvt_groupappointment").getValue():!1,u=e==!0?"Group Appointment ":"",i,r;u+=f==!0?"TSA(Production Lock) ~ Save in Draft to Edit":"TSA-Draft";Xrm.Page.ui.tabs.get("tab_Info").setLabel(u);i=["cvt_relatedprovidersiteid","cvt_servicetype","cvt_servicesubtype","cvt_groupappointment","cvt_provistaclinic","cvt_patvistaclinic","cvt_servicescope","cvt_availabletelehealthmodalities"];r=["cvt_servicelevels","cvt_relatedpatientsiteid","ownerid","cvt_relatedpatientsiteid","cvt_patientfacility","cvt_duration","cvt_startevery"];for(fields in i)Xrm.Page.getControl(i[fields]).setDisabled(!0);for(fields in r)Xrm.Page.getControl(r[fields]).setDisabled(n);n||(MCS.mcs_TSA_OnChange.GroupAppt(),MCS.mcs_TSA_OnChange.ChangeType());n&&Xrm.Page.getAttribute("cvt_duration").getValue()==null?Xrm.Page.getAttribute("cvt_duration").setRequiredLevel("none"):Xrm.Page.getAttribute("cvt_duration").setRequiredLevel("required");n&&Xrm.Page.getAttribute("cvt_startevery").getValue()==null?Xrm.Page.getAttribute("cvt_startevery").setRequiredLevel("none"):Xrm.Page.getAttribute("cvt_startevery").setRequiredLevel("required")};MCS.mcs_TSA_OnChange.GroupAppt=function(){var e=Xrm.Page.getAttribute("cvt_type").getValue(),n=Xrm.Page.getAttribute("cvt_relatedpatientsiteid"),r=Xrm.Page.getControl("cvt_relatedpatientsiteid"),u=Xrm.Page.getAttribute("cvt_patientfacility"),f=Xrm.Page.getControl("cvt_patientfacility"),i=Xrm.Page.getAttribute("statuscode").getValue(),o=Xrm.Page.getAttribute("cvt_groupappointment")!=null?Xrm.Page.getAttribute("cvt_groupappointment").getValue():null,t="";e?(n.setRequiredLevel("none"),n.setValue(null),r.setVisible(!1),u.setRequiredLevel("none"),f.setDisabled(!0),t+="Home/Mobile ",t+=o?i==25192e4?"Group Appointment TSA(Production Lock) ~ Save in Draft to Edit":"Group Appointment TSA-Draft":i==25192e4?"TSA(Production Lock) ~ Save in Draft to Edit":"TSA-Draft"):(o==1?(n.setRequiredLevel("none"),n.setValue(null),r.setVisible(!1),e||(f.setDisabled(!1),u.setRequiredLevel("required")),t=i==25192e4?"Group Appointment TSA(Production Lock) ~ Save in Draft to Edit":"Group Appointment TSA-Draft"):(r.setVisible(!0),n.setRequiredLevel("required"),f.setDisabled(!0),u.setRequiredLevel("none"),t=i==25192e4?"TSA(Production Lock) ~ Save in Draft to Edit":"TSA-Draft"),Xrm.Page.ui.tabs.get("tab_Info").setLabel(t))};MCS.mcs_TSA_OnChange.StoreForward=function(){var n=Xrm.Page.getAttribute("cvt_availabletelehealthmodalities").getValue()==917290001;Xrm.Page.getControl("cvt_groupappointment").setVisible(!n)};MCS.mcs_TSA_OnChange.ChangeType=function(){Xrm.Page.ui.getFormType()==MCS.cvt_Common.FORM_TYPE_CREATE&&(Xrm.Page.getAttribute("cvt_servicescope").setValue(917290001),Xrm.Page.getAttribute("cvt_servicescope").setSubmitMode("always"));Xrm.Page.getAttribute("cvt_type").setSubmitMode("always");Xrm.Page.getAttribute("cvt_type").getValue()==!0&&(Xrm.Page.getControl("cvt_groupappointment").setVisible(!0),Xrm.Page.getControl("cvt_servicescope").setDisabled(!0),Xrm.Page.getControl("cvt_relatedpatientsiteid").setVisible(!1),Xrm.Page.getControl("cvt_patientfacility").setVisible(!1),Xrm.Page.getAttribute("cvt_relatedpatientsiteid").setRequiredLevel("none"),Xrm.Page.ui.tabs.get("tab_Pat").setVisible(!1))};MCS.mcs_TSA_OnChange.setInterIntraFacility=function(){var n=Xrm.Page.getAttribute("cvt_relatedpatientsiteid"),t=Xrm.Page.getAttribute("cvt_patientfacility"),i=Xrm.Page.getAttribute("cvt_servicescope"),u=Xrm.Page.getAttribute("cvt_relatedprovidersiteid").getValue(),r,f,e;(n!=null&&(n=n.getValue()),t!=null&&(t=t.getValue()),r=n==null?"facility":"site",u!=null&&(r!="site"||n!=null)&&(r!="facility"||t!=null))&&(f=MCS.mcs_TSA_OnChange.QueryFacility(u[0].id).Id,e=r=="facility"?t[0].id:MCS.mcs_TSA_OnChange.QueryFacility(n[0].id).Id,MCS.cvt_Common.compareGUIDS(e,f)==!0?i.getValue()!=917290001&&i.setValue(917290001):i.getValue()!=91729e4&&i.setValue(91729e4),i.setSubmitMode("always"))};MCS.mcs_TSA_OnChange.QueryFacility=function(n){var t,i=CrmRestKit.Retrieve("mcs_site",n,["mcs_FacilityId"],!1);return i.fail(function(){return}).done(function(n){n&&n.d&&(t=n.d.mcs_FacilityId)}),t};MCS.mcs_TSA_OnChange.Specialty=function(){Xrm.Page.getAttribute("cvt_servicetype").getValue()!=null?(calls=CrmRestKit.ByQuery("mcs_servicesubtype",["mcs_name"],"cvt_relatedServiceTypeId/Id eq guid'"+Xrm.Page.getAttribute("cvt_servicetype").getValue()[0].id+"'",!1),calls.fail(function(){Xrm.Page.getControl("cvt_servicesubtype").setVisible(!1);Xrm.Page.getAttribute("cvt_servicesubtype").setValue(null)}).done(function(n){n&&n.d&&n.d.results!=null&&n.d.results.length!=0?(Xrm.Page.getControl("cvt_servicesubtype").setVisible(!0),Xrm.Page.getControl("cvt_servicesubtype").setFocus()):(Xrm.Page.getControl("cvt_servicesubtype").setVisible(!1),Xrm.Page.getAttribute("cvt_servicesubtype").setValue(null));MCS.mcs_TSA_OnLoad.SOS()})):(Xrm.Page.getControl("cvt_servicesubtype").setVisible(!1),Xrm.Page.getAttribute("cvt_servicesubtype").setValue(null))};MCS.mcs_TSA_OnChange.TCTTeamPro=function(){Xrm.Page.getAttribute("cvt_relatedprovidersiteid").getValue()!=null?(calls=CrmRestKit.ByQuery("Team",["Name","TeamId"],"cvt_Type/Value eq 917290007 and cvt_TMPSite/Id eq (Guid'"+Xrm.Page.getAttribute("cvt_relatedprovidersiteid").getValue()[0].id+"')",!1),calls.fail(function(){}).done(function(n){if(n&&n.d&&n.d.results!=null&&n.d.results.length!=0){var t=[];t[0]={};t[0].id=n.d.results[0].TeamId;t[0].name=n.d.results[0].Name;t[0].entityType="Team";Xrm.Page.getAttribute("cvt_providersitetctteam").setValue(t)}else Xrm.Page.getAttribute("cvt_providersitetctteam").setValue(null)})):Xrm.Page.getAttribute("cvt_providersitetctteam").setValue(null)};MCS.mcs_TSA_OnChange.TCTTeamPat=function(){Xrm.Page.getAttribute("cvt_relatedpatientsiteid").getValue()!=null?(calls=CrmRestKit.ByQuery("Team",["Name","TeamId"],"cvt_Type/Value eq 917290007 and cvt_TMPSite/Id eq (Guid'"+Xrm.Page.getAttribute("cvt_relatedpatientsiteid").getValue()[0].id+"')",!1),calls.fail(function(){}).done(function(n){if(n&&n.d&&n.d.results!=null&&n.d.results.length!=0){var t=[];t[0]={};t[0].id=n.d.results[0].TeamId;t[0].name=n.d.results[0].Name;t[0].entityType="Team";Xrm.Page.getAttribute("cvt_patientsitetctteam").setValue(t)}else Xrm.Page.getAttribute("cvt_patientsitetctteam").setValue(null)})):Xrm.Page.getAttribute("cvt_patientsitetctteam").setValue(null)};typeof MCS=="undefined"&&(MCS={});MCS.mcs_TSA={};MCS.mcs_TSA.CreateName=function(){var t=Xrm.Page.getAttribute("cvt_servicetype").getValue(),i=Xrm.Page.getAttribute("cvt_servicesubtype").getValue(),r=Xrm.Page.getAttribute("cvt_relatedprovidersiteid").getValue(),u=Xrm.Page.getAttribute("cvt_type").getValue(),f=Xrm.Page.getAttribute("cvt_groupappointment").getValue(),n="";t!=null&&(n+=t[0].name);i!=null&&(n+=" : ",n+=i[0].name);n+=" From ";r!=null&&(n+=r[0].name);f==!0||u==!0&&(n+=" to Home/Mobile");Xrm.Page.getAttribute("mcs_name").getValue()!=n&&(Xrm.Page.getAttribute("mcs_name").setSubmitMode("always"),Xrm.Page.getAttribute("mcs_name").setValue(n))};MCS.mcs_TSA.runRibbonWorkflow=function(n){MCS.GlobalFunctions.runWorkflow(Xrm.Page.data.entity.getId(),n,MCS.GlobalFunctions.runWorkflowResponse)};MCS.mcs_TSA.EnforceChanges=function(){MCS.mcs_TSA_OnLoad.GroupAppt!=Xrm.Page.getAttribute("cvt_groupappointment").getValue()&&Xrm.Page.getAttribute("cvt_groupappointment").setSubmitMode("always");Xrm.Page.getAttribute("cvt_relatedpatientsiteid").setSubmitMode("always");MCS.mcs_TSA_OnLoad.FormType==MCS.cvt_Common.FORM_TYPE_CREATE?Xrm.Page.getAttribute("cvt_type").setSubmitMode("always"):MCS.mcs_TSA_OnLoad.Type!=Xrm.Page.getAttribute("cvt_type").getValue()?Xrm.Page.getAttribute("cvt_type").setSubmitMode("always"):Xrm.Page.getAttribute("cvt_type").setSubmitMode("never")};MCS.mcs_TSA.RelatedServiceActivitiesWarning=function(n){var r=Xrm.Page.getAttribute("statuscode").getValue(),u=Xrm.Page.getAttribute("mcs_relatedserviceid").getValue(),i,t;r==25192e4&&u!=null&&(i=typeof MCS.mcs_TSA_OnLoad!="undefined"?MCS.mcs_TSA_OnLoad.EntityId:window.parent.MCS.mcs_TSA_OnLoad.EntityId,t="<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>",t+="<entity name='serviceappointment'>",t+="<attribute name='subject' alias='recordcount' aggregate='count' />",t+="<filter type='and'>",t+="<condition attribute='mcs_relatedtsa' operator='eq' uitype='mcs_services' value='"+i+"' />",t+="<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>",t+="<\/filter>",t+="<\/entity>",t+="<\/fetch>",XrmSvcToolkit.fetch({fetchXml:t,async:!1,successCallback:function(t){if(countValue=t.entities[0].recordcount,countValue>0){var i=confirm("Service Activities exist that are using previously defined service components of this TSA. Only future Service Activities will inherit the newly defined service components. If you would like to continue and update this TSA's service components, press OK. Otherwise press Cancel to abort and review the Service Activities using the previously defined service components of this TSA.");i==!0?x="Save Confirmed":(x=n.getEventArgs().preventDefault(),Xrm.Page.getAttribute("statuscode").setValue(1))}},errorCallback:function(n){throw n;}}))};MCS.mcs_TSA.CheckPatientProviderSiteResources=function(n){var r=Xrm.Page.getAttribute("statuscode").getValue(),i,t;r==25192e4&&(i=typeof MCS.mcs_TSA_OnLoad!="undefined"?MCS.mcs_TSA_OnLoad.EntityId:window.parent.MCS.mcs_TSA_OnLoad.EntityId,Xrm.Page.getAttribute("cvt_type").getValue()!=!0&&(t="<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>",t+="<entity name='cvt_patientresourcegroup'>",t+="<attribute name='cvt_name' alias='recordcount' aggregate='count' />",t+="<filter type='and'>",t+="<condition attribute='cvt_relatedtsaid' operator='eq' uitype='mcs_services' value='"+i+"' />",t+="<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>",t+="<\/filter>",t+="<\/entity>",t+="<\/fetch>",XrmSvcToolkit.fetch({fetchXml:t,async:!1,successCallback:function(t){countValue=t.entities[0].recordcount;countValue<1&&(alert("No Patient Site Resources have been added to this TSA. Patient Site Resources must be added before moving this TSA to Production status."),x=n.getEventArgs().preventDefault(),Xrm.Page.getAttribute("statuscode").setValue(1))},errorCallback:function(n){throw n;}})),t="<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>",t+="<entity name='cvt_providerresourcegroup'>",t+="<attribute name='cvt_name' alias='recordcount' aggregate='count' />",t+="<filter type='and'>",t+="<condition attribute='cvt_relatedtsaid' operator='eq' uitype='mcs_services' value='"+i+"' />",t+="<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>",t+="<\/filter>",t+="<\/entity>",t+="<\/fetch>",XrmSvcToolkit.fetch({fetchXml:t,async:!1,successCallback:function(t){countValue=t.entities[0].recordcount;countValue<1&&(alert("No Provider Site Resources have been added to this TSA. Provider Site Resources must be added before moving this TSA to Production status."),x=n.getEventArgs().preventDefault(),Xrm.Page.getAttribute("statuscode").setValue(1))},errorCallback:function(n){throw n;}}),Xrm.Page.getAttribute("cvt_type").getValue()!=!0&&(t="<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>",t+="<entity name='cvt_patientresourcegroup'>",t+="<attribute name='cvt_name' alias='recordcount' aggregate='count' />",t+="<filter type='and'>",t+="<condition attribute='cvt_relatedtsaid' operator='eq' uitype='mcs_services' value='"+i+"' />",t+="<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>",t+="<condition attribute='cvt_resourcespecguid' operator='null'/>",t+="<\/filter>",t+="<\/entity>",t+="<\/fetch>",XrmSvcToolkit.fetch({fetchXml:t,async:!1,successCallback:function(t){countValue=t.entities[0].recordcount;countValue>0&&(alert("Some of the Patient Site Resources added to this TSA are still generating their Service Components. Please wait a few moments and try to Save to Production again"),x=n.getEventArgs().preventDefault(),Xrm.Page.getAttribute("statuscode").setValue(1))},errorCallback:function(n){throw n;}})),t="<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>",t+="<entity name='cvt_providerresourcegroup'>",t+="<attribute name='cvt_name' alias='recordcount' aggregate='count' />",t+="<filter type='and'>",t+="<condition attribute='cvt_relatedtsaid' operator='eq' uitype='mcs_services' value='"+i+"' />",t+="<condition attribute= 'statecode' operator='in'><value>0<\/value><value>3<\/value><\/condition>",t+="<condition attribute='cvt_resourcespecguid' operator='null'/>",t+="<\/filter>",t+="<\/entity>",t+="<\/fetch>",XrmSvcToolkit.fetch({fetchXml:t,async:!1,successCallback:function(t){countValue=t.entities[0].recordcount;countValue>0&&(alert("Some of the Provider Site Resources added to this TSA are still generating their Service Components. Please wait a few moments and try to Save to Production again"),x=n.getEventArgs().preventDefault(),Xrm.Page.getAttribute("statuscode").setValue(1))},errorCallback:function(n){throw n;}}))};typeof MCS=="undefined"&&(MCS={});MCS.mcs_TSA_Buttons={};MCS.mcs_TSA_Buttons.EntityName;MCS.mcs_TSA_Buttons.EntityId;MCS.mcs_TSA_Buttons.site=[];MCS.mcs_TSA_Buttons.GroupAppt=!1;MCS.mcs_TSA_Buttons.async=!1;MCS.mcs_TSA_Buttons.patientsite=[];MCS.mcs_TSA_Buttons.buildshowStandardDialog=function(n,t,i,r){var u,l,o,a,v;if(MCS.mcs_TSA_Buttons.gatherParameters(),u=MCS.cvt_Common.getObjectTypeCode(n),MCS.mcs_TSA_Buttons.site!=null){var s=MCS.mcs_TSA_Buttons.site[0].id,c,f="",e="",h="Site";if(i=="Provider"){if(f=MCS.mcs_TSA_Buttons.site,Xrm.Page.getAttribute("cvt_availabletelehealthmodalities").getValue()==917290001&&t=="Resources By Site"){alert("Per Business Rules, you should enter only a Provider or Provider Group on this SFT TSA.");return}}else if(MCS.mcs_TSA_Buttons.GroupAppt==0){if(f=MCS.mcs_TSA_Buttons.patientsite,f==null){alert("A TSA must have a designated Patient Site.");return}}else{if(h="Facility",e=MCS.mcs_TSA_OnLoad.relatedPatientFacilityId,e==null){alert("A Group TSA must have a designated Patient Facility.");return}if(t!="Resource Groups By Site"){alert("Per Business Rules, you should enter Patient Side All Required Groups on this Group TSA.");return}}switch(t){case"Users By Site":c=new CustomView(s,u,"Users By "+h,getUserFetchXml(f,e),getUserLayout(u));break;case"Resource Groups By Site":c=i=="Patient"&&r?new CustomView(s,u,"All Required Resource Groups By "+h,getResourceGroupFetchXml(f,e,!0),getResourceGroupLayout(u)):new CustomView(s,u,"Resource Groups By "+h,getResourceGroupFetchXml(f,e,!1),getResourceGroupLayout(u));break;case"Resources By Site":c=new CustomView(s,u,"Resources By "+h,getResourceFetchXml(f,e),getResourceLayout(u))}return l=new LookupArgsClass,l.customViews=new Array(c),o=Mscrm.CrmUri.create("/_controls/lookup/lookupinfo.aspx"),o.get_query().LookupStyle="multi",o.get_query().browse="0",o.get_query().objecttypes=u,o.get_query().DefaultViewId=s,a={width:600,height:700},v=new Mscrm.CrmDialog(o,l,a.width,a.height),v}};MCS.mcs_TSA_Buttons.gatherParameters=function(){typeof CrmRestKit=="undefined"&&(CrmRestKit=window.parent.CrmRestKit);typeof MCS.cvt_Common=="undefined"&&(MCS=window.parent.MCS);typeof Xrm=="undefined"&&(Xrm=window.parent.Xrm);typeof MCS.mcs_TSA_OnLoad!="undefined"?(MCS.mcs_TSA_Buttons.EntityId=MCS.mcs_TSA_OnLoad.EntityId,MCS.mcs_TSA_Buttons.EntityName=MCS.mcs_TSA_OnLoad.EntityName,MCS.mcs_TSA_Buttons.GroupAppt=MCS.mcs_TSA_OnLoad.GroupAppt,MCS.mcs_TSA_Buttons.site[0]={name:MCS.mcs_TSA_OnLoad.relatedProviderSiteName,id:MCS.mcs_TSA_OnLoad.relatedProviderSiteId},MCS.mcs_TSA_Buttons.patientsite[0]={name:MCS.mcs_TSA_OnLoad.relatedPatientSiteName,id:MCS.mcs_TSA_OnLoad.relatedPatientSiteId}):(MCS.mcs_TSA_Buttons.EntityId=MCS.cvt_MTSA_OnLoad.EntityId,MCS.mcs_TSA_Buttons.EntityName=MCS.cvt_MTSA_OnLoad.EntityName,MCS.mcs_TSA_Buttons.GroupAppt=MCS.cvt_MTSA_OnLoad.GroupAppt,MCS.mcs_TSA_Buttons.site[0]={name:MCS.cvt_MTSA_OnLoad.relatedProviderSiteName,id:MCS.cvt_MTSA_OnLoad.relatedProviderSiteId})};MCS.mcs_TSA_Buttons.refreshGrids=function(n){var t=Xrm.Page.getControl("provgroupsselectall"),i=Xrm.Page.getControl("patgroupsselectall");switch(n){case"Provider":t.refresh();break;case"Patient":i.refresh()}};MCS.mcs_TSA_Buttons.BuildRelationshipPatResourceBySite=function(n){MCS.mcs_TSA_Buttons.BuildRelationshipResourceRunner("mcs_resource","Patient",n)};MCS.mcs_TSA_Buttons.BuildRelationshipPatResourceGroupBySite=function(n){MCS.mcs_TSA_Buttons.BuildRelationshipResourceRunner("mcs_resourcegroup","Patient",n)};MCS.mcs_TSA_Buttons.BuildRelationshipPatTelepresenterBySite=function(n){MCS.mcs_TSA_Buttons.BuildRelationshipUserRunner("Patient",n)};MCS.mcs_TSA_Buttons.BuildRelationshipProvResourceBySite=function(n){MCS.mcs_TSA_Buttons.BuildRelationshipResourceRunner("mcs_resource","Provider",n)};MCS.mcs_TSA_Buttons.BuildRelationshipProvResourceGroupBySite=function(n){MCS.mcs_TSA_Buttons.BuildRelationshipResourceRunner("mcs_resourcegroup","Provider",n)};MCS.mcs_TSA_Buttons.BuildRelationshipProvProviderBySite=function(n){MCS.mcs_TSA_Buttons.BuildRelationshipUserRunner("Provider",n)};MCS.mcs_TSA_Buttons.BuildRelationshipResourceRunner=function(n,t,r){var e="mcs_RelatedSiteId",u=!1,o=1,s="Resources",h="cvt_providerresourcegroup",c=!1,f;t=="Patient"&&(h="cvt_patientresourcegroup");n=="mcs_resourcegroup"&&(u=!0,e="mcs_relatedSiteId",o=0,s="Resource Groups",c=Xrm.Page.getAttribute("cvt_groupappointment").getValue()?!0:!1);f=MCS.mcs_TSA_Buttons.buildshowStandardDialog(n,s+" By Site",t,c);f.setCallbackReference(function(f){var c,a,b,l,v,p,w,s,y;if(f!=null&&f!=undefined){if(c=f,typeof f=="string"&&(c=JSON.parse(f)),c!=null){for(i=0;i<c.items.length;i++)a=c.items[i].id,CrmRestKit.Retrieve(n,a,["mcs_name","mcs_Type",e,"mcs_resourcespecguid","mcs_constraintgroupguid"],MCS.mcs_TSA_Buttons.async).fail(function(n){alert("Failed retrieved"+MCS.cvt_Common.RestError(n))}).done(function(n){b=n.d.mcs_name;l=n.d.mcs_Type.Value;v=u?n.d.mcs_relatedSiteId:n.d.mcs_RelatedSiteId;p=n.d.mcs_resourcespecguid;w=n.d.mcs_constraintgroupguid}),s={cvt_name:c.items[i].name,cvt_TSAResourceType:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:o},cvt_relatedsiteid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:v.Id,LogicalName:v.LogicalName},cvt_resourcespecguid:p,cvt_constraintgroupguid:w},y={__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:a,LogicalName:c.items[i].typename},t=="Patient"?s.cvt_type={__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:l}:s.cvt_Type={__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:l},u?s.cvt_RelatedResourceGroupid=y:s.cvt_RelatedResourceId=y,MCS.mcs_TSA_Buttons.EntityName=="mcs_services"?s.cvt_RelatedTSAid={__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:MCS.mcs_TSA_Buttons.EntityId,LogicalName:MCS.mcs_TSA_Buttons.EntityName}:s.cvt_RelatedMasterTSAId={__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:MCS.mcs_TSA_Buttons.EntityId,LogicalName:MCS.mcs_TSA_Buttons.EntityName},CrmRestKit.Create(h,s,MCS.mcs_TSA_Buttons.async).fail(function(n){l==251920002?alert(MCS.cvt_Common.RestError(n)):alert(MCS.cvt_Common.RestError(n))}).done(function(){});MCS.mcs_TSA_Buttons.refreshGrids(t);r.refresh()}}else return null});f.show()};MCS.mcs_TSA_Buttons.BuildRelationshipUserRunner=function(n,t){var u=2,e="cvt_providerresourcegroup",r,f;n=="Patient"&&(u=3,e="cvt_patientresourcegroup");r={};f=MCS.mcs_TSA_Buttons.buildshowStandardDialog("systemuser","Users By Site",n,!1);f.setCallbackReference(function(f){var o,h,s;if(f!=null&&f!=undefined){if(o=f,typeof f=="string"&&(o=JSON.parse(f)),o!=null){for(i=0;i<o.items.length;i++)h=o.items[i].id,CrmRestKit.Retrieve("SystemUser",h,["cvt_site"],MCS.mcs_TSA_Buttons.async).fail(function(){}).done(function(n){s=n.d.cvt_site}),r=n=="Patient"||MCS.mcs_TSA_Buttons.EntityName=="mcs_services"?{cvt_name:o.items[i].name,cvt_TSAResourceType:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:u},cvt_RelatedTSAid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:MCS.mcs_TSA_Buttons.EntityId,LogicalName:MCS.mcs_TSA_Buttons.EntityName},cvt_RelatedUserId:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:o.items[i].id,LogicalName:o.items[i].typename},cvt_relatedsiteid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:s.Id,LogicalName:s.LogicalName}}:{cvt_name:o.items[i].name,cvt_TSAResourceType:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"},Value:u},cvt_RelatedMasterTSAId:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:MCS.mcs_TSA_Buttons.EntityId,LogicalName:MCS.mcs_TSA_Buttons.EntityName},cvt_RelatedUserId:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:o.items[i].id,LogicalName:o.items[i].typename},cvt_relatedsiteid:{__metadata:{type:"Microsoft.Crm.Sdk.Data.Services.EntityReference"},Id:s.Id,LogicalName:s.LogicalName}},CrmRestKit.Create(e,r,MCS.mcs_TSA_Buttons.async);MCS.mcs_TSA_Buttons.refreshGrids(n);t.refresh()}}else return null});f.show()};typeof MCS=="undefined"&&(MCS={});typeof MCS.TSA_Ribbon=="undefined"&&(MCS.TSA_Ribbon={});process=[[],[],[],[]];MCS.TSA_Ribbon.CreateNewServiceActivity=function(){var t=MCS.cvt_Common.checkNull("cvt_relatedpatientsiteid"),n;t!=null&&(t=t[0]);n=MCS.cvt_Common.checkNull("cvt_relatedprovidersiteid");n!=null&&(n=n[0]);var s=MCS.cvt_Common.checkNull("cvt_servicetype"),h=MCS.cvt_Common.checkNull("cvt_servicesubtype"),c=MCS.cvt_Common.checkNull("mcs_relatedserviceid"),i=MCS.cvt_Common.checkNull("mcs_name"),r=MCS.cvt_Common.checkNull("cvt_groupappointment"),u=MCS.cvt_Common.checkNull("cvt_availabletelehealthmodalities"),f=MCS.cvt_Common.checkNull("cvt_type"),e=MCS.cvt_Common.checkNull("cvt_schedulinginstructions"),o={id:Xrm.Page.data.entity.getId(),name:i};MCS.TSA_Ribbon.openNewServiceAppointment(r,n,o,t,f,u,e)};MCS.TSA_Ribbon.openNewServiceAppointment=function(n,t,i,r,u,f,e){var s,c,h,o;n=n==null?!1:n;u=u==null?!1:u;SFT=f==917290001;typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined"?(s={formid:"75ec0e60-421b-4e71-8f5d-d8de7e0aa04e",mcs_groupappointment:n,mcs_relatedtsa:i.id,mcs_relatedtsaname:i.name,cvt_type:u,cvt_telehealthmodality:SFT,cvt_schedulinginstructions:e},t!=null&&(s.mcs_relatedprovidersite=t.id,s.mcs_relatedprovidersitename=t.name),r!=null&&(s.mcs_relatedsite=r.id,s.mcs_relatedsitename=r.name),Xrm.Utility.openEntityForm("serviceappointment",null,s)):(c="location=no,menubar=no,status=no,toolbar=no,resizable=yes",h=["formid=75ec0e60-421b-4e71-8f5d-d8de7e0aa04e","mcs_groupappointment="+n,"mcs_relatedtsa="+i.id,"mcs_relatedtsaname="+i.name,"cvt_type="+u,"cvt_telehealthmodality="+SFT,"cvt_schedulinginstructions="+e],t!=null&&h.concat[("mcs_relatedprovidersite="+t.id,"mcs_relatedprovidersitename="+t.name)],r!=null&&h.concat[("mcs_relatedsite="+r.id,"mcs_relatedsitename="+r.name)],o=Xrm.Page.context.getClientUrl(),o.match(/\/$/)&&(o=o.substring(0,o.length-1)),typeof Xrm.Page.context.getClientUrl!="undefined"&&(o=Xrm.Page.context.getClientUrl()),window.open(o+"/main.aspx?etn=serviceappointment&pagetype=entityrecord&extraqs="+encodeURIComponent(h.join("&")),"_blank",c,!1))};MCS.TSA_Ribbon.buildProcess=function(){var i=Xrm.Page.getAttribute("cvt_servicetype").getValue(),c,l,t;if(i==null){alert("Specialty should always be populated");return}var n=0,u=null,f=null,e=null,v=null,o=null,s=null,h=null,y=null,r=Xrm.Page.getAttribute("cvt_type").getValue()==!0||Xrm.Page.getAttribute("cvt_servicescope").getValue()==917290001,a=Xrm.Page.getAttribute("cvt_type").getValue()==!0;if(process[0][n]=1,process[1][n]="Draft",process[2][n]=null,process[3][n]=null,n++,c="(cvt_ServiceType/Id eq (Guid'"+i[0].id+"') or cvt_ServiceType/Id eq null) and cvt_Type ne null and (cvt_Facility/Id eq (Guid'"+ProFacility.Id+"')",c+=r?")":" or cvt_Facility/Id eq (Guid'"+PatFacility.Id+"'))",CrmRestKit.ByQueryAll("Team",["TeamId","cvt_Type","cvt_ServiceType","cvt_Facility"],c,!1).fail(function(n){alert(MCS.cvt_Common.RestError(n))}).done(function(n){var i,t;for(i in n)if(t=n[i],ProFacility.Id==t.cvt_Facility.Id)switch(t.cvt_Type.Value){case 91729e4:e=t.TeamId;break;case 917290001:t.cvt_ServiceType!=null&&(f=t.TeamId);break;case 917290002:u=t.TeamId;break;case 917290004:v=t.TeamId}else switch(t.cvt_Type.Value){case 91729e4:h=t.TeamId;break;case 917290001:t.cvt_ServiceType!=null&&(s=t.TeamId);break;case 917290002:o=t.TeamId;break;case 917290004:y=t.TeamId}}),l="The following Teams are missing:",t=l,e==null&&(t+="\n-Provider FTC Team for "+ProFacility.Name),a||(f==null&&(t+="\n-Provider Service Chief Team for "+ProFacility.Name+" "+i[0].name),u==null&&(t+="\n-Provider Chief of Staff Team for "+ProFacility.Name)),r||(h==null&&(t+="\n-Patient FTC Team for "+PatFacility.Name),s==null&&(t+="\n-Patient Service Chief Team for "+PatFacility.Name+" "+i[0].name),o==null&&(t+="\n-Patient Chief of Staff Team for "+PatFacility.Name)),t!=l)return alert(t+"\n\nPlease contact your Facility Telehealth Coordinator to get this team set up"),!1;r||(process[0][n]=917290002,process[1][n]="Patient Site FTC",process[2][n]=h,process[3][n]="195750DF-B5DF-4A5B-B3FF-A29C280BC02A",n++);process[0][n]=91729e4;process[1][n]="Provider Site FTC";process[2][n]=e;process[3][n]="AC75C046-5CE4-4981-BD20-FDD95EEEF641";n++;a||(process[0][n]=917290001,process[1][n]="Provider Site Service Chief",process[2][n]=f,process[3][n]="EB62D141-FA4A-4461-A6CA-E5DA9BE17339",n++,process[0][n]=917290004,process[1][n]="Provider Site Chief of Staff",process[2][n]=u,process[3][n]="BB6BF3C9-41DB-4184-B18F-6A78B8BD2CF9",n++);r?(process[0][n-1]=25192e4,process[3][n-1]=null):(process[0][n]=917290005,process[1][n]="Patient Site Service Chief",process[2][n]=s,process[3][n]="8423B567-1FAB-461D-ACB6-59CEDDA7012A",n++,process[0][n]=25192e4,process[1][n]="Patient Site Chief of Staff",process[2][n]=o,process[3][n]=null,n++)};MCS.TSA_Ribbon.checkPriorTeams=function(n){var t=process[0].indexOf(n),i;if(t==0)return!1;if(i=MCS.TSA_Ribbon.checkTeamMembership(process[2][t],Xrm.Page.context.getUserId()),i)return alert("The "+process[1][t]+" Team (your team) has already approved this TSA.  Please see the notes to view the previous approvals."),!0;MCS.TSA_Ribbon.checkPriorTeams(process[0][t-1])};MCS.TSA_Ribbon.checkApprover=function(n){var t=!1,i=process[0].indexOf(n),r;return t=MCS.TSA_Ribbon.checkTeamMembership(process[2][i+1],Xrm.Page.context.getUserId()),t||MCS.TSA_Ribbon.checkPriorTeams(n)||(r="Only members of the "+process[1][i+1]+" Approval Group can perform this approval",alert(r)),t};MCS.TSA_Ribbon.checkDeny=function(n){var t=!1,i=process[0].indexOf(n),r;return t=MCS.TSA_Ribbon.checkTeamMembership(process[2][i+1],Xrm.Page.context.getUserId()),t||MCS.TSA_Ribbon.checkPriorTeams(n)||(r="Only members of the "+process[1][i+1]+" Approval Group can perform this denial",alert(r)),t};MCS.TSA_Ribbon.getFacilities=function(){var r=Xrm.Page.getAttribute("cvt_relatedprovidersiteid").getValue()[0].id,u=MCS.mcs_TSA_OnChange.QueryFacility(r),t=Xrm.Page.getAttribute("cvt_groupappointment").getValue()==1,n,i;(ProFacility=u,(!t||Xrm.Page.getAttribute("cvt_patientfacility").getValue()!=null)&&(t||Xrm.Page.getAttribute("cvt_relatedpatientsiteid").getValue()!=null))&&(n=t?Xrm.Page.getAttribute("cvt_patientfacility").getValue()[0]:MCS.mcs_TSA_OnChange.QueryFacility(Xrm.Page.getAttribute("cvt_relatedpatientsiteid").getValue()[0].id),i={Id:n.Id==null?n.id:n.Id,Name:n.Name==null?n.name:n.Name},PatFacility=i)};MCS.TSA_Ribbon.checkTeamMembership=function(n,t){var i=!1,r,u;return n==null?!1:(r="SystemUserId eq (Guid' "+t+"') and TeamId eq (Guid' "+n+"')",u=CrmRestKit.ByQuery("TeamMembership",["TeamId"],r,!1),u.fail(function(){}).done(function(n){n&&n.d.results&&(i=n.d.results.length>0)}),i)};MCS.TSA_Ribbon.runPatApprovalWorkflow=function(){var n=Xrm.Page.getAttribute("statuscode");n.getValue()==1&&MCS.TSA_Ribbon.runApproveTSA()};MCS.TSA_Ribbon.runApproveTSA=function(){var t,n,r,u,f,i;(MCS.TSA_Ribbon.getFacilities(),MCS.TSA_Ribbon.buildProcess()!=!1)&&(t=Xrm.Page.getAttribute("statuscode"),n=process[0].indexOf(t.getValue()),n!=-1)&&(r=process[1][n+1],u=MCS.TSA_Ribbon.checkApprover(t.getValue()),u)&&(f=typeof process[1][n+2]=="undefined"?confirm("Click OK to Approve this TSA and put it into Production"):confirm("Click OK to Approve this TSA and automatically route it to the "+process[1][n+2]+" Approval Group"),f?(i={},MCS.TSA_Ribbon.runRibbonWorkflow(process[3][n+1]),i.statuscode={Value:process[0][n+1]},t.setValue(process[0][n+1]),MCS.TSA_Ribbon.CreateNote("Approved",null,"Approved by "+r),CrmRestKit.Update("mcs_services",Xrm.Page.data.entity.getId(),i,!0).fail(function(n){alert(MCS.cvt_Common.RestError(n))}).done(),Xrm.Page.ui.controls.get("statuscode").setDisabled(!0)):alert("This TSA will remain in your queue until you approve or deny it."))};MCS.TSA_Ribbon.CreateNote=function(n,t,i){var f="",r,u,e;CrmRestKit.Retrieve("SystemUser",Xrm.Page.context.getUserId(),["FullName"],!1).fail().done(function(n){f=n.d.FullName});r={};r.LogicalName="mcs_services";r.Id=Xrm.Page.data.entity.getId();u="This TSA has been "+n;t!=null&&(u+=" because: "+t);u+=". New Status = "+i;e={Subject:n+" by "+f,ObjectId:r,NoteText:u};CrmRestKit.Create("Annotation",e,!0).fail(function(n){alert(n.responseText)}).done()};MCS.TSA_Ribbon.DenyTSA=function(){var n,i,t;(MCS.TSA_Ribbon.getFacilities(),n=Xrm.Page.getAttribute("statuscode"),MCS.TSA_Ribbon.buildProcess()!=!1)&&(i=MCS.TSA_Ribbon.checkDeny(n.getValue()),i&&(t=prompt("Enter Denial Reason and Click OK to Deny this TSA"),t!=null?(MCS.TSA_Ribbon.runRibbonWorkflow("cf2bc300-a19f-440d-9055-dc8a9a55e102"),n.setValue(917290003),MCS.TSA_Ribbon.CreateNote("Denied",t,"Denied"),Xrm.Page.ui.controls.get("statuscode").setDisabled(!0)):alert("This TSA will remain in your queue until you approve or deny it.")))};MCS.TSA_Ribbon.runRibbonWorkflow=function(n){MCS.GlobalFunctions.runWorkflow(Xrm.Page.data.entity.getId(),n,MCS.GlobalFunctions.runWorkflowResponse)};typeof MCS=="undefined"&&(MCS={});MCS.mcs_Provider_Resource={};MCS.mcs_Provider_Resource.relatedProviderSiteId;MCS.mcs_Provider_Resource.relatedProviderSiteName;MCS.mcs_Provider_Resource.EntityId;MCS.mcs_Provider_Resource.EntityName;MCS.mcs_Provider_Resource.TSAName;MCS.mcs_Provider_Resource.MTSAName;MCS.mcs_Provider_Resource.openNewmcs_resourcegroup=function(n,t,i,r,u,f){var e;if(typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined")e={},e.mcs_relatedsiteid=n,e.mcs_relatedsiteidname=t,e.mcs_createproviderrg=i,e.mcs_createpatientrg=r,e.mcs_tsaguid=u,e.cvt_mastertsaguid=f,Xrm.Utility.openEntityForm("mcs_resourcegroup",null,e);else{var s=["mcs_relatedsiteid="+n,"mcs_relatedsiteidname="+t,"mcs_createproviderrg="+i,"mcs_createpatientrg="+r,"mcs_tsaguid="+u,"cvt_mastertsaguid="+f],o=Xrm.Page.context.getServerUrl();o.match(/\/$/)&&(o=o.substring(0,o.length-1));typeof Xrm.Page.context.getClientUrl!="undefined"&&(o=Xrm.Page.context.getClientUrl());window.open(o+"/main.aspx?etn=mcs_resourcegroup&pagetype=entityrecord&extraqs="+encodeURIComponent(s.join("&")),"_blank","location=no,menubar=no,status=no,toolbar=no,resizable=yes",!1)}};MCS.mcs_Provider_Resource.openNewmcs_resource=function(n,t,i,r,u,f){var e;if(typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined")e={},e.mcs_relatedsiteid=n,e.mcs_relatedsiteidname=t,e.mcs_createpatientr=u,e.mcs_createproviderr=f,e.mcs_tsaguid=i,e.cvt_mastertsaguid=r,Xrm.Utility.openEntityForm("mcs_resource",null,e);else{var s=["mcs_relatedsiteid="+n,"mcs_relatedsiteidname="+t,"mcs_createpatientr="+u,"mcs_createproviderr="+f,"mcs_tsaguid="+i,"cvt_mastertsaguid="+r],o=Xrm.Page.context.getServerUrl();o.match(/\/$/)&&(o=o.substring(0,o.length-1));typeof Xrm.Page.context.getClientUrl!="undefined"&&(o=Xrm.Page.context.getClientUrl());window.open(o+"/main.aspx?etn=mcs_resource&pagetype=entityrecord&extraqs="+encodeURIComponent(s.join("&")),"_blank","location=no,menubar=no,status=no,toolbar=no,resizable=yes",!1)}};MCS.mcs_Provider_Resource.openNewcvt_providerresourcegroup=function(n,t,i,r,u,f,e){var o,c,h,s;typeof MCS.mcs_TSA_OnLoad!="undefined"?EntityName=MCS.mcs_TSA_OnLoad.EntityName:typeof MCS.cvt_MTSA_OnLoad!="undefined"?EntityName=MCS.cvt_MTSA_OnLoad.EntityName:typeof window.parent.MCS!="undefined"&&(typeof window.parent.MCS.mcs_TSA_OnLoad!="undefined"?EntityName=window.parent.MCS.mcs_TSA_OnLoad.EntityName:typeof window.parent.MCS.cvt_MTSA_OnLoad!="undefined"&&(EntityName=window.parent.MCS.cvt_MTSA_OnLoad.EntityName));typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined"?(o={},o.cvt_relatedsiteid=n,o.cvt_relatedsiteidname=t,EntityName=="cvt_mastertsa"&&(o.cvt_relatedmastertsaid=i,o.cvt_relatedmastertsaidname=r),EntityName=="mcs_services"&&(o.cvt_relatedtsaid=u,o.cvt_relatedtsaidname=f),o.cvt_capacityrequired=e,Xrm.Utility.openEntityForm("cvt_providerresourcegroup",null,o)):(c="location=no,menubar=no,status=no,toolbar=no,resizable=yes",h=[],EntityName=="cvt_mastertsa"&&(h=["cvt_relatedsiteid="+n,"cvt_relatedsiteidname="+t,"cvt_relatedmastertsaid="+i,"cvt_relatedmastertsaidname="+r,"cvt_capacityrequired="+e]),EntityName=="mcs_services"&&(h=["cvt_relatedsiteid="+n,"cvt_relatedsiteidname="+t,"cvt_relatedtsaid="+u,"cvt_relatedtsaidname="+f,"cvt_capacityrequired="+e]),s=Xrm.Page.context.getServerUrl(),s.match(/\/$/)&&(s=s.substring(0,s.length-1)),typeof Xrm.Page.context.getClientUrl!="undefined"&&(s=Xrm.Page.context.getClientUrl()),window.open(s+"/main.aspx?etn=cvt_providerresourcegroup&pagetype=entityrecord&extraqs="+encodeURIComponent(h.join("&")),"_blank",c,!1))};MCS.mcs_Provider_Resource.QuickCreateProviderResourceGroup=function(){MCS.mcs_Provider_Resource.gatherParameters();MCS.mcs_Provider_Resource.EntityName=="mcs_services"?MCS.mcs_Provider_Resource.openNewmcs_resourcegroup(MCS.mcs_Provider_Resource.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName,!0,!1,MCS.mcs_Provider_Resource.EntityId,null):MCS.mcs_Provider_Resource.openNewmcs_resourcegroup(MCS.mcs_Provider_Resource.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName,!0,!1,null,MCS.mcs_Provider_Resource.EntityId)};MCS.mcs_Provider_Resource.QuickCreateProviderResource=function(){MCS.mcs_Provider_Resource.gatherParameters();MCS.mcs_Provider_Resource.EntityName=="mcs_services"?MCS.mcs_Provider_Resource.openNewmcs_resource(MCS.mcs_Provider_Resource.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName,MCS.mcs_Provider_Resource.EntityId,null,!1,!0):MCS.mcs_Provider_Resource.openNewmcs_resource(MCS.mcs_Provider_Resource.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName,null,MCS.mcs_Provider_Resource.EntityId,!1,!0)};MCS.mcs_Provider_Resource.AddProviderResource=function(){MCS.mcs_Provider_Resource.gatherParameters();MCS.mcs_Provider_Resource.EntityName=="mcs_services"?MCS.mcs_Provider_Resource.openNewcvt_providerresourcegroup(MCS.mcs_Provider_Resource.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName,null,null,MCS.mcs_Provider_Resource.EntityId,MCS.mcs_Provider_Resource.TSAName,1):MCS.mcs_Provider_Resource.openNewcvt_providerresourcegroup(MCS.mcs_Provider_Resource.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName,MCS.mcs_Provider_Resource.EntityId,MCS.mcs_Provider_Resource.MTSAName,null,null,1)};MCS.mcs_Provider_Resource.gatherParameters=function(){typeof MCS.cvt_Common=="undefined"&&(MCS=window.parent.MCS);typeof MCS.mcs_TSA_OnLoad!="undefined"?(MCS.mcs_Provider_Resource.relatedProviderSiteId=MCS.mcs_TSA_OnLoad.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName=MCS.mcs_TSA_OnLoad.relatedProviderSiteName,MCS.mcs_Provider_Resource.EntityId=MCS.mcs_TSA_OnLoad.EntityId,MCS.mcs_Provider_Resource.EntityName=MCS.mcs_TSA_OnLoad.EntityName,MCS.mcs_Provider_Resource.TSAName=MCS.mcs_TSA_OnLoad.TSAName):(MCS.mcs_Provider_Resource.relatedProviderSiteId=MCS.cvt_MTSA_OnLoad.relatedProviderSiteId,MCS.mcs_Provider_Resource.relatedProviderSiteName=MCS.cvt_MTSA_OnLoad.relatedProviderSiteName,MCS.mcs_Provider_Resource.EntityId=MCS.cvt_MTSA_OnLoad.EntityId,MCS.mcs_Provider_Resource.EntityName=MCS.cvt_MTSA_OnLoad.EntityName,MCS.mcs_Provider_Resource.MTSAName=MCS.cvt_MTSA_OnLoad.MTSAName)};typeof MCS=="undefined"&&(MCS={});MCS.mcs_Patient_Resource={};MCS.mcs_Patient_Resource.relatedPatientSiteId;MCS.mcs_Patient_Resource.relatedPatientSiteName;MCS.mcs_Patient_Resource.EntityId;MCS.mcs_Patient_Resource.TSAName;MCS.mcs_Patient_Resource.GroupAppt;MCS.mcs_Patient_Resource.openNewmcs_resourcegroup=function(n,t,i,r,u){var f;if(typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined")f={},f.mcs_relatedsiteid=n,f.mcs_relatedsiteidname=t,f.mcs_createproviderrg=i,f.mcs_createpatientrg=r,f.mcs_tsaguid=u,Xrm.Utility.openEntityForm("mcs_resourcegroup",null,f);else{var o=["mcs_relatedsiteid="+n,"mcs_relatedsiteidname="+t,"mcs_createproviderrg="+i,"mcs_createpatientrg="+r,"mcs_tsaguid="+u],e=Xrm.Page.context.getServerUrl();e.match(/\/$/)&&(e=e.substring(0,e.length-1));typeof Xrm.Page.context.getClientUrl!="undefined"&&(e=Xrm.Page.context.getClientUrl());window.open(e+"/main.aspx?etn=mcs_resourcegroup&pagetype=entityrecord&extraqs="+encodeURIComponent(o.join("&")),"_blank","location=no,menubar=no,status=no,toolbar=no,resizable=yes",!1)}};MCS.mcs_Patient_Resource.openNewmcs_resource=function(n,t,i,r,u){var f;if(typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined")f={},f.mcs_relatedsiteid=n,f.mcs_relatedsiteidname=t,f.mcs_tsaguid=i,f.mcs_createpatientr=r,f.mcs_createproviderr=u,Xrm.Utility.openEntityForm("mcs_resource",null,f);else{var o=["mcs_relatedsiteid="+n,"mcs_relatedsiteidname="+t,"mcs_tsaguid="+i,"mcs_createpatientr="+r,"mcs_createproviderr="+u],e=Xrm.Page.context.getServerUrl();e.match(/\/$/)&&(e=e.substring(0,e.length-1));typeof Xrm.Page.context.getClientUrl!="undefined"&&(e=Xrm.Page.context.getClientUrl());window.open(e+"/main.aspx?etn=mcs_resource&pagetype=entityrecord&extraqs="+encodeURIComponent(o.join("&")),"_blank","location=no,menubar=no,status=no,toolbar=no,resizable=yes",!1)}};MCS.mcs_Patient_Resource.openNewcvt_patientresourcegroupTSA=function(n,t,i,r,u){var f;if(typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined")f={},f.cvt_relatedsiteid=n,f.cvt_relatedsiteidname=t,f.cvt_capacityrequired=i,f.cvt_relatedtsaid=r,f.cvt_relatedtsaidname=u,Xrm.Utility.openEntityForm("cvt_patientresourcegroup",null,f);else{var o=["cvt_relatedsiteid="+n,"cvt_relatedsiteidname="+t,"cvt_capacityrequired="+i,"cvt_relatedtsaid="+r,"cvt_relatedtsaidname="+u],e=Xrm.Page.context.getServerUrl();e.match(/\/$/)&&(e=e.substring(0,e.length-1));typeof Xrm.Page.context.getClientUrl!="undefined"&&(e=Xrm.Page.context.getClientUrl());window.open(e+"/main.aspx?etn=cvt_patientresourcegroup&pagetype=entityrecord&extraqs="+encodeURIComponent(o.join("&")),"_blank","location=no,menubar=no,status=no,toolbar=no,resizable=yes",!1)}};MCS.mcs_Patient_Resource.openNewcvt_patientresourcegroupGroupAppt=function(n,t,i){var r;if(typeof Xrm!="undefined"&&typeof Xrm.Utility!="undefined")r={},r.formid="fdb4a4ff-ba87-49d4-8f8e-1d457cd2e278",r.cvt_capacityrequired=n,r.cvt_relatedtsaid=t,r.cvt_relatedtsaidname=i,Xrm.Utility.openEntityForm("cvt_patientresourcegroup",null,r);else{var f=["formid=fdb4a4ff-ba87-49d4-8f8e-1d457cd2e278","cvt_capacityrequired="+n,"cvt_relatedtsaid="+t,"cvt_relatedtsaidname="+i],u=Xrm.Page.context.getServerUrl();u.match(/\/$/)&&(u=u.substring(0,u.length-1));typeof Xrm.Page.context.getClientUrl!="undefined"&&(u=Xrm.Page.context.getClientUrl());window.open(u+"/main.aspx?etn=cvt_patientresourcegroup&pagetype=entityrecord&extraqs="+encodeURIComponent(f.join("&")),"_blank","location=no,menubar=no,status=no,toolbar=no,resizable=yes",!1)}};MCS.mcs_Patient_Resource.QuickCreatePatientResource=function(){MCS.mcs_Patient_Resource.gatherParameters();MCS.mcs_Patient_Resource.openNewmcs_resource(MCS.mcs_Patient_Resource.relatedPatientSiteId,MCS.mcs_Patient_Resource.relatedPatientSiteName,MCS.mcs_Patient_Resource.EntityId,!0,!1)};MCS.mcs_Patient_Resource.QuickCreatePatientResourceGroup=function(){MCS.mcs_Patient_Resource.gatherParameters();MCS.mcs_Patient_Resource.openNewmcs_resourcegroup(MCS.mcs_Patient_Resource.relatedPatientSiteId,MCS.mcs_Patient_Resource.relatedPatientSiteName,!1,!0,MCS.mcs_Patient_Resource.EntityId)};MCS.mcs_Patient_Resource.AddPatientResource=function(){MCS.mcs_Patient_Resource.gatherParameters();MCS.mcs_Patient_Resource.GroupAppt==0?MCS.mcs_Patient_Resource.openNewcvt_patientresourcegroupTSA(MCS.mcs_Patient_Resource.relatedPatientSiteId,MCS.mcs_Patient_Resource.relatedPatientSiteName,1,MCS.mcs_Patient_Resource.EntityId,MCS.mcs_Patient_Resource.TSAName):MCS.mcs_Patient_Resource.openNewcvt_patientresourcegroupGroupAppt(1,MCS.mcs_Patient_Resource.EntityId,MCS.mcs_Patient_Resource.TSAName)};MCS.mcs_Patient_Resource.gatherParameters=function(){typeof MCS.cvt_Common=="undefined"&&(MCS=window.parent.MCS);MCS.mcs_Patient_Resource.relatedPatientSiteId=MCS.mcs_TSA_OnLoad.relatedPatientSiteId;MCS.mcs_Patient_Resource.relatedPatientSiteName=MCS.mcs_TSA_OnLoad.relatedPatientSiteName;MCS.mcs_Patient_Resource.EntityId=MCS.mcs_TSA_OnLoad.EntityId;MCS.mcs_Patient_Resource.TSAName=MCS.mcs_TSA_OnLoad.TSAName;MCS.mcs_Patient_Resource.GroupAppt=MCS.mcs_TSA_OnLoad.GroupAppt};