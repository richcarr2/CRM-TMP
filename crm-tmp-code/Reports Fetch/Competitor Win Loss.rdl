<?xml version="1.0"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"><DataSources><DataSource Name="CRM"><ConnectionProperties><IntegratedSecurity>true</IntegratedSecurity><ConnectString>data source=localhost;initial catalog=Adventure_Works_Cycle_MSCRM</ConnectString><DataProvider>SQL</DataProvider></ConnectionProperties><rd:DataSourceID>bd1301de-68ad-4451-8159-73edf1a55fea</rd:DataSourceID></DataSource></DataSources><BottomMargin>0.5in</BottomMargin><RightMargin>0.5in</RightMargin><PageWidth>11in</PageWidth><ReportParameters><ReportParameter Name="CRM_FormatDate"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><DataSetReference><DataSetName>NumberandCurrencyFormat</DataSetName><ValueField>DateFormat</ValueField></DataSetReference></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_FormatDate</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_FormatTime"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><DataSetReference><DataSetName>NumberandCurrencyFormat</DataSetName><ValueField>TimeFormat</ValueField></DataSetReference></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_FormatTime</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_FullName"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><DataSetReference><DataSetName>UserInfo</DataSetName><ValueField>fullname</ValueField></DataSetReference></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_FullName</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_SortField"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><Values><Value>Competitor</Value></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_SortField</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_SortDirection"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><Values><Value>Descending</Value></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_SortDirection</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_FilterText"><DataType>String</DataType><Nullable>true</Nullable><AllowBlank>true</AllowBlank><Prompt>CRM_FilterText</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_StateCode"><DataType>Integer</DataType><Nullable>true</Nullable><DefaultValue><Values><Value>1</Value></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_StateCode</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_Competitor"><DataType>String</DataType><Nullable>true</Nullable><AllowBlank>true</AllowBlank><Prompt>CRM_Competitor</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_OppList"><DataType>String</DataType><Nullable>true</Nullable><AllowBlank>true</AllowBlank><Prompt>CRM_OppList</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_FilteredOpportunity"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><Values><Value>select  [opportunity0].*  from  FilteredOpportunity as "opportunity0" join (select top 1 dbo.fn_LastXYear(GetUTCDate(), 1) as modifiedon1,GetUTCDate() as modifiedon2 order by modifiedon1,modifiedon2) as modifiedondtc on 1=1  where  ( opportunity0.modifiedonutc &gt;= modifiedondtc.modifiedon1 and opportunity0.modifiedonutc &lt;= modifiedondtc.modifiedon2 )</Value></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_FilteredOpportunity</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_FilteredCompetitor"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><Values><Value>select  [competitor0].*  from  FilteredCompetitor as "competitor0"</Value></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_FilteredCompetitor</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_URL"><DataType>String</DataType><Nullable>true</Nullable><AllowBlank>true</AllowBlank><Prompt>CRM_URL</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_NumberLanguageCode"><DataType>String</DataType><DefaultValue><DataSetReference><DataSetName>NumberandCurrencyFormat</DataSetName><ValueField>NumberLanguageCode</ValueField></DataSetReference></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_NumberLanguageCode</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_CalendarType"><DataType>String</DataType><DefaultValue><DataSetReference><DataSetName>NumberandCurrencyFormat</DataSetName><ValueField>CalendarType</ValueField></DataSetReference></DefaultValue><Prompt>CRM_CalendarType</Prompt><Hidden>true</Hidden></ReportParameter><ReportParameter Name="CRM_UserTimeZoneName"><DataType>String</DataType><DefaultValue><Values><Value>Central Standard Time</Value></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>CRM_UserTimeZoneName</Prompt><Hidden>true</Hidden></ReportParameter></ReportParameters><rd:DrawGrid>true</rd:DrawGrid><InteractiveWidth>8.5in</InteractiveWidth><rd:GridSpacing>0.03125in</rd:GridSpacing><rd:SnapToGrid>true</rd:SnapToGrid><Body><ReportItems><Table Name="table1_Competitor"><DataElementOutput>Output</DataElementOutput><NoRows>=ReportItems!txtNoData.Value</NoRows><Footer><TableRows><TableRow><TableCells><TableCell><ReportItems><Textbox Name="textbox17"><rd:DefaultName>textbox17</rd:DefaultName><ZIndex>14</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox6x"><ZIndex>13</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox18x"><ZIndex>12</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox4x"><ZIndex>11</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox19"><rd:DefaultName>textbox19</rd:DefaultName><ZIndex>10</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox14x"><ZIndex>9</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox7x"><ZIndex>8</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox23x"><ZIndex>7</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox3"><rd:DefaultName>textbox3</rd:DefaultName><ZIndex>6</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox26"><ZIndex>5</ZIndex><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value /></Textbox></ReportItems></TableCell></TableCells><Height>0.03125in</Height></TableRow></TableRows></Footer><DataSetName>DSCompetitor</DataSetName><Top>1.45in</Top><ZIndex>2</ZIndex><Visibility><Hidden>=IIF(IsNothing( Parameters!CRM_OppList.Value), false, true)</Hidden></Visibility><Width>8.98002in</Width><Details><TableRows><TableRow><TableCells><TableCell><ColSpan>2</ColSpan><ReportItems><Textbox Name="txtCompValue1"><ZIndex>4</ZIndex><Action><Hyperlink>=IIF(IsNothing(Parameters!CRM_URL.Value),Nothing,Parameters!CRM_URL.Value &amp; "?ID={"&amp; Fields!competitorid.Value.ToString()&amp;"}&amp;OTC=123")</Hyperlink></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>Solid</Left></BorderStyle><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontSize>8pt</FontSize><BorderColor><Default>LightGrey</Default></BorderColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Fields!Competitor.Value</Value></Textbox></ReportItems></TableCell><TableCell><ColSpan>2</ColSpan><ReportItems><Textbox Name="txtOpenOppValue1"><ZIndex>3</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss Details</ReportName><Parameters><Parameter Name="CRM_Competitor"><Value>=Fields!competitorid.Value.ToString()</Value></Parameter><Parameter Name="CRM_StateCode"><Value>0</Value></Parameter><Parameter Name="CRM_OppList"><Value>OppList</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>Solid</Left></BorderStyle><TextAlign>Center</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontSize>8pt</FontSize><BorderColor><Default>LightGrey</Default></BorderColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Fields!openopp.Value</Value></Textbox></ReportItems></TableCell><TableCell><ColSpan>2</ColSpan><ReportItems><Textbox Name="txtCloseOppVal1"><ZIndex>2</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss Details</ReportName><Parameters><Parameter Name="CRM_Competitor"><Value>=Fields!competitorid.Value.ToString()</Value></Parameter><Parameter Name="CRM_StateCode"><Value>1</Value></Parameter><Parameter Name="CRM_OppList"><Value>Opplist</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>Solid</Left></BorderStyle><TextAlign>Center</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontSize>8pt</FontSize><BorderColor><Default>LightGrey</Default></BorderColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Fields!closeopp.Value</Value></Textbox></ReportItems></TableCell><TableCell><ColSpan>2</ColSpan><ReportItems><Textbox Name="txtOppWonValuep1"><ZIndex>1</ZIndex><Style><BorderStyle><Bottom>Solid</Bottom><Left>Solid</Left></BorderStyle><TextAlign>Center</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontSize>8pt</FontSize><Format>P</Format><BorderColor><Default>LightGrey</Default></BorderColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=IIF( Fields!closeopp.Value = 0 , Fields!wonopp.Value , Fields!wonopp.Value/ Fields!closeopp.Value)</Value></Textbox></ReportItems></TableCell><TableCell><ColSpan>2</ColSpan><ReportItems><Textbox Name="txtOppClosevaluep1"><Style><BorderStyle><Bottom>Solid</Bottom><Left>Solid</Left></BorderStyle><TextAlign>Center</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontSize>8pt</FontSize><Format>P</Format><BorderColor><Default>LightGrey</Default></BorderColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=IIF( Fields!closeopp.Value = 0, Fields!LostOpp.Value , Fields!LostOpp.Value/Fields!closeopp.Value)</Value></Textbox></ReportItems></TableCell></TableCells><Height>0.25in</Height></TableRow></TableRows><Sorting><SortBy><SortExpression>=IIF(Parameters!CRM_SortDirection.Value="Ascending", Fields(Parameters!CRM_SortField.Value).Value, "")</SortExpression><Direction>Ascending</Direction></SortBy><SortBy><SortExpression>=IIF(Parameters!CRM_SortDirection.Value="Descending", Fields(Parameters!CRM_SortField.Value).Value, "")</SortExpression><Direction>Descending</Direction></SortBy></Sorting></Details><Header><TableRows><TableRow><TableCells><TableCell><ReportItems><Textbox Name="txtCompetitor"><ZIndex>24</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss</ReportName><Parameters><Parameter Name="CRM_SortField"><Value>="Competitor"</Value></Parameter><Parameter Name="CRM_SortDirection"><Value>=IIF(Parameters!CRM_SortField.Value ="Competitor" And Parameters!CRM_SortDirection.Value = "Ascending", "Descending", "Ascending")</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><TextAlign>Left</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>Competitor</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox1"><rd:DefaultName>textbox1</rd:DefaultName><ZIndex>23</ZIndex><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>symbol</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Microsoft.Crm.Reporting.RdlHelper.ReportUtility.GetArrow(Parameters!CRM_SortField.Value,"Competitor", Parameters!CRM_SortDirection.Value)</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="txtopenopp"><ZIndex>22</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss</ReportName><Parameters><Parameter Name="CRM_SortField"><Value>="openopp"</Value></Parameter><Parameter Name="CRM_SortDirection"><Value>=IIF(Parameters!CRM_SortField.Value ="openopp" And Parameters!CRM_SortDirection.Value = "Ascending", "Descending", "Ascending")</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><TextAlign>Right</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>No. Open Opportunities Against Competitor</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox2"><rd:DefaultName>textbox2</rd:DefaultName><ZIndex>21</ZIndex><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><TextAlign>Right</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>symbol</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Microsoft.Crm.Reporting.RdlHelper.ReportUtility.GetArrow(Parameters!CRM_SortField.Value,"openopp", Parameters!CRM_SortDirection.Value)</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="txtxtcloseopp"><ZIndex>20</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss</ReportName><Parameters><Parameter Name="CRM_SortField"><Value>="closeopp"</Value></Parameter><Parameter Name="CRM_SortDirection"><Value>=IIF(Parameters!CRM_SortField.Value ="closeopp" And Parameters!CRM_SortDirection.Value = "Ascending", "Descending", "Ascending")</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><TextAlign>Right</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>No. Closed Opportunities Against Competitor</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox12x"><ZIndex>19</ZIndex><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>symbol</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Microsoft.Crm.Reporting.RdlHelper.ReportUtility.GetArrow(Parameters!CRM_SortField.Value,"closeopp", Parameters!CRM_SortDirection.Value)</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="txtoppwonp"><ZIndex>18</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss</ReportName><Parameters><Parameter Name="CRM_SortField"><Value>="wonopp"</Value></Parameter><Parameter Name="CRM_SortDirection"><Value>=IIF(Parameters!CRM_SortField.Value ="wonopp" And Parameters!CRM_SortDirection.Value = "Ascending", "Descending", "Ascending")</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><TextAlign>Right</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>Opportunities Won %</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox22x"><ZIndex>17</ZIndex><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>symbol</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Microsoft.Crm.Reporting.RdlHelper.ReportUtility.GetArrow(Parameters!CRM_SortField.Value,"wonopp", Parameters!CRM_SortDirection.Value)</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="txtopplostp"><ZIndex>16</ZIndex><Action><Drillthrough><ReportName>Competitor Win Loss</ReportName><Parameters><Parameter Name="CRM_SortField"><Value>="LostOpp"</Value></Parameter><Parameter Name="CRM_SortDirection"><Value>=IIF(Parameters!CRM_SortField.Value ="LostOpp" And Parameters!CRM_SortDirection.Value = "Ascending", "Descending", "Ascending")</Value></Parameter><Parameter Name="CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></Parameter><Parameter Name="CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></Parameter><Parameter Name="CRM_FilterText"><Value>=Parameters!CRM_FilterText.Value</Value></Parameter><Parameter Name="CRM_URL"><Value>=Parameters!CRM_URL.Value</Value></Parameter><Parameter Name="CRM_UserTimeZoneName"><Value>=Parameters!CRM_UserTimeZoneName.Value</Value></Parameter></Parameters></Drillthrough></Action><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><TextAlign>Right</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>Opportunities Lost %</Value></Textbox></ReportItems></TableCell><TableCell><ReportItems><Textbox Name="textbox25"><ZIndex>15</ZIndex><Style><BorderStyle><Bottom>Solid</Bottom><Left>None</Left><Right>None</Right></BorderStyle><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>symbol</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><BorderColor><Default>#adadad</Default></BorderColor><BackgroundColor>#e9e9e9</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Value>=Microsoft.Crm.Reporting.RdlHelper.ReportUtility.GetArrow(Parameters!CRM_SortField.Value,"LostOpp", Parameters!CRM_SortDirection.Value)</Value></Textbox></ReportItems></TableCell></TableCells><Height>0.25in</Height></TableRow></TableRows></Header><TableColumns><TableColumn><Width>2.49059in</Width></TableColumn><TableColumn><Width>0.30165in</Width></TableColumn><TableColumn><Width>1.186in</Width></TableColumn><TableColumn><Width>0.30165in</Width></TableColumn><TableColumn><Width>1.186in</Width></TableColumn><TableColumn><Width>0.30165in</Width></TableColumn><TableColumn><Width>1.30459in</Width></TableColumn><TableColumn><Width>0.30165in</Width></TableColumn><TableColumn><Width>1.30459in</Width></TableColumn><TableColumn><Width>0.30165in</Width></TableColumn></TableColumns><Height>0.53125in</Height></Table><Rectangle Name="rectangle1"><ReportItems><Textbox Name="txtNoData"><Left>7.09375in</Left><Top>0.28125in</Top><ZIndex>2</ZIndex><Visibility><Hidden>true</Hidden></Visibility><Width>0.71875in</Width><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><BackgroundColor>Yellow</BackgroundColor><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Height>0.15625in</Height><Value>No Data</Value></Textbox><Textbox Name="txtFilterSummaryValue"><Left>0.25in</Left><Top>0.325in</Top><ZIndex>1</ZIndex><Visibility><ToggleItem>txtFilterSummary</ToggleItem><Hidden>true</Hidden></Visibility><Width>5.63125in</Width><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontSize>8pt</FontSize><Color>#313336</Color><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Height>0.25in</Height><Value>=Parameters!CRM_FilterText.Value</Value></Textbox><Textbox Name="txtFilterSummary"><Left>0.25in</Left><Top>0.03125in</Top><Width>5.63125in</Width><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>12pt</FontSize><Color>#313336</Color><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Height>0.25in</Height><Value>Filter Summary</Value></Textbox></ReportItems><Top>0.772in</Top><ZIndex>1</ZIndex><Visibility><Hidden>=IIF(IsNothing(Parameters!CRM_FilterText.Value) or (Parameters!CRM_FilterText.Value) = "" or (Parameters!CRM_FilterText.Value) = " " , True, False)</Hidden></Visibility><Style><BackgroundColor>#deddcf</BackgroundColor></Style><Height>0.6686in</Height></Rectangle><Rectangle Name="Bodyrectangle"><ReportItems><Textbox Name="txtReportHeaderLabel"><Left>0.25in</Left><Top>0.125in</Top><Width>6.51875in</Width><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>14pt</FontSize><Color>#666666</Color><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Height>0.28125in</Height><Value>Competitor Win/Loss</Value></Textbox></ReportItems><Style><BackgroundColor>#deddcf</BackgroundColor></Style><Height>0.75in</Height></Rectangle></ReportItems><Height>2in</Height></Body><rd:ReportID>175a60d8-7f95-49ba-b4f6-a498c1c36244</rd:ReportID><LeftMargin>0.5in</LeftMargin><DataSets><DataSet Name="UserInfo"><Query><rd:UseGenericDesigner>true</rd:UseGenericDesigner><CommandText>select fullname from FilteredSystemUser where systemuserid = dbo.fn_FindUserGuid()</CommandText><DataSourceName>CRM</DataSourceName></Query><Fields><Field Name="fullname"><rd:TypeName>System.String</rd:TypeName><DataField>fullname</DataField></Field></Fields></DataSet><DataSet Name="NumberandCurrencyFormat"><Query><rd:UseGenericDesigner>true</rd:UseGenericDesigner><CommandText>select * from dbo.fn_GetFormatStrings()</CommandText><DataSourceName>CRM</DataSourceName></Query><Fields><Field Name="DateFormat"><rd:TypeName>System.String</rd:TypeName><DataField>DateFormat</DataField></Field><Field Name="TimeFormat"><rd:TypeName>System.String</rd:TypeName><DataField>TimeFormat</DataField></Field><Field Name="NumberLanguageCode"><rd:TypeName>System.String</rd:TypeName><DataField>NumberLanguageCode</DataField></Field><Field Name="CalendarType"><rd:TypeName>System.String</rd:TypeName><DataField>CalendarType</DataField></Field><Field Name="NumberFormat_0_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>NumberFormat_0_Precision</DataField></Field><Field Name="NumberFormat_1_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>NumberFormat_1_Precision</DataField></Field><Field Name="NumberFormat_2_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>NumberFormat_2_Precision</DataField></Field><Field Name="NumberFormat_3_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>NumberFormat_3_Precision</DataField></Field><Field Name="NumberFormat_4_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>NumberFormat_4_Precision</DataField></Field><Field Name="NumberFormat_5_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>NumberFormat_5_Precision</DataField></Field><Field Name="CurrencyFormat_0_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>CurrencyFormat_0_Precision</DataField></Field><Field Name="CurrencyFormat_1_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>CurrencyFormat_1_Precision</DataField></Field><Field Name="CurrencyFormat_2_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>CurrencyFormat_2_Precision</DataField></Field><Field Name="CurrencyFormat_3_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>CurrencyFormat_3_Precision</DataField></Field><Field Name="CurrencyFormat_4_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>CurrencyFormat_4_Precision</DataField></Field><Field Name="CurrencyFormat_5_Precision"><rd:TypeName>System.String</rd:TypeName><DataField>CurrencyFormat_5_Precision</DataField></Field></Fields></DataSet><DataSet Name="DSCompetitor"><Query><rd:UseGenericDesigner>true</rd:UseGenericDesigner><CommandText>
Create table #CompetitorOppIds (
	opportunityid uniqueidentifier,
	competitorid uniqueidentifier,
	name nvarchar(max),
	statecode int,
	lostto int
     	primary key clustered
	(	
		[opportunityid],
		[competitorid]
	) 	
)

create statistics compoppstat on #CompetitorOppIds(opportunityid, competitorid)

Declare @SQL  nVarchar(max)
Set @SQL = 
'insert into #CompetitorOppIds
select oppcomp.opportunityid, oppcomp.competitorid, NULL, o.statecode, 0
from (' +  @CRM_FilteredOpportunity + ') as o 
join FilteredOpportunityCompetitors  as oppcomp
on (o.opportunityid = oppcomp.opportunityid)
where o.statecode &lt;&gt; 2

insert into #CompetitorOppIds
select oppc.opportunityid, oppc.competitorid, NULL, o.statecode, 0
from (' +  @CRM_FilteredOpportunity + ') as o
join FilteredOpportunityClose as oppc
on (o.opportunityid = oppc.opportunityid and o.statecode = 2 and oppc.statecode = 1 and oppc.competitorid IS NOT NULL)

Select 
filcomp.name as Competitor,
comp.competitorid,
sum(Case when comp.statecode = 0 then 1 else 0 end) as openopp,
sum( Case when comp.statecode = 1 or comp.statecode = 2 then 1 else 0 end) as closeopp,
sum(case when comp.statecode = 1 then 1 else 0 end) as wonopp,
sum(case when comp.statecode = 2 then 1 else 0 end) as lostopp
From #CompetitorOppIds comp
join (' +  @CRM_FilteredCompetitor + ') as filcomp 
on (filcomp.competitorid = comp.competitorid) 
group by comp.competitorid, filcomp.name '

Exec (@SQL)
drop table #CompetitorOppIds</CommandText><QueryParameters><QueryParameter Name="@CRM_FilteredOpportunity"><Value>=Parameters!CRM_FilteredOpportunity.Value</Value></QueryParameter><QueryParameter Name="@CRM_FilteredCompetitor"><Value>=Parameters!CRM_FilteredCompetitor.Value</Value></QueryParameter></QueryParameters><DataSourceName>CRM</DataSourceName></Query><Fields><Field Name="Competitor"><rd:TypeName>System.String</rd:TypeName><DataField>Competitor</DataField></Field><Field Name="competitorid"><rd:TypeName>System.Guid</rd:TypeName><DataField>competitorid</DataField></Field><Field Name="openopp"><rd:TypeName>System.Int32</rd:TypeName><DataField>openopp</DataField></Field><Field Name="closeopp"><rd:TypeName>System.Int32</rd:TypeName><DataField>closeopp</DataField></Field><Field Name="wonopp"><rd:TypeName>System.Int32</rd:TypeName><DataField>wonopp</DataField></Field><Field Name="LostOpp"><DataField>lostopp</DataField></Field></Fields></DataSet></DataSets><Author> MSFT</Author><Width>9in</Width><CustomProperties><CustomProperty><Name>Custom</Name><Value>&lt;MSCRM xmlns="mscrm"&gt;&amp;lt;ReportFilter&amp;gt;&amp;lt;ReportEntity paramname="CRM_FilteredOpportunity"&amp;gt;&amp;lt;fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false"&amp;gt;&amp;lt;entity name="opportunity"&amp;gt;&amp;lt;all-attributes /&amp;gt;&amp;lt;filter type="and"&amp;gt;&amp;lt;condition attribute="modifiedon" operator="last-x-years" value="1" /&amp;gt;&amp;lt;/filter&amp;gt;&amp;lt;/entity&amp;gt;&amp;lt;/fetch&amp;gt;&amp;lt;/ReportEntity&amp;gt;&amp;lt;ReportEntity paramname="CRM_FilteredCompetitor"&amp;gt;&amp;lt;fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false"&amp;gt;&amp;lt;entity name="competitor"&amp;gt;&amp;lt;all-attributes /&amp;gt;&amp;lt;filter type="and"&amp;gt;&amp;lt;condition attribute="address1_country" operator="eq" value="" /&amp;gt;&amp;lt;/filter&amp;gt;&amp;lt;/entity&amp;gt;&amp;lt;/fetch&amp;gt;&amp;lt;/ReportEntity&amp;gt;&amp;lt;/ReportFilter&amp;gt;&lt;/MSCRM&gt;</Value></CustomProperty></CustomProperties><InteractiveHeight>11in</InteractiveHeight><Language>=Parameters!CRM_NumberLanguageCode.Value</Language><PageFooter><ReportItems><Textbox Name="txtPageCount"><Left>6.5125in</Left><ZIndex>2</ZIndex><Width>2.375in</Width><Style><TextAlign>Right</TextAlign><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontFamily>tahoma</FontFamily><FontWeight>700</FontWeight><FontSize>8pt</FontSize><Color>#666666</Color><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Height>0.21875in</Height><Value>=String.Format("Page {0} of {1}", Format(Globals!PageNumber, "#,##0"), Format(Globals!TotalPages, "#,##0"))</Value></Textbox><Textbox Name="txtUserIDLabel"><Left>3.39375in</Left><ZIndex>1</ZIndex><Width>2.375in</Width><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontWeight>700</FontWeight><FontSize>8pt</FontSize><Color>#666666</Color><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop></Style><CanGrow>true</CanGrow><Height>0.21875in</Height><Value>="Prepared by: " &amp; Parameters!CRM_FullName.Value</Value></Textbox><Textbox Name="txtExecutionDateTimeLabel"><Left>0.25in</Left><Width>2.375in</Width><Style><PaddingLeft>2pt</PaddingLeft><PaddingBottom>2pt</PaddingBottom><FontWeight>700</FontWeight><FontSize>8pt</FontSize><Color>#666666</Color><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><Format>=Parameters!CRM_FormatDate.Value + " " + Parameters!CRM_FormatTime.Value</Format><Calendar>=Parameters!CRM_CalendarType.Value</Calendar></Style><CanGrow>true</CanGrow><Height>0.21875in</Height><Value>=CDate(Microsoft.Crm.Reporting.RdlHelper.DateTimeUtility.ConvertUtcToLocalTime(DateTime.UtcNow, Parameters!CRM_UserTimeZoneName.Value))</Value></Textbox></ReportItems><Height>0.28125in</Height><PrintOnLastPage>true</PrintOnLastPage><PrintOnFirstPage>true</PrintOnFirstPage><Style><BackgroundColor>#deddcf</BackgroundColor></Style></PageFooter><TopMargin>0.5in</TopMargin><PageHeight>8.25in</PageHeight><CodeModules><CodeModule>Microsoft.Crm.Reporting.RdlHelper, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</CodeModule></CodeModules></Report>